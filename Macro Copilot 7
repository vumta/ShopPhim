D∆∞·ªõi ƒë√¢y l√† phi√™n b·∫£n c·∫≠p nh·∫≠t c·ªßa ƒëo·∫°n m√£ VBA, trong ƒë√≥ ch·ª©c nƒÉng ƒë√£ ƒë∆∞·ª£c s·ª≠a ƒë·ªïi ƒë·ªÉ x√≥a to√†n b·ªô c√°c d√≤ng trong b·∫£ng, gi·ªØ l·∫°i ti√™u ƒë·ªÅ v√† **m·ªôt h√†ng m·∫´u d·ªØ li·ªáu ngay sau ti√™u ƒë·ªÅ**:

```vba
Public Function CopyPasteWithParameters(ByVal sourceFilePath As String, ByVal targetFilePath As String, ByVal columnsToCopy As String) As String
    Dim sourceWorkbook As Workbook
    Dim targetWorkbook As Workbook
    Dim sourceSheet As Worksheet
    Dim targetSheet As Worksheet
    Dim sourceColumns() As String
    Dim targetCol As Integer
    Dim lastRow As Long
    Dim sourceData As Variant
    Dim i As Integer
    Dim targetTable As ListObject

    On Error GoTo ErrorHandler

    ' M·ªü file g·ªëc v√† file ƒë√≠ch t·ª´ ƒë∆∞·ªùng d·∫´n ƒë∆∞·ª£c truy·ªÅn v√†o
    Set sourceWorkbook = Workbooks.Open(sourceFilePath)
    Set targetWorkbook = Workbooks.Open(targetFilePath)
    
    ' L·∫•y sheet ƒë·∫ßu ti√™n t·ª´ file g·ªëc v√† sheet th·ª© hai t·ª´ file ƒë√≠ch
    Set sourceSheet = sourceWorkbook.Sheets(1)
    Set targetSheet = targetWorkbook.Sheets(2)

    ' Chuy·ªÉn c√°c t√™n c·ªôt t·ª´ chu·ªói th√†nh m·∫£ng
    sourceColumns = Split(columnsToCopy, ",")

    ' X√°c ƒë·ªãnh b·∫£ng trong sheet ƒë√≠ch
    If targetSheet.ListObjects.Count > 0 Then
        Set targetTable = targetSheet.ListObjects(1) ' Gi·∫£ ƒë·ªãnh ch·ªâ c√≥ m·ªôt b·∫£ng
        ' X√≥a to√†n b·ªô d·ªØ li·ªáu trong b·∫£ng, gi·ªØ l·∫°i ti√™u ƒë·ªÅ v√† m·ªôt h√†ng m·∫´u
        If Not targetTable.DataBodyRange Is Nothing Then
            ' X√≥a to√†n b·ªô d√≤ng tr·ª´ h√†ng ƒë·∫ßu ti√™n trong DataBodyRange
            With targetTable.DataBodyRange
                If .Rows.Count > 1 Then
                    targetSheet.Rows(.Row + 2 & ":" & .Row + .Rows.Count).ClearContents
                End If
            End With
        End If
    Else
        CopyPasteWithParameters = "L·ªói: Kh√¥ng t√¨m th·∫•y b·∫£ng trong sheet ƒë√≠ch."
        GoTo CleanUp
    End If

    ' Ki·ªÉm tra xem h√†ng th·ª© 2 trong sheet ƒë√≠ch c√≥ d·ªØ li·ªáu kh√¥ng
    If Application.CountA(targetSheet.Rows(2)) = 0 Then
        CopyPasteWithParameters = "L·ªói: H√†ng th·ª© 2 trong sheet ƒë√≠ch kh√¥ng c√≥ d·ªØ li·ªáu. Vui l√≤ng ki·ªÉm tra."
        GoTo CleanUp
    End If

    ' Duy·ªát qua c√°c c·ªôt ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh
    For i = LBound(sourceColumns) To UBound(sourceColumns)
        ' T√¨m c·ªôt ƒë√≠ch c√≥ t√™n gi·ªëng nhau trong h√†ng th·ª© 2 c·ªßa sheet ƒë√≠ch
        On Error Resume Next
        targetCol = 0
        targetCol = Application.Match(sourceColumns(i), targetSheet.Rows(2), 0)
        On Error GoTo 0

        If targetCol > 0 Then
            ' X√°c ƒë·ªãnh s·ªë h√†ng cu·ªëi c√πng trong c·ªôt ngu·ªìn
            lastRow = sourceSheet.Cells(sourceSheet.Rows.Count, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0)).End(xlUp).Row

            ' Ki·ªÉm tra n·∫øu c·ªôt ngu·ªìn kh√¥ng c√≥ d·ªØ li·ªáu
            If lastRow < 2 Then
                CopyPasteWithParameters = "L·ªói: Kh√¥ng t√¨m th·∫•y d·ªØ li·ªáu trong c·ªôt " & sourceColumns(i) & " c·ªßa file g·ªëc."
                GoTo CleanUp
            End If

            ' Sao ch√©p d·ªØ li·ªáu v√†o m·∫£ng
            sourceData = sourceSheet.Range(sourceSheet.Cells(2, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0)), _
                                           sourceSheet.Cells(lastRow, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0))).Value

            ' D√°n d·ªØ li·ªáu v√†o c·ªôt ƒë√≠ch, b·∫Øt ƒë·∫ßu t·ª´ h√†ng th·ª© 5
            targetSheet.Range(targetSheet.Cells(5, targetCol), targetSheet.Cells(UBound(sourceData, 1) + 4, targetCol)).Value = sourceData
        Else
            CopyPasteWithParameters = "L·ªói: Kh√¥ng t√¨m th·∫•y c·ªôt ƒë√≠ch cho " & sourceColumns(i) & " trong file ƒë√≠ch."
            GoTo CleanUp
        End If
    Next i

    ' L∆∞u v√† ƒë√≥ng file
    targetWorkbook.Save
    sourceWorkbook.Close False
    targetWorkbook.Close True

    CopyPasteWithParameters = "Th√†nh c√¥ng: D·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c sao ch√©p v√† d√°n th√†nh c√¥ng."
    Exit Function

ErrorHandler:
    CopyPasteWithParameters = "L·ªói: ƒê√£ x·∫£y ra l·ªói trong qu√° tr√¨nh th·ª±c thi: " & Err.Description

CleanUp:
    ' ƒê√≥ng file n·∫øu c·∫ßn thi·∫øt
    If Not sourceWorkbook Is Nothing Then sourceWorkbook.Close False
    If Not targetWorkbook Is Nothing Then targetWorkbook.Close True
End Function
```

### Nh·ªØng c·∫≠p nh·∫≠t ch√≠nh:
1. **Gi·ªØ l·∫°i ti√™u ƒë·ªÅ v√† m·ªôt h√†ng m·∫´u**:
   - H√†ng ƒë·∫ßu ti√™n trong ph·∫ßn d·ªØ li·ªáu (`DataBodyRange.Rows(1)`) s·∫Ω ƒë∆∞·ª£c gi·ªØ l·∫°i.
   - C√°c d√≤ng c√≤n l·∫°i t·ª´ v·ªã tr√≠ th·ª© hai tr·ªü ƒëi trong b·∫£ng ƒë∆∞·ª£c x√≥a b·∫±ng `ClearContents`.

2. **C·∫£i thi·ªán t√≠nh linh ho·∫°t**:
   - ƒê·∫£m b·∫£o b·∫£ng c√≥ d·ªØ li·ªáu tr∆∞·ªõc khi th·ª±c hi·ªán l·ªánh x√≥a, gi√∫p tr√°nh l·ªói khi b·∫£ng tr·ªëng.

### H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng:
1. **Chu·∫©n b·ªã file VBA**:
   - L∆∞u ƒëo·∫°n code n√†y th√†nh file `.bas`.
   - Import file `.bas` v√†o file Excel qua VBA Editor (Alt + F11 > File > Import).

2. **C·∫•u h√¨nh trong UiPath**:
   - S·ª≠ d·ª•ng activity **Invoke VBA** ƒë·ªÉ g·ªçi h√†m `CopyPasteWithParameters`.
   - Truy·ªÅn c√°c tham s·ªë:
     - `sourceFilePath`: ƒê∆∞·ªùng d·∫´n t·ªõi file g·ªëc.
     - `targetFilePath`: ƒê∆∞·ªùng d·∫´n t·ªõi file ƒë√≠ch.
     - `columnsToCopy`: Danh s√°ch t√™n c·ªôt, ph√¢n t√°ch b·∫±ng d·∫•u ph·∫©y.
     - `startRow`: D√≤ng b·∫Øt ƒë·∫ßu t·ª´ v·ªã tr√≠ d·ªØ li·ªáu m·∫´u (n·∫øu c·∫ßn thi·∫øt).

3. **X·ª≠ l√Ω k·∫øt qu·∫£**:
   - UiPath s·∫Ω nh·∫≠n chu·ªói k·∫øt qu·∫£ tr·∫£ v·ªÅ t·ª´ h√†m (Th√†nh c√¥ng ho·∫∑c l·ªói).

N·∫øu b·∫°n g·∫∑p v·∫•n ƒë·ªÅ ho·∫∑c c·∫ßn th√™m ch·ªânh s·ª≠a, h√£y cho t√¥i bi·∫øt nh√©! üòä
==================================================================================================================
