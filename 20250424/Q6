TÃ¬nh tráº¡ng **header quÃ¡ dÃ i khi Ä‘á»c Excel trong UiPath** thÆ°á»ng gÃ¢y lá»—i kiá»ƒu:

```
Column name is too long / Column names must be unique / Header exceeds limit / The column name is not valid
```

---

## ğŸ§  NguyÃªn nhÃ¢n phá»• biáº¿n:

| NguyÃªn nhÃ¢n | MÃ´ táº£ |
|-------------|-------|
| âš  Header dÃ i quÃ¡ 255 kÃ½ tá»± | Excel cho phÃ©p, nhÆ°ng **DataTable** trong UiPath khÃ´ng thÃ­ch Ä‘iá»u nÃ y. |
| âš  Header cÃ³ kÃ½ tá»± láº¡, xuá»‘ng dÃ²ng, khoáº£ng tráº¯ng | Khiáº¿n DataTable khÃ³ hiá»ƒu hoáº·c khÃ´ng Ä‘á»c Ä‘Ãºng tÃªn cá»™t. |
| âš  TrÃ¹ng header | Khi Ä‘á»c vá»›i `AddHeaders = True`, náº¿u 2 cá»™t cÃ¹ng tÃªn sáº½ lá»—i. |

---

## âœ… Giáº£i phÃ¡p step-by-step

---

### ğŸ”¹ **Step 1: Äá»c Excel mÃ  KHÃ”NG dÃ¹ng dÃ²ng Ä‘áº§u lÃ m header**

- DÃ¹ng **Read Range** (Classic hoáº·c Modern)
- **Uncheck** `AddHeaders` (Ä‘á»«ng tick)
- Gá»i DataTable lÃ  `dtRaw`

ğŸ‘‰ Káº¿t quáº£: `dtRaw.Rows(0)` chÃ­nh lÃ  hÃ ng header **gá»‘c**, dáº¡ng dá»¯ liá»‡u, khÃ´ng gÃ¢y lá»—i.

---

### ğŸ”¹ **Step 2: Táº¡o Header má»›i an toÃ n**

Báº¡n táº¡o header má»›i tá»« dÃ²ng Ä‘áº§u tiÃªn, nhÆ°ng rÃºt gá»n & Ä‘áº£m báº£o há»£p lá»‡:

```vb
newDT = New DataTable()

For Each colIndex In Enumerable.Range(0, dtRaw.Columns.Count)
    headerValue = dtRaw.Rows(0)(colIndex).ToString

    ' RÃºt gá»n tÃªn cá»™t náº¿u quÃ¡ dÃ i
    If headerValue.Length > 50 Then
        headerValue = headerValue.Substring(0, 50)
    End If

    ' Xá»­ lÃ½ náº¿u tÃªn trá»‘ng hoáº·c trÃ¹ng
    If String.IsNullOrWhiteSpace(headerValue) Then
        headerValue = "Column_" & colIndex.ToString
    End If

    If newDT.Columns.Contains(headerValue) Then
        headerValue = headerValue & "_" & colIndex.ToString
    End If

    newDT.Columns.Add(headerValue)
Next
```

---

### ğŸ”¹ **Step 3: Copy dá»¯ liá»‡u tá»« dÃ²ng 2 trá»Ÿ Ä‘i vÃ o DataTable má»›i**

```vb
For rowIndex = 1 To dtRaw.Rows.Count - 1
    newDT.Rows.Add(dtRaw.Rows(rowIndex).ItemArray)
Next
```

---

### ğŸ”¹ **Step 4: DÃ¹ng `newDT` thay cho `dtRaw`**

Tá»« Ä‘Ã¢y, báº¡n lÃ m viá»‡c vá»›i `newDT` â€” nÃ³ Ä‘Ã£ cÃ³ header há»£p lá»‡.

---

## âœ… Tá»•ng káº¿t

| Viá»‡c lÃ m | LÃ½ do |
|----------|-------|
| KhÃ´ng dÃ¹ng dÃ²ng Ä‘áº§u lÃ m header | TrÃ¡nh lá»—i khi tÃªn cá»™t dÃ i/quÃ¡i |
| Táº¡o header thá»§ cÃ´ng (rÃºt gá»n) | Äáº£m báº£o khÃ´ng lá»—i |
| Copy dá»¯ liá»‡u tá»« dÃ²ng 2 | TrÃ¡nh máº¥t dá»¯ liá»‡u |

---

Náº¿u báº¡n muá»‘n mÃ¬nh gá»­i **xaml máº«u** hoáº·c **code C# hoáº·c VB.Net** trong Assign/Invoke Code thÃ¬ cá»© nÃ³i nhÃ©! Báº¡n Ä‘ang dÃ¹ng **Modern** hay **Classic** activities Ä‘á»ƒ mÃ¬nh gá»­i Ä‘Ãºng kiá»ƒu.
