DÆ°á»›i Ä‘Ã¢y lÃ  hÆ°á»›ng dáº«n **chi tiáº¿t step-by-step** Ä‘á»ƒ báº¡n **gá»i Ä‘oáº¡n mÃ£ VBA tá»« file `.bas` trong UiPath** vÃ  sá»­ dá»¥ng káº¿t quáº£ (náº¿u cÃ³):

---

### ğŸ¯ **Má»¥c tiÃªu**
Gá»i macro VBA Ä‘Ã£ export (`.bas`) tá»« Excel trong UiPath â†’ tá»± Ä‘á»™ng quÃ©t file/folder SharePoint vÃ  ghi vÃ o Excel tá»« dÃ²ng 5.

---

## ğŸ”§ **1. Chuáº©n bá»‹ file .bas vÃ  Excel**

1. **Giáº£i nÃ©n `VBA_Module.zip`**
2. Má»Ÿ Excel Ä‘Ã­ch, báº­t Developer â†’ VÃ o **Visual Basic Editor**
3. Import `Module1.bas`:  
   `File â†’ Import File â†’ Chá»n file Module1.bas`
4. LÆ°u file Excel dÆ°á»›i dáº¡ng `.xlsm` Ä‘á»ƒ cÃ³ thá»ƒ cháº¡y macro

---

## âš™ï¸ **2. Trong UiPath: DÃ¹ng activity `Invoke VBA`**

### ğŸ§± **A. Cáº¥u trÃºc project**
- Excel file: `"C:\Path\to\YourFile.xlsm"`
- Module macro: `"Module1.bas"` Ä‘Ã£ cÃ³ trong file
- Sheet cáº§n ghi: VÃ­ dá»¥ `"Sheet1"`

---

### ğŸ§© **B. CÃ¡c bÆ°á»›c trong UiPath**

#### ğŸŸ¢ 1. **Use Excel Process Scope** (Modern Design)
```plaintext
Use Excel File â†’ YourFile.xlsm
```

#### ğŸŸ¢ 2. **Add `Invoke VBA` Activity**
| Property            | Value                          |
|---------------------|-------------------------------|
| **Code File Path**  | Äá»ƒ trá»‘ng hoáº·c null náº¿u macro Ä‘Ã£ cÃ³ sáºµn |
| **EntryMethodName** | `"Main"` (tÃªn Sub báº¡n Ä‘Ã£ viáº¿t trong VBA) |
| **Parameters**      | Danh sÃ¡ch parameter (náº¿u cÃ³) |

âœ… VÃ­ dá»¥: Náº¿u Sub cá»§a báº¡n lÃ :
```vba
Sub Main()
    ProcessFolder "/Shared Documents", ThisWorkbook.Sheets("Sheet1")
End Sub
```

ThÃ¬ chá»‰ cáº§n gá»i `Main` khÃ´ng cáº§n parameter.

---

## ğŸ“„ **Gá»£i Ã½ thay tháº¿ náº¿u dÃ¹ng `Legacy` Excel Activities**

- **Excel Application Scope**  
  â†’ Cho `Invoke VBA` vÃ o bÃªn trong  
- `Invoke VBA`:
  - `CodeFilePath`: Ä‘á»ƒ null  
  - `EntryMethodName`: `"Main"`

---

## ğŸ“Œ **LÆ°u Ã½**

- Äáº£m báº£o Macro Ä‘Ã£ Ä‘Æ°á»£c báº­t trong Excel
- File Excel pháº£i Ä‘Æ°á»£c lÆ°u dáº¡ng `.xlsm`
- Náº¿u dÃ¹ng Excel á»Ÿ background, báº¡n cÃ³ thá»ƒ dÃ¹ng **"Visible: False"** khi má»Ÿ file

---

## âœ… Káº¿t quáº£
Sau khi cháº¡y xong, Excel cá»§a báº¡n sáº½ Ä‘Æ°á»£c ghi dá»¯ liá»‡u tá»« dÃ²ng 5 theo cáº¥u trÃºc cá»™t `"Name"` vÃ  `"Path"` Ä‘Ãºng vá»‹ trÃ­ tiáº¿ng Nháº­t hiá»‡n cÃ³.

---

Náº¿u báº¡n muá»‘n **truyá»n tham sá»‘ tá»« UiPath vÃ o Macro**, mÃ¬nh cÃ³ thá»ƒ viáº¿t thÃªm pháº§n xá»­ lÃ½ `parameters()` trong VBA vÃ  hÆ°á»›ng dáº«n cá»¥ thá»ƒ nhÃ©. Báº¡n cáº§n khÃ´ng?
