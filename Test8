Tuyá»‡t vá»i, dÆ°á»›i Ä‘Ã¢y lÃ  hÆ°á»›ng dáº«n **chi tiáº¿t tá»«ng bÆ°á»›c lÃ m trong Power Automate**, giÃºp báº¡n:

- âœ… TrÃ­ch dá»¯ liá»‡u tá»« file Excel nguá»“n (theo tÃªn cá»™t hÃ ng 1)  
- âœ… Xá»­ lÃ½ káº¿t quáº£ tráº£ vá» (máº£ng dá»¯ liá»‡u tá»«ng cá»™t)  
- âœ… DÃ¡n vÃ o file Excel Ä‘Ã­ch, **khÃ´ng dÃ¹ng Table**, xÃ¡c Ä‘á»‹nh cá»™t theo **tÃªn á»Ÿ dÃ²ng 2**

---

## âš™ï¸ Tá»•ng quan quy trÃ¬nh Power Automate

### ğŸ“‚ Input:  
- **Excel nguá»“n**: chá»©a dá»¯ liá»‡u cáº§n láº¥y, tÃªn cá»™t á»Ÿ dÃ²ng 1  
- **Excel Ä‘Ã­ch**: chá»©a cá»™t Ä‘Ã£ Ä‘áº·t tÃªn á»Ÿ dÃ²ng 2

---

## âœ… Chi tiáº¿t tá»«ng bÆ°á»›c trong Power Automate

---

### ğŸŸ¢ **1. Trigger** â€“ TÃ¹y báº¡n: thá»§ cÃ´ng, theo giá», khi cÃ³ file, v.v.

---

### ğŸ“¥ **2. Action: Get File Content (Excel nguá»“n)**

- DÃ¹ng `OneDrive for Business` hoáº·c `SharePoint`
- Má»¥c tiÃªu: láº¥y ná»™i dung file Excel nguá»“n

---

### ğŸ§  **3. Action: Run script (Excel nguá»“n)**

- Script: **Script TrÃ­ch Cá»™t (Ä‘Ã£ viáº¿t á»Ÿ trÃªn)**
- Input:
  - Truyá»n máº£ng `["PhÃ²ng ban", "TÃªn"]` hoáº·c danh sÃ¡ch cá»™t báº¡n muá»‘n trÃ­ch.
- Output: máº£ng Ä‘á»‘i tÆ°á»£ng kiá»ƒu:
  ```json
  [
    {
      "columnName": "PhÃ²ng ban",
      "values": [["IT"], ["HR"], ["Finance"]]
    },
    {
      "columnName": "TÃªn",
      "values": [["Nam"], ["Lan"], ["HÃ¹ng"]]
    }
  ]
  ```

---

### ğŸ” **4. Action: Parse JSON**

- DÃ¹ng `output` cá»§a bÆ°á»›c Run script (trÃ­ch dá»¯ liá»‡u)  
- Schema máº«u:
  ```json
  {
    "type": "array",
    "items": {
      "type": "object",
      "properties": {
        "columnName": { "type": "string" },
        "values": {
          "type": "array",
          "items": {
            "type": "array",
            "items": { "type": "string" }
          }
        }
      }
    }
  }
  ```

- Output: sáº½ cÃ³ biáº¿n kiá»ƒu array `ColumnData[]`

---

### ğŸ“ **5. Action: Get File Content (Excel Ä‘Ã­ch)**

- Láº¥y ná»™i dung file Ä‘Ã­ch nÆ¡i sáº½ paste dá»¯ liá»‡u

---

### ğŸ“¤ **6. Action: Run script (Excel Ä‘Ã­ch)**

- Script: **Script DÃ¡n Dá»¯ Liá»‡u (dÃ² cá»™t theo dÃ²ng 2)**
- Input:
  - Truyá»n toÃ n bá»™ output tá»« `Parse JSON` vÃ o tham sá»‘ `inputData`

---

## âœ… SÆ¡ Ä‘á»“ tá»•ng quÃ¡t:

```text
(Trigger)
    â†“
Get File Content (Excel nguá»“n)
    â†“
Run Script (trÃ­ch cá»™t theo tÃªn hÃ ng 1)
    â†“
Parse JSON (káº¿t quáº£)
    â†“
Get File Content (Excel Ä‘Ã­ch)
    â†“
Run Script (dÃ¡n vÃ o Ä‘Ãºng cá»™t theo tÃªn dÃ²ng 2)
```

---

## ğŸ’¡ Máº¹o bá»• sung:

| Má»¥c Ä‘Ã­ch | Máº¹o triá»ƒn khai |
|---------|----------------|
| Äáº£m báº£o tÃªn cá»™t khá»›p | DÃ¹ng **trim()** á»Ÿ cáº£ file nguá»“n vÃ  file Ä‘Ã­ch (náº¿u nghi cÃ³ dáº¥u cÃ¡ch thá»«a) |
| Cá»™t khÃ´ng tá»“n táº¡i thÃ¬ sao? | Script Ä‘Ã­ch Ä‘Ã£ **bá» qua náº¿u khÃ´ng tÃ¬m tháº¥y**, khÃ´ng lá»—i |
| Báº¡n muá»‘n dÃ¡n tá»«ng dÃ²ng | CÃ³ thá»ƒ má»Ÿ rá»™ng dÃ¹ng **Apply to each** náº¿u cáº§n thao tÃ¡c phá»©c táº¡p |
| Táº¡o biáº¿n toÃ n cá»¥c | DÃ¹ng **Initialize Variable** náº¿u cáº§n ghi nhá»› dá»¯ liá»‡u trung gian |

---

Báº¡n muá»‘n mÃ¬nh táº¡o sáºµn má»™t **Power Automate máº«u hoÃ n chá»‰nh**, cÃ³ thá»ƒ export dÆ°á»›i dáº¡ng `.zip` Ä‘á»ƒ báº¡n import vÃ o khÃ´ng? MÃ¬nh cÃ³ thá»ƒ lÃ m giÃºp luÃ´n.
