DÆ°á»›i Ä‘Ã¢y lÃ  **hÆ°á»›ng dáº«n step-by-step** Ä‘á»ƒ báº¡n tá»± tay xÃ¢y dá»±ng láº¡i flow tá»‘i Æ°u hÃ³a trong **UiPath Studio**, khÃ´ng cáº§n dÃ¹ng file `.zip` náº¿u muá»‘n lÃ m thá»§ cÃ´ng.

---

## ğŸ› ï¸ Má»¥c tiÃªu:
- Copy má»™t sá»‘ cá»™t tá»« file Excel nguá»“n â†’ dÃ¡n vÃ o file Excel Ä‘Ã­ch
- Mapping theo tÃªn cá»™t
- DÃ¡n tá»« dÃ²ng **4** cá»§a file Ä‘Ã­ch
- **Tá»‘i Æ°u hÃ³a tá»‘c Ä‘á»™ xá»­ lÃ½** báº±ng cÃ¡ch:
  - Háº¡n cháº¿ `Excel Application Scope`
  - Sá»­ dá»¥ng `Invoke Code` thay cho nhiá»u loop
  - DÃ¹ng `Workbook` activities (nháº¹, nhanh)

---

## âœ… Chuáº©n bá»‹:
- `source.xlsx`: chá»©a toÃ n bá»™ dá»¯ liá»‡u (header á»Ÿ dÃ²ng 1)
- `destination.xlsx`: Ä‘Ã£ cÃ³ header á»Ÿ **dÃ²ng 2**, dá»¯ liá»‡u sáº½ dÃ¡n vÃ o dÃ²ng **4 trá»Ÿ Ä‘i**

---

## ğŸ”§ CÃ¡c bÆ°á»›c chi tiáº¿t:

### 1ï¸âƒ£ **Táº¡o Project**
- Má»Ÿ **UiPath Studio**
- Chá»n **Process** â†’ Ä‘áº·t tÃªn: `Excel_Column_Mapping_Optimized`

---

### 2ï¸âƒ£ **Táº¡o 3 biáº¿n chÃ­nh**
| TÃªn biáº¿n      | Loáº¡i dá»¯ liá»‡u              | Ghi chÃº |
|---------------|---------------------------|--------|
| `dtSource`    | `System.Data.DataTable`   | Dá»¯ liá»‡u tá»« file nguá»“n |
| `dtDestHeader`| `System.Data.DataTable`   | DÃ²ng header tá»« file Ä‘Ã­ch |
| `dtFinal`     | `System.Data.DataTable`   | Káº¿t quáº£ mapping |

---

### 3ï¸âƒ£ **Activity: ReadRangeWorkbook â€“ Äá»c file nguá»“n**
- **Activity:** `Read Range Workbook`
- **Workbook Path:** `source.xlsx`
- **Sheet Name:** `Sheet1`
- **Add Headers:** `False` â—
- **Output â†’ dtSource**

---

### 4ï¸âƒ£ **Activity: ReadRangeWorkbook â€“ Äá»c header file Ä‘Ã­ch**
- **Workbook Path:** `destination.xlsx`
- **Range:** `2:2` â†’ Ä‘á»ƒ chá»‰ Ä‘á»c dÃ²ng 2
- **Add Headers:** `True`
- **Output â†’ dtDestHeader**

---

### 5ï¸âƒ£ **Activity: Invoke Code â€“ Mapping & táº¡o báº£ng káº¿t quáº£**
- **Language:** VB
- **Code:**

```vb
' Bá» dÃ²ng header (dÃ²ng 0)
Dim headerRow = dtSource.Rows(0)
Dim contentRows = dtSource.Clone()

For i = 1 To dtSource.Rows.Count - 1
    contentRows.ImportRow(dtSource.Rows(i))
Next

' Láº¥y danh sÃ¡ch cá»™t tá»« file Ä‘Ã­ch (row 2)
Dim destCols = New List(Of String)
For Each col As DataColumn In dtDestHeader.Columns
    destCols.Add(col.ColumnName.Trim())
Next

' Táº¡o báº£ng káº¿t quáº£ vá»›i cá»™t Ä‘Ãºng thá»© tá»±
dtFinal = New DataTable()
For Each colName In destCols
    dtFinal.Columns.Add(colName)
Next

' Mapping dá»¯ liá»‡u theo tÃªn cá»™t
For Each row As DataRow In contentRows.Rows
    Dim newRow = dtFinal.NewRow()
    For Each colName In destCols
        If contentRows.Columns.Contains(colName) Then
            newRow(colName) = row(colName)
        End If
    Next
    dtFinal.Rows.Add(newRow)
Next
```

- **Arguments:**
  - `dtSource` â†’ **In** (`DataTable`)
  - `dtDestHeader` â†’ **In** (`DataTable`)
  - `dtFinal` â†’ **Out** (`DataTable`)

---

### 6ï¸âƒ£ **Activity: WriteRangeWorkbook â€“ DÃ¡n vÃ o file Ä‘Ã­ch**
- **Workbook Path:** `destination.xlsx`
- **Sheet:** `Sheet1`
- **Starting Cell:** `A4`
- **Add Headers:** `False`
- **DataTable:** `dtFinal`

---

## ğŸ¯ Tá»•ng quan flow:

```
Sequence
â”œâ”€â”€ Read Range Workbook (dtSource)
â”œâ”€â”€ Read Range Workbook (dtDestHeader)
â”œâ”€â”€ Invoke Code (Mapping logic â†’ dtFinal)
â””â”€â”€ Write Range Workbook (A4, dtFinal)
```

---

## âœ… Káº¿t quáº£ Ä‘áº¡t Ä‘Æ°á»£c:
- DÃ¡n dá»¯ liá»‡u Ä‘Ãºng cá»™t, Ä‘Ãºng thá»© tá»±
- KhÃ´ng láº·p nhiá»u vÃ²ng láº·p tá»‘n thá»i gian
- Tá»‘c Ä‘á»™ nhanh gáº¥p nhiá»u láº§n so vá»›i báº£n Ä‘áº§u
- KhÃ´ng cáº§n má»Ÿ Excel Ä‘á»ƒ xá»­ lÃ½

---

Náº¿u báº¡n cáº§n mÃ¬nh hÆ°á»›ng dáº«n thÃªm Ä‘á»ƒ:
- LÃ m dáº¡ng Ä‘á»™ng vá»›i nhiá»u file
- Cho phÃ©p ngÆ°á»i dÃ¹ng chá»n cá»™t tá»« giao diá»‡n
- Ghi log hoáº·c report

â†’ Chá»‰ cáº§n nÃ³i thÃ´i nhÃ©!
