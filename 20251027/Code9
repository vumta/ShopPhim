D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n t·ª´ng b∆∞·ªõc + m√£ VBA ƒë·∫ßy ƒë·ªß ƒë·ªÉ b·∫°n c√≥ th·ªÉ d√πng v·ªõi UiPath Invoke VBA.
Flow n√†y s·∫Ω copy 1 sheet b·∫•t k·ª≥ trong Excel, l∆∞u sheet ƒë√≥ th√†nh 1 file ri√™ng (.xlsx ho·∫∑c .csv), v·ªõi t√™n file = t√™n sheet.


---

üß© 1. Code VBA ho√†n ch·ªânh (l∆∞u ra file .bas)

> V√≠ d·ª• file: ExportSheetAsFile.bas



Attribute VB_Name = "ExportSheetAsFile"

Public Sub ExportSheetAsFile(SheetName As String, OutputFolder As String, Optional FileFormat As String = "xlsx")
    Dim wb As Workbook
    Dim ws As Worksheet
    Dim newWb As Workbook
    Dim FilePath As String
    
    ' Ki·ªÉm tra folder t·ªìn t·∫°i
    If Dir(OutputFolder, vbDirectory) = "" Then
        MsgBox "Th∆∞ m·ª•c kh√¥ng t·ªìn t·∫°i: " & OutputFolder, vbExclamation
        Exit Sub
    End If
    
    ' L·∫•y workbook hi·ªán t·∫°i
    Set wb = ThisWorkbook
    
    ' Ki·ªÉm tra sheet c√≥ t·ªìn t·∫°i kh√¥ng
    On Error Resume Next
    Set ws = wb.Sheets(SheetName)
    On Error GoTo 0
    
    If ws Is Nothing Then
        MsgBox "Kh√¥ng t√¨m th·∫•y sheet: " & SheetName, vbCritical
        Exit Sub
    End If
    
    ' T·∫°o ƒë∆∞·ªùng d·∫´n l∆∞u
    FilePath = OutputFolder & Application.PathSeparator & SheetName
    
    ' Copy sheet ra file m·ªõi
    ws.Copy
    Set newWb = ActiveWorkbook
    
    ' L∆∞u file theo ƒë·ªãnh d·∫°ng
    Select Case LCase(FileFormat)
        Case "csv"
            FilePath = FilePath & ".csv"
            Application.DisplayAlerts = False
            newWb.SaveAs Filename:=FilePath, FileFormat:=xlCSVUTF8
            Application.DisplayAlerts = True
        Case Else
            FilePath = FilePath & ".xlsx"
            Application.DisplayAlerts = False
            newWb.SaveAs Filename:=FilePath, FileFormat:=xlOpenXMLWorkbook
            Application.DisplayAlerts = True
    End Select
    
    ' ƒê√≥ng file m·ªõi
    newWb.Close SaveChanges:=False
    
    MsgBox "ƒê√£ xu·∫•t sheet '" & SheetName & "' ra file: " & FilePath, vbInformation
End Sub


---

üßæ 2. H∆∞·ªõng d·∫´n d√πng trong UiPath

Step 1:
L∆∞u ƒëo·∫°n code tr√™n v√†o file ExportSheetAsFile.bas.

Step 2:
Trong UiPath, t·∫°o flow nh∆∞ sau:

D√πng Excel Application Scope ‚Üí ch·ªçn file Excel c·∫ßn ch·∫°y macro.

Th√™m activity Invoke VBA:

Code file path: ƒë∆∞·ªùng d·∫´n t·ªõi file .bas

Entry method name: ExportSheetAsFile

Parameters:

Direction	Type	Value

In	String	"T√™nSheetC·∫ßnXu·∫•t"
In	String	"C:\OutputFolder"
In	String	"xlsx" (ho·∫∑c "csv")





---

üí° V√≠ d·ª• g·ªçi trong UiPath

N·∫øu b·∫°n mu·ªën xu·∫•t sheet "Report_2025" th√†nh file "C:\Exports\Report_2025.xlsx", th√¨:

Code file path: C:\Macro\ExportSheetAsFile.bas

Entry method name: ExportSheetAsFile

Parameters:
"Report_2025", "C:\Exports", "xlsx"



---

B·∫°n c√≥ mu·ªën m√¨nh t·∫°o s·∫µn file .bas ƒë·ªÉ b·∫°n t·∫£i v·ªÅ (ho·∫∑c copy paste nguy√™n n·ªôi dung chu·∫©n ƒë·ªãnh d·∫°ng .bas) kh√¥ng?
N·∫øu c√≥, m√¨nh s·∫Ω xu·∫•t file s·∫µn ƒë·ªÉ b·∫°n import tr·ª±c ti·∫øp v√†o UiPath.
