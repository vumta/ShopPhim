CÃ¢u há»i cá»§a báº¡n ráº¥t hay ğŸ‘ â€” vÃ  Ä‘Ã¢y lÃ  Ä‘iá»ƒm ráº¥t quan trá»ng khi lÃ m viá»‡c vá»›i Parallel trong UiPath, Ä‘áº·c biá»‡t khi káº¿t há»£p vá»›i macro má»Ÿ popup.
CÃ¢u tráº£ lá»i ngáº¯n lÃ : âš ï¸ KhÃ´ng thá»ƒ â€œbreakâ€ ra khá»i Parallel trá»±c tiáº¿p theo kiá»ƒu láº­p trÃ¬nh nhÆ° Break trong For Each.
Tuy nhiÃªn, báº¡n váº«n cÃ³ thá»ƒ thoÃ¡t hoáº·c dá»«ng logic cÃ²n láº¡i cá»§a nhÃ¡nh song song báº±ng má»™t trong cÃ¡c cÃ¡ch an toÃ n vÃ  kiá»ƒm soÃ¡t Ä‘Æ°á»£c â€” dÆ°á»›i Ä‘Ã¢y lÃ  giáº£i thÃ­ch chi tiáº¿t.


---

ğŸ§© TÃ¬nh huá»‘ng cá»§a báº¡n

Má»™t nhÃ¡nh Parallel Ä‘ang cháº¡y macro â†’ macro má»Ÿ popup SaveAs.

NhÃ¡nh thá»© hai Parallel Ä‘iá»n path vÃ o popup vÃ  nháº¥n OK.

Sau khi nháº¥n OK, báº¡n muá»‘n ngá»«ng toÃ n bá»™ Parallel luÃ´n (khÃ´ng cáº§n chá» macro tiáº¿p tá»¥c cháº¡y thÃªm, hoáº·c trÃ¡nh lá»—i 9C86).



---

ğŸš« 1. UiPath khÃ´ng cÃ³ â€œBreakâ€ trá»±c tiáº¿p cho Parallel

Trong Parallel, cÃ¡c Branch Ä‘á»u cháº¡y Ä‘á»™c láº­p vÃ  khÃ´ng cÃ³ cÆ¡ cháº¿ â€œthoÃ¡t toÃ n khá»‘iâ€ ngay khi má»™t branch hoÃ n thÃ nh.
â†’ Khi má»™t branch káº¿t thÃºc, UiPath váº«n giá»¯ Parallel cháº¡y cho Ä‘áº¿n khi táº¥t cáº£ branch khÃ¡c cÅ©ng káº¿t thÃºc hoáº·c bá»‹ lá»—i.

VÃ¬ váº­y, náº¿u báº¡n nháº¥n OK trong popup mÃ  nhÃ¡nh macro váº«n Ä‘ang cháº¡y, UiPath sáº½ khÃ´ng tá»± dá»«ng branch Ä‘Ã³ â†’ dá»… sinh lá»—i (vÃ¬ macro tiáº¿p tá»¥c cháº¡y trong khi dialog Ä‘Ã£ bá»‹ can thiá»‡p).


---

âœ… 2. CÃ¡ch thoÃ¡t Parallel Ä‘Ãºng cÃ¡ch

CÃ¡ch 1 â€” DÃ¹ng biáº¿n â€œStop Flagâ€ chung

Táº¡o má»™t biáº¿n Boolean, vÃ­ dá»¥ stopFlag = False.

Trong nhÃ¡nh Ä‘iá»n path + nháº¥n OK:

Type Into (File path)
Click (OK)
Assign stopFlag = True

Trong nhÃ¡nh cháº¡y macro, bao quanh cÃ¡c bÆ°á»›c vá»›i Do While stopFlag = False.
VÃ­ dá»¥:

Do While stopFlag = False
    Delay 100ms
Loop

â†’ Khi nhÃ¡nh nháº­p popup set stopFlag = True, nhÃ¡nh macro thoÃ¡t khá»i vÃ²ng láº·p => káº¿t thÃºc song song an toÃ n.


Äiá»u nÃ y mÃ´ phá»ng hÃ nh vi â€œBreak Parallelâ€.


---

CÃ¡ch 2 â€” DÃ¹ng Parallel + Pick káº¿t há»£p

Thay vÃ¬ Parallel, dÃ¹ng Pick hoáº¡t Ä‘á»™ng theo nguyÃªn táº¯c â€œcháº¡y nhÃ¡nh nÃ o hoÃ n thÃ nh trÆ°á»›c thÃ¬ dá»«ng táº¥t cáº£ cÃ¡c nhÃ¡nh khÃ¡câ€.

Cáº¥u trÃºc:

Pick
 â”œâ”€ PickBranch 1: Trigger = Macro má»Ÿ popup
 â”‚                Action = Type path + Click OK
 â”‚
 â””â”€ PickBranch 2: Trigger = Timeout  (Delay 30s cháº³ng háº¡n)
                  Action = Throw new BusinessRuleException("Timeout")

â†’ Khi nhÃ¡nh Ä‘áº§u tiÃªn â€œnháº¥n OKâ€ hoÃ n táº¥t, Pick sáº½ tá»± Ä‘á»™ng thoÃ¡t toÃ n bá»™ vÃ  khÃ´ng chá» nhÃ¡nh khÃ¡c.

âœ… ÄÃ¢y lÃ  giáº£i phÃ¡p an toÃ n nháº¥t Ä‘á»ƒ mÃ´ phá»ng â€œbreak ra khá»i song songâ€.


---

CÃ¡ch 3 â€” DÃ¹ng Cancel Activity hoáº·c Throw Ä‘á»ƒ thoÃ¡t cÆ°á»¡ng bá»©c

Náº¿u muá»‘n cÆ°á»¡ng bá»©c dá»«ng ngay láº­p tá»©c:

Trong nhÃ¡nh â€œnháº¥n OKâ€, sau khi click:

Throw New System.Exception("Stop Parallel")

Bá»c Parallel trong Try Catch â†’ khi Throw xáº£y ra, toÃ n bá»™ Parallel sáº½ bá»‹ ngáº¯t.


NhÆ°ng âš ï¸ cÃ¡ch nÃ y thÆ°á»ng khÃ´ng khuyáº¿n khÃ­ch khi Excel Ä‘ang cháº¡y macro vÃ¬ cÃ³ thá»ƒ lÃ m Excel máº¥t tráº¡ng thÃ¡i / COM crash.


---

ğŸ§­ Gá»£i Ã½ thá»±c táº¿ cho case cá»§a báº¡n

Má»¥c tiÃªu	CÃ¡ch nÃªn dÃ¹ng

Muá»‘n dá»«ng Parallel sau khi nháº¥n OK	ğŸ‘‰ DÃ¹ng Pick hoáº·c StopFlag
Muá»‘n xá»­ lÃ½ an toÃ n khÃ´ng crash Excel	ğŸ‘‰ DÃ¹ng Pick
Muá»‘n â€œthoÃ¡t cá»©ngâ€ kiá»ƒu break tháº­t	ğŸ‘‰ Throw + Try Catch (chá»‰ náº¿u Excel khÃ´ng cáº§n giá»¯ tráº¡ng thÃ¡i)



---

ğŸ’¡ Káº¿t luáº­n

> ğŸ”¹ KhÃ´ng thá»ƒ dÃ¹ng â€œBreakâ€ Ä‘á»ƒ thoÃ¡t trá»±c tiáº¿p Parallel.
ğŸ”¹ CÃ³ thá»ƒ mÃ´ phá»ng hÃ nh vi break báº±ng:

Biáº¿n cá» (flag) â†’ cÃ¡c nhÃ¡nh kiá»ƒm tra vÃ  tá»± thoÃ¡t.

Pick â†’ tá»± Ä‘á»™ng dá»«ng cÃ¡c nhÃ¡nh khÃ¡c khi má»™t nhÃ¡nh hoÃ n thÃ nh.

Throw â†’ thoÃ¡t cÆ°á»¡ng bá»©c (chá»‰ khi cáº§n dá»«ng toÃ n flow).





---

Náº¿u báº¡n cho mÃ¬nh biáº¿t rÃµ hÆ¡n flow cá»¥ thá»ƒ (vÃ­ dá»¥:

NhÃ¡nh 1: â€œRun macro trong Excel Application Scopeâ€

NhÃ¡nh 2: â€œChá» popup, gÃµ path, nháº¥n OKâ€),
thÃ¬ mÃ¬nh cÃ³ thá»ƒ váº½ láº¡i cho báº¡n má»™t workflow máº«u báº±ng Pick hoáº·c flag logic Ä‘á»ƒ báº¡n copy vÃ o UiPath cháº¡y luÃ´n.
Báº¡n muá»‘n mÃ¬nh minh há»a theo hÆ°á»›ng nÃ o â€” Pick hay flag Boolean?
