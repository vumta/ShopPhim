Ráº¥t hay â€” chi tiáº¿t title â€œFile Openâ€ lÃ  manh má»‘i quan trá»ng ğŸ”

Náº¿u popup mÃ  Excel má»Ÿ ra cÃ³ tiÃªu Ä‘á» â€œFile Openâ€, thÃ¬ kháº£ nÄƒng macro cá»§a báº¡n khÃ´ng dÃ¹ng GetSaveAsFilename hay FileDialog(msoFileDialogSaveAs), mÃ  Ä‘ang gá»i má»™t trong cÃ¡c hÃ m sau:


---

ğŸ§© 1. Macro gá»i Application.GetOpenFilename

ÄÃ¢y lÃ  trÆ°á»ng há»£p phá»• biáº¿n nháº¥t khi báº¡n tháº¥y â€œFile Openâ€ trÃªn title bar.

VÃ­ dá»¥ code:

Dim filePath As Variant
filePath = Application.GetOpenFilename("CSV Files (*.csv), *.csv", , "File Open")
If filePath = False Then Exit Sub

ğŸŸ  GetOpenFilename chá»‰ má»Ÿ há»™p thoáº¡i chá»n file, chá»© khÃ´ng lÆ°u file.
NÃ³ dÃ¹ng khi macro muá»‘n ngÆ°á»i dÃ¹ng chá»n file Ä‘áº§u vÃ o, khÃ´ng pháº£i chá»n nÆ¡i lÆ°u.


---

ğŸ§© 2. Náº¿u macro thá»±c sá»± export CSV thÃ¬ cÃ³ thá»ƒ logic lÃ :

Má»Ÿ SaveAs dialog, nhÆ°ng do láº­p trÃ¬nh sai, Ä‘ang gá»i nháº§m GetOpenFilename â†’ popup â€œFile Openâ€.

Hoáº·c dÃ¹ng Application.FileDialog(msoFileDialogFilePicker) thay vÃ¬ msoFileDialogSaveAs.


VÃ­ dá»¥ gÃ¢y lá»—i:

Dim fd As FileDialog
Set fd = Application.FileDialog(msoFileDialogFilePicker)  'âŒ

â†’ sáº½ ra â€œFile Openâ€ dialog.

CÃ²n Ä‘Ãºng Ä‘á»ƒ chá»n nÆ¡i lÆ°u pháº£i lÃ :

Set fd = Application.FileDialog(msoFileDialogSaveAs)  'âœ…


---

ğŸ§© 3. XÃ¡c Ä‘á»‹nh Ä‘Ãºng dÃ²ng gÃ¢y popup

Báº¡n cÃ³ thá»ƒ tÃ¬m trong macro cÃ¡c dÃ²ng:

Application.GetOpenFilename
Application.GetSaveAsFilename
Application.FileDialog(

Hoáº·c:

Dialogs(xlDialogSaveAs).Show
Dialogs(xlDialogOpen).Show

ğŸ‘‰ Náº¿u lÃ  GetOpenFilename hay xlDialogOpen, thÃ¬ popup chÃ­nh lÃ  â€œFile Openâ€.


---

âœ… CÃ¡ch kháº¯c phá»¥c Ä‘á»ƒ cháº¡y trong UiPath

VÃ¬ UiPath khÃ´ng thá»ƒ nháº­p Ä‘Æ°á»ng dáº«n vÃ o há»™p thoáº¡i â€œFile Openâ€ do Ä‘Ã¢y lÃ  UI modal blocking, nÃªn báº¡n cáº§n sá»­a macro:

Loáº¡i bá» lá»‡nh GetOpenFilename hoáº·c FileDialog(msoFileDialogFilePicker),

Thay báº±ng viá»‡c truyá»n Ä‘Æ°á»ng dáº«n file trá»±c tiáº¿p (báº±ng parameter hoáº·c tá»« má»™t Ã´ trong sheet).



---

ğŸ“˜ VÃ­ dá»¥ sá»­a macro gá»‘c (tá»« GetOpenFilename â†’ nháº­n Ä‘Æ°á»ng dáº«n)

Giáº£ sá»­ macro báº¡n Ä‘ang cÃ³:

Sub ExportSheet()
    Dim filePath As Variant
    filePath = Application.GetOpenFilename("CSV Files (*.csv), *.csv", , "File Open")
    If filePath = False Then Exit Sub

    ThisWorkbook.Sheets("Data").Copy
    ActiveWorkbook.SaveAs Filename:=filePath, FileFormat:=6
    ActiveWorkbook.Close False
End Sub

â†’ ThÃ¬ báº¡n sá»­a thÃ nh:

Sub ExportSheetDirect(ByVal outPath As String)
    If Trim(outPath) = "" Then Exit Sub
    ThisWorkbook.Sheets("Data").Copy
    ActiveWorkbook.SaveAs Filename:=outPath, FileFormat:=6
    ActiveWorkbook.Close False
End Sub


---

ğŸ“Œ Tá»•ng káº¿t nhanh

TÃªn lá»‡nh trong macro	Popup hiá»ƒn thá»‹	Má»¥c Ä‘Ã­ch	Ghi chÃº

Application.GetOpenFilename	â€œFile Openâ€	Chá»n file Ä‘áº§u vÃ o	KhÃ´ng lÆ°u file, chá»‰ láº¥y Ä‘Æ°á»ng dáº«n
Application.GetSaveAsFilename	â€œSave Asâ€	Chá»n file Ä‘áº§u ra	KhÃ´ng tá»± lÆ°u, cáº§n SaveAs sau Ä‘Ã³
Application.FileDialog(msoFileDialogFilePicker)	â€œFile Openâ€	Chá»n file Ä‘áº§u vÃ o	CÃ³ thá»ƒ Ä‘á»•i thÃ nh SaveAs
Application.FileDialog(msoFileDialogSaveAs)	â€œSave Asâ€	Chá»n nÆ¡i lÆ°u	ThÆ°á»ng dÃ¹ng Ä‘á»ƒ export



---

ğŸ‘‰ Náº¿u báº¡n dÃ¡n Ä‘oáº¡n VBA hiá»‡n táº¡i cá»§a báº¡n vÃ o Ä‘Ã¢y, mÃ¬nh cÃ³ thá»ƒ:

XÃ¡c Ä‘á»‹nh chÃ­nh xÃ¡c dÃ²ng nÃ o má»Ÿ â€œFile Openâ€

Viáº¿t láº¡i giÃºp báº¡n 1 phiÃªn báº£n khÃ´ng cáº§n popup, sáºµn sÃ ng Ä‘á»ƒ gá»i tá»« UiPath (truyá»n Ä‘Æ°á»ng dáº«n trá»±c tiáº¿p).


Báº¡n cÃ³ thá»ƒ gá»­i Ä‘oáº¡n macro export hiá»‡n táº¡i cho mÃ¬nh xem khÃ´ng?
