Tuyá»‡t vá»i! DÆ°á»›i Ä‘Ã¢y lÃ  **hÆ°á»›ng dáº«n chi tiáº¿t tá»«ng bÆ°á»›c** Ä‘á»ƒ cáº¥u hÃ¬nh **gá»­i HTTP Request láº¥y Access Token** tá»« Microsoft trong **UiPath**, sá»­ dá»¥ng **tÃ i khoáº£n ngÆ°á»i dÃ¹ng (ROPC flow - khÃ´ng dÃ¹ng MFA)**.

---

## ğŸ¯ Má»¥c tiÃªu:
DÃ¹ng UiPath Ä‘á»ƒ gá»­i HTTP POST Ä‘áº¿n:
```
https://login.microsoftonline.com/common/oauth2/v2.0/token
```
Nháº±m **láº¥y access token** Ä‘á»ƒ gá»i SharePoint API (Graph API).

---

## ğŸ§° Báº¡n cáº§n:

| ThÃ´ng tin           | VÃ­ dá»¥                                   |
|---------------------|------------------------------------------|
| Username            | `abc@contoso.com`                        |
| Password            | Máº­t kháº©u tÃ i khoáº£n SharePoint            |
| Client ID           | `d3590ed6-52b3-4102-aeff-aad2292ab01c` *(á»©ng dá»¥ng máº·c Ä‘á»‹nh cho ROPC)* |
| Scope               | `https://graph.microsoft.com/.default`   |
| Grant Type          | `password`                               |

---

## ğŸªœ GUIDE STEP BY STEP â€“ Gá»¬I HTTP REQUEST Láº¤Y TOKEN

### âœ… BÆ°á»›c 1: ThÃªm activity `HTTP Request`

- KÃ©o **HTTP Request** tá»« `UiPath.WebAPI.Activities`
- Äá»•i tÃªn activity thÃ nh: `Get Access Token`

---

### âœ… BÆ°á»›c 2: Cáº¥u hÃ¬nh properties nhÆ° sau:

| Thuá»™c tÃ­nh       | GiÃ¡ trá»‹ |
|------------------|---------|
| **EndPoint**     | `https://login.microsoftonline.com/common/oauth2/v2.0/token` |
| **Method**       | `POST` |
| **BodyFormat**   | `application/x-www-form-urlencoded` |
| **Body**         |  
```plaintext
client_id=d3590ed6-52b3-4102-aeff-aad2292ab01c&scope=https%3A%2F%2Fgraph.microsoft.com%2F.default&username=abc@contoso.com&password=your_password_here&grant_type=password
```
*(Thay `abc@contoso.com` vÃ  `your_password_here` báº±ng biáº¿n náº¿u cáº§n)*

| **Headers**      | ThÃªm 1 header:  
Key = `Content-Type`  
Value = `application/x-www-form-urlencoded` |

| **Output** â†’ Response | GÃ¡n vÃ o biáº¿n: `accessTokenResponse` (kiá»ƒu `String`) |

---

### âœ… BÆ°á»›c 3: TÃ¡ch Access Token tá»« response

- DÃ¹ng `Deserialize JSON` Ä‘á»ƒ tÃ¡ch token:
```vb
JObject.Parse(accessTokenResponse)("access_token").ToString
```

- GÃ¡n giÃ¡ trá»‹ nÃ y vÃ o biáº¿n `accessToken` (kiá»ƒu String) Ä‘á»ƒ dÃ¹ng á»Ÿ cÃ¡c bÆ°á»›c sau.

---

## âœ… Máº«u UiPath Flow sÆ¡ lÆ°á»£c:

```
[HTTP Request] Get Access Token â†’ lÆ°u vÃ o: accessTokenResponse
[Assign] accessToken = JObject.Parse(accessTokenResponse)("access_token").ToString
```

---

âœ… Sau khi láº¥y `accessToken`, báº¡n cÃ³ thá»ƒ dÃ¹ng nÃ³ Ä‘á»ƒ gá»i SharePoint API nhÆ°:
```http
GET https://graph.microsoft.com/v1.0/sites/{domain}:/sites/{siteName}:/drive/root:/Documents/Reports:/children
```
â†’ ThÃªm vÃ o header:
```
Authorization: Bearer your_access_token_here
```

---

Báº¡n muá»‘n mÃ¬nh demo Ä‘oáº¡n nÃ y luÃ´n trong `.xaml` máº«u Ä‘á»ƒ dá»… hÃ¬nh dung hÆ¡n khÃ´ng? MÃ¬nh cÃ³ thá»ƒ cáº­p nháº­t thÃªm!
