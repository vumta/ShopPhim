DÆ°á»›i Ä‘Ã¢y lÃ  Ä‘oáº¡n code VB.NET hoÃ n chá»‰nh, dÃ¹ng trong Invoke Code activity cá»§a UiPath Ä‘á»ƒ:

âœ… Copy file template.csv â†’ file data.csv
âœ… Ghi toÃ n bá»™ ná»™i dung cá»§a data.csv (gá»‘c) báº¯t Ä‘áº§u tá»« dÃ²ng sá»‘ 5
âœ… Giá»¯ nguyÃªn 4 dÃ²ng Ä‘áº§u tá»« template.csv (náº¿u thiáº¿u thÃ¬ thÃªm dÃ²ng trá»‘ng)
âœ… KhÃ´ng dÃ¹ng Excel Application Scope â€“ hoáº¡t Ä‘á»™ng vá»›i file ráº¥t lá»›n >450MB


---

ğŸ§© Biáº¿n Ä‘áº§u vÃ o trong UiPath (Argument direction: In)

TÃªn biáº¿n	Kiá»ƒu dá»¯ liá»‡u	Ghi chÃº

templatePath	String	ÄÆ°á»ng dáº«n file template.csv gá»‘c
dataPath	String	ÄÆ°á»ng dáº«n file data.csv Ä‘Ã£ táº£i vá» (gá»‘c)



---

ğŸ” Logic xá»­ lÃ½

1. Táº¡o file táº¡m temp.csv


2. Ghi 4 dÃ²ng Ä‘áº§u tá»« template (náº¿u thiáº¿u thÃ¬ thÃªm dÃ²ng trá»‘ng)


3. Ghi toÃ n bá»™ ná»™i dung data.csv tá»« dÃ²ng thá»© 5


4. Ghi Ä‘Ã¨ data.csv báº±ng temp.csv




---

âœ… Code VB.NET dÃ¹ng trong Invoke Code:

Dim tempPath As String = System.IO.Path.GetTempFileName()

' Äá»c 4 dÃ²ng Ä‘áº§u tá»« template (hoáº·c thÃªm dÃ²ng trá»‘ng náº¿u thiáº¿u)
Dim templateLines As New List(Of String)
Using readerTemplate As New System.IO.StreamReader(templatePath, System.Text.Encoding.UTF8)
    While Not readerTemplate.EndOfStream AndAlso templateLines.Count < 4
        templateLines.Add(readerTemplate.ReadLine())
    End While
End Using

While templateLines.Count < 4
    templateLines.Add("")
End While

' Má»Ÿ file táº¡m Ä‘á»ƒ ghi dá»¯ liá»‡u
Using writer As New System.IO.StreamWriter(tempPath, False, System.Text.Encoding.UTF8)

    ' Ghi 4 dÃ²ng Ä‘áº§u
    For Each line In templateLines
        writer.WriteLine(line)
    Next

    ' Ghi toÃ n bá»™ data.csv báº¯t Ä‘áº§u tá»« dÃ²ng 5
    Using readerData As New System.IO.StreamReader(dataPath, System.Text.Encoding.UTF8)
        While Not readerData.EndOfStream
            writer.WriteLine(readerData.ReadLine())
        End While
    End Using

End Using

' Ghi Ä‘Ã¨ láº¡i file dataPath báº±ng file temp
System.IO.File.Copy(tempPath, dataPath, True)
System.IO.File.Delete(tempPath)


---

ğŸ“Œ LÆ°u Ã½:

File template.csv cáº§n tá»“n táº¡i.

File data.csv cÃ³ thá»ƒ ráº¥t lá»›n, xá»­ lÃ½ báº±ng stream nÃªn khÃ´ng lo tá»‘n RAM.

KhÃ´ng sá»­ dá»¥ng Excel, hoÃ n toÃ n dá»±a trÃªn xá»­ lÃ½ vÄƒn báº£n.



---

Báº¡n cáº§n mÃ¬nh xuáº¥t .xaml máº«u cho UiPath hoáº·c gá»£i Ã½ chi tiáº¿t cho hoáº¡t Ä‘á»™ng Invoke Code khÃ´ng?

