Ráº¥t rÃµ rÃ ng. Báº¡n muá»‘n má»™t VBA script thá»±c hiá»‡n cÃ¡c bÆ°á»›c sau (Ä‘á»ƒ gá»i tá»« UiPath báº±ng Invoke VBA):


---

âœ… YÃªu cáº§u cá»¥ thá»ƒ

Giáº£ sá»­ báº¡n cÃ³:

template.csv: chá»©a sáºµn 4 dÃ²ng Ä‘áº§u (header chuáº©n)

data.csv: file má»›i táº£i vá», dung lÆ°á»£ng >450MB, khÃ´ng cÃ³ header

Má»¥c tiÃªu: Táº¡o báº£n sao cá»§a template.csv, sau Ä‘Ã³ ná»‘i ná»™i dung data.csv vÃ o cuá»‘i, rá»“i Ä‘á»•i tÃªn file káº¿t quáº£ thÃ nh data.csv (ghi Ä‘Ã¨).



---

âœ… Káº¿t quáº£ mong muá»‘n

template.csv (giá»¯ nguyÃªn)

data.csv ban Ä‘áº§u â†’ bá»‹ xÃ³a

data.csv má»›i = 4 dÃ²ng Ä‘áº§u tá»« template.csv + ná»™i dung gá»‘c cá»§a data.csv



---

âœ… VBA Code: MergeTemplateWithData.bas

Sub MergeTemplateWithData(templatePath As String, dataPath As String)
    Dim fso As Object
    Dim tempPath As String
    Dim templateFile As Object
    Dim dataFile As Object
    Dim outputFile As Object
    Dim line As String

    ' Táº¡o FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")

    ' Táº¡o file táº¡m
    tempPath = dataPath & ".tmp"

    ' Má»Ÿ file táº¡m Ä‘á»ƒ ghi
    Set outputFile = fso.CreateTextFile(tempPath, True, True) ' Overwrite, UTF-8

    ' Má»Ÿ vÃ  ghi toÃ n bá»™ template vÃ o Ä‘áº§u
    Set templateFile = fso.OpenTextFile(templatePath, 1, False, -1)
    Do While Not templateFile.AtEndOfStream
        line = templateFile.ReadLine
        outputFile.WriteLine line
    Loop
    templateFile.Close

    ' Má»Ÿ file data gá»‘c, ná»‘i vÃ o sau
    Set dataFile = fso.OpenTextFile(dataPath, 1, False, -1)
    Do While Not dataFile.AtEndOfStream
        line = dataFile.ReadLine
        outputFile.WriteLine line
    Loop
    dataFile.Close
    outputFile.Close

    ' XÃ³a file gá»‘c
    fso.DeleteFile dataPath, True

    ' Äá»•i tÃªn file táº¡m thÃ nh tÃªn file gá»‘c
    fso.MoveFile tempPath, dataPath
End Sub


---

ğŸ› ï¸ CÃ¡ch dÃ¹ng trong UiPath (Invoke VBA)

BÆ°á»›c 1: LÆ°u Ä‘oáº¡n trÃªn thÃ nh file MergeTemplateWithData.bas

BÆ°á»›c 2: Trong UiPath, sá»­ dá»¥ng activity:

Excel Application Scope (báº¥t ká»³ Excel file nÃ o, hoáº·c táº¡o file táº¡m náº¿u khÃ´ng cÃ³)

BÆ°á»›c 3: Invoke VBA cáº¥u hÃ¬nh:

Thuá»™c tÃ­nh	GiÃ¡ trá»‹

CodeFilePath	"MergeTemplateWithData.bas"
EntryMethodName	"MergeTemplateWithData"
Parameters	{New InArgument(Of Object)("C:\Path\template.csv"), New InArgument(Of Object)("C:\Path\data.csv")}



---

âœ… Æ¯u Ä‘iá»ƒm

Xá»­ lÃ½ Ä‘Æ°á»£c file lá»›n vÃ¬ hoáº¡t Ä‘á»™ng theo dÃ²ng

KhÃ´ng cáº§n má»Ÿ Excel file

Giá»¯ nguyÃªn template, khÃ´ng áº£nh hÆ°á»Ÿng

Cháº¡y nhanh vÃ  an toÃ n khi gá»i tá»« UiPath



---

Báº¡n cÃ³ muá»‘n mÃ¬nh:

Táº¡o sáºµn .bas file nÃ©n .zip Ä‘á»ƒ báº¡n dÃ¹ng luÃ´n?

HÆ°á»›ng dáº«n cÃ¡ch táº¡o Excel Application Scope giáº£ (náº¿u báº¡n khÃ´ng cÃ³ file Excel)?


Cá»© nÃ³i mÃ¬nh há»— trá»£ tiáº¿p nhÃ©.
