Cáº£m Æ¡n báº¡n Ä‘Ã£ lÃ m rÃµ. DÆ°á»›i Ä‘Ã¢y lÃ  giáº£i phÃ¡p Ä‘áº§y Ä‘á»§ theo yÃªu cáº§u má»›i:


---

âœ… YÃªu cáº§u tá»•ng quÃ¡t:

1. CÃ³ sáºµn file template.csv chá»©a 4 dÃ²ng Ä‘áº§u.


2. CÃ³ file data.csv ráº¥t lá»›n (>450MB).


3. Má»¥c tiÃªu:

Copy template.csv â†’ temp file (vÃ­ dá»¥: temp_output.csv).

Ghi toÃ n bá»™ dá»¯ liá»‡u tá»« data.csv vÃ o temp_output.csv, báº¯t Ä‘áº§u tá»« dÃ²ng 5 (sau 4 dÃ²ng Ä‘áº§u).

Sau khi ghi xong, overwrite data.csv báº±ng temp_output.csv (tá»©c lÃ : data.csv sau khi xá»­ lÃ½ sáº½ cÃ³ 4 dÃ²ng Ä‘áº§u + toÃ n bá»™ data gá»‘c cá»§a nÃ³).





---

âœ… VB.NET Code Ä‘á»ƒ dÃ¹ng trong UiPath (Invoke Code activity)

ðŸ”§ Code:

' Kiá»ƒm tra file tá»“n táº¡i
If Not System.IO.File.Exists(templatePath) Then
    Throw New Exception("Template file not found: " & templatePath)
End If

If Not System.IO.File.Exists(dataPath) Then
    Throw New Exception("Data file not found: " & dataPath)
End If

' Táº¡o file táº¡m
Dim tempPath As String = System.IO.Path.Combine(System.IO.Path.GetDirectoryName(dataPath), "temp_output.csv")

' Copy 4 dÃ²ng Ä‘áº§u tá»« template vÃ o file táº¡m
Using reader As New System.IO.StreamReader(templatePath, System.Text.Encoding.UTF8)
    Using writer As New System.IO.StreamWriter(tempPath, False, System.Text.Encoding.UTF8)
        Dim lineCount As Integer = 0
        While Not reader.EndOfStream AndAlso lineCount < 4
            writer.WriteLine(reader.ReadLine())
            lineCount += 1
        End While
    End Using
End Using

' Append toÃ n bá»™ dá»¯ liá»‡u tá»« data.csv vÃ o temp
Using writer As New System.IO.StreamWriter(tempPath, True, System.Text.Encoding.UTF8)
    Using reader As New System.IO.StreamReader(dataPath, System.Text.Encoding.UTF8)
        While Not reader.EndOfStream
            writer.WriteLine(reader.ReadLine())
        End While
    End Using
End Using

' Ghi Ä‘Ã¨ file data.csv báº±ng file temp
System.IO.File.Delete(dataPath)
System.IO.File.Move(tempPath, dataPath)


---

ðŸ§© Biáº¿n Ä‘áº§u vÃ o cáº§n truyá»n vÃ o Invoke Code:

Biáº¿n	Direction	Type	MÃ´ táº£

templatePath	In	String	ÄÆ°á»ng dáº«n Ä‘áº¿n template.csv
dataPath	In	String	ÄÆ°á»ng dáº«n Ä‘áº¿n data.csv gá»‘c



---

âœ… Æ¯u Ä‘iá»ƒm:

KhÃ´ng cáº§n dÃ¹ng Excel Application Scope.

Xá»­ lÃ½ file lá»›n hiá»‡u quáº£, Ä‘á»c vÃ  ghi dÃ²ng tá»«ng dÃ²ng.

An toÃ n: khÃ´ng lÃ m máº¥t dá»¯ liá»‡u náº¿u chÆ°a xá»­ lÃ½ xong (dÃ¹ng file táº¡m).



---

Náº¿u báº¡n cáº§n báº£n .xaml hoÃ n chá»‰nh hoáº·c Ä‘Ã³ng gÃ³i láº¡i thÃ nh custom library, mÃ¬nh cÃ³ thá»ƒ giÃºp luÃ´n. Báº¡n chá»‰ cáº§n bÃ¡o nhÃ©.

