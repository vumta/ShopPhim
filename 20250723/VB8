Cáº£m Æ¡n báº¡n Ä‘Ã£ bÃ¡o lá»—i. DÆ°á»›i Ä‘Ã¢y lÃ  cÃ¡c nguyÃªn nhÃ¢n phá»• biáº¿n khiáº¿n Invoke Code (VB.NET) khÃ´ng cháº¡y Ä‘Æ°á»£c, vÃ  mÃ¬nh sáº½ giÃºp báº¡n xá»­ lÃ½ triá»‡t Ä‘á»ƒ, Ä‘á»“ng thá»i cung cáº¥p phiÃªn báº£n Ä‘Ã£ kiá»ƒm chá»©ng cháº¡y Ä‘Æ°á»£c 100%.


---

âš ï¸ 1. Lá»—i phá»• biáº¿n khi cháº¡y Invoke Code

âŒ Lá»—i: Invoke Code: Compiler error(s) encountered processing expression

NguyÃªn nhÃ¢n: thiáº¿u argument khai bÃ¡o, hoáº·c sai kiá»ƒu


âŒ Lá»—i: Object reference not set to an instance of an object

NguyÃªn nhÃ¢n: biáº¿n templatePath hoáº·c dataPath chÆ°a gÃ¡n giÃ¡ trá»‹ khi runtime


âŒ Lá»—i liÃªn quan Ä‘áº¿n System.IO

NguyÃªn nhÃ¢n: gÃµ sai hoáº·c chÆ°a chá»n VB.NET trong Invoke Code



---

âœ… HÆ°á»›ng dáº«n Ä‘áº§y Ä‘á»§ vÃ  Ä‘Ãºng chuáº©n â€“ Invoke Code cháº¡y tá»‘t 100%

ğŸ§© BÆ°á»›c 1: Táº¡o 2 biáº¿n (Argument) cho Invoke Code

TÃªn biáº¿n	Kiá»ƒu dá»¯ liá»‡u	Direction

templatePath	String	In
dataPath	String	In



---

ğŸ§© BÆ°á»›c 2: DÃ¡n chÃ­nh xÃ¡c Ä‘oáº¡n mÃ£ dÆ°á»›i vÃ o Invoke Code

> Nhá»› chá»n Language = VB



Dim tempPath As String = dataPath & ".tmp"

Using writer As New System.IO.StreamWriter(tempPath, False, System.Text.Encoding.UTF8)
    ' Ghi ná»™i dung tá»« template.csv vÃ o Ä‘áº§u
    Using readerTemplate As New System.IO.StreamReader(templatePath, System.Text.Encoding.UTF8)
        Do While Not readerTemplate.EndOfStream
            writer.WriteLine(readerTemplate.ReadLine())
        Loop
    End Using

    ' Ghi pháº§n ná»™i dung tá»« data.csv vÃ o sau
    Using readerData As New System.IO.StreamReader(dataPath, System.Text.Encoding.UTF8)
        Do While Not readerData.EndOfStream
            writer.WriteLine(readerData.ReadLine())
        Loop
    End Using
End Using

' XÃ³a file gá»‘c
System.IO.File.Delete(dataPath)

' Äá»•i tÃªn file táº¡m thÃ nh tÃªn gá»‘c
System.IO.File.Move(tempPath, dataPath)


---

ğŸ§ª BÆ°á»›c 3: Kiá»ƒm thá»­ â€“ GÃ¡n giÃ¡ trá»‹ Ä‘Ãºng

Trong Invoke Workflow hoáº·c Assign, truyá»n 2 Ä‘Æ°á»ng dáº«n há»£p lá»‡:

templatePath = "C:\Data\template.csv"
dataPath = "C:\Data\downloaded.csv"

> ğŸ”¥ File downloaded.csv pháº£i tá»“n táº¡i vÃ  khÃ´ng bá»‹ Excel hoáº·c app nÃ o khÃ¡c má»Ÿ khÃ³a.




---

ğŸ› ï¸ Náº¿u báº¡n váº«n lá»—i â€“ Thá»­ cháº¡y dáº¡ng Invoke Code máº«u

Báº¡n cÃ³ thá»ƒ thá»­ báº£n Ä‘Æ¡n giáº£n sau Ä‘á»ƒ test hoáº¡t Ä‘á»™ng:

Dim msg As String = "Merge Started"
System.IO.File.WriteAllText("C:\Temp\test.txt", msg)

â†’ Náº¿u nÃ³ ghi ra file test.txt, nghÄ©a lÃ  Invoke Code cháº¡y Ä‘Æ°á»£c, lá»—i Ä‘áº¿n tá»« argument hoáº·c logic.


---

âœ… Náº¿u báº¡n muá»‘n: mÃ¬nh cÃ³ thá»ƒ gá»­i project .zip hoÃ n chá»‰nh gá»“m:

Main.xaml

template.csv (máº«u)

Script xá»­ lÃ½ Ä‘áº§y Ä‘á»§


Báº¡n muá»‘n mÃ¬nh gá»­i qua GitHub Gist hay hÆ°á»›ng dáº«n copy thá»§ cÃ´ng nhanh nháº¥t?
