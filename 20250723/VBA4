DÆ°á»›i Ä‘Ã¢y lÃ  mÃ£ VBA hoÃ n chá»‰nh Ä‘á»ƒ thá»±c hiá»‡n yÃªu cáº§u:

> âœ… ThÃªm 4 dÃ²ng vÃ o Ä‘áº§u file CSV lá»›n (~450MB) mÃ  khÃ´ng load toÃ n bá»™ file vÃ o Excel, dÃ¹ng cÃ¡ch xá»­ lÃ½ tá»«ng dÃ²ng. Äoáº¡n mÃ£ nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i tá»« UiPath qua Invoke VBA.




---

âœ… 1. Ná»™i dung mÃ£ VBA (InsertHeaderToCSV.bas)

Sub InsertHeaderToCSV(csvPath As String)
    Dim tempPath As String
    Dim fso As Object
    Dim inputFile As Object
    Dim outputFile As Object
    Dim line As String
    
    ' Táº¡o Ä‘Æ°á»ng dáº«n file táº¡m
    tempPath = csvPath & ".tmp"
    
    ' Táº¡o FileSystemObject
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    ' Má»Ÿ file táº¡m Ä‘á»ƒ ghi
    Set outputFile = fso.CreateTextFile(tempPath, True, True) ' True = Overwrite, True = UTF-8

    ' Ghi 4 dÃ²ng Ä‘áº§u tiÃªn
    outputFile.WriteLine "DÃ²ng 1 thÃªm vÃ o"
    outputFile.WriteLine "DÃ²ng 2 thÃªm vÃ o"
    outputFile.WriteLine "DÃ²ng 3 thÃªm vÃ o"
    outputFile.WriteLine "DÃ²ng 4 thÃªm vÃ o"
    
    ' Má»Ÿ file CSV gá»‘c Ä‘á»ƒ Ä‘á»c
    Set inputFile = fso.OpenTextFile(csvPath, 1, False, -1) ' 1 = ForReading, -1 = UTF-8

    ' Ghi tá»«ng dÃ²ng tá»« file gá»‘c sang file táº¡m
    Do While Not inputFile.AtEndOfStream
        line = inputFile.ReadLine
        outputFile.WriteLine line
    Loop

    ' ÄÃ³ng file
    inputFile.Close
    outputFile.Close

    ' XÃ³a file gá»‘c
    fso.DeleteFile csvPath, True

    ' Äá»•i tÃªn file táº¡m thÃ nh file gá»‘c
    fso.MoveFile tempPath, csvPath
End Sub


---

âœ… 2. CÃ¡ch dÃ¹ng trong UiPath (Invoke VBA)

ğŸ§© BÆ°á»›c 1: ThÃªm file .bas vÃ o thÆ° má»¥c chá»©a project hoáº·c Excel

ğŸ§© BÆ°á»›c 2: DÃ¹ng Activity Invoke VBA

Code File Path: "InsertHeaderToCSV.bas"

Entry Method Name: "InsertHeaderToCSV"

Parameters:

{New InArgument(Of Object)("C:\Data\file.csv")}




---

âœ… Ghi chÃº

File Ä‘Æ°á»£c xá»­ lÃ½ theo dÃ²ng â†’ an toÃ n vá»›i file lá»›n (450MB+)

Äáº£m báº£o ghi Ä‘Ãºng Ä‘á»‹nh dáº¡ng UTF-8

KhÃ´ng cáº§n má»Ÿ Excel

Thá»±c thi nhanh, phÃ¹ há»£p Ä‘á»ƒ gá»i tá»« UiPath trong mÃ´i trÆ°á»ng khÃ´ng cáº§n PowerShell



---

Báº¡n cÃ³ muá»‘n mÃ¬nh táº¡o sáºµn file .bas vÃ  gá»­i ná»™i dung Ä‘Ã³ng gÃ³i dáº¡ng .zip? Hoáº·c hÆ°á»›ng dáº«n dÃ¹ng Invoke VBA trong Excel Application Scope chi tiáº¿t hÆ¡n?

