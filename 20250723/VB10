Cáº£m Æ¡n báº¡n Ä‘Ã£ lÃ m rÃµ. Náº¿u báº¡n muá»‘n:

> Ghi toÃ n bá»™ dá»¯ liá»‡u tá»« data.csv báº¯t Ä‘áº§u tá»« dÃ²ng sá»‘ 5 cá»§a file káº¿t quáº£,
tá»©c lÃ  bá» qua 4 dÃ²ng Ä‘áº§u cá»§a data.csv (giáº£ sá»­ Ä‘Ã³ lÃ  header hoáº·c metadata khÃ´ng cáº§n dÃ¹ng),
nhÆ°ng váº«n giá»¯ 4 dÃ²ng Ä‘áº§u cá»§a template.csv, thÃ¬ Ä‘Ã¢y lÃ  cÃ¡ch lÃ m:




---

âœ… Cáº­p nháº­t Ä‘oáº¡n code .NET dÃ¹ng trong Invoke Code (VB.NET):

If Not System.IO.File.Exists(templatePath) Then
    Throw New Exception("Template file not found: " & templatePath)
End If

If Not System.IO.File.Exists(dataPath) Then
    Throw New Exception("Data file not found: " & dataPath)
End If

Dim tempPath As String = dataPath & ".tmp"

Using writer As New System.IO.StreamWriter(tempPath, False, System.Text.Encoding.UTF8)

    ' Ghi 4 dÃ²ng Ä‘áº§u tá»« template
    Using readerTemplate As New System.IO.StreamReader(templatePath, System.Text.Encoding.UTF8)
        Dim count As Integer = 0
        While Not readerTemplate.EndOfStream AndAlso count < 4
            writer.WriteLine(readerTemplate.ReadLine())
            count += 1
        End While
    End Using

    ' Ghi tá»« dÃ²ng thá»© 5 trá»Ÿ Ä‘i trong file data
    Using readerData As New System.IO.StreamReader(dataPath, System.Text.Encoding.UTF8)
        Dim lineCount As Integer = 0
        While Not readerData.EndOfStream
            Dim line As String = readerData.ReadLine()
            lineCount += 1
            If lineCount > 4 Then
                writer.WriteLine(line)
            End If
        End While
    End Using

End Using

' Ghi Ä‘Ã¨ láº¡i file gá»‘c
System.IO.File.Delete(dataPath)
System.IO.File.Move(tempPath, dataPath)


---

ğŸ¯ Giáº£i thÃ­ch logic:

template.csv: giá»¯ nguyÃªn 4 dÃ²ng Ä‘áº§u â†’ ghi vÃ o káº¿t quáº£

data.csv: bá» qua 4 dÃ²ng Ä‘áº§u tiÃªn â†’ báº¯t Ä‘áº§u ghi tá»« dÃ²ng thá»© 5 trá»Ÿ Ä‘i



---

ğŸ§© Biáº¿n truyá»n vÃ o:

Name	Direction	Type

templatePath	In	String
dataPath	In	String



---

Náº¿u báº¡n muá»‘n mÃ¬nh:

Gá»­i file .xaml máº«u Ä‘áº§y Ä‘á»§,

Hoáº·c Ä‘Ã³ng gÃ³i .nupkg Ä‘á»ƒ báº¡n chá»‰ cáº§n dÃ¹ng nhÆ° custom activity,


hÃ£y nÃ³i nhÃ©, mÃ¬nh gá»­i ngay.

