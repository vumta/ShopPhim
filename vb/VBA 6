DÆ°á»›i Ä‘Ã¢y lÃ  phiÃªn báº£n dá»‹ch sang tiáº¿ng Viá»‡t cá»§a Ä‘oáº¡n hÆ°á»›ng dáº«n vÃ  mÃ£ VBA:

---

### **MÃ£ cho file .bas**

```vba
Public Function ListFilesFromSharePoint(ByVal FolderPath As String, ByVal ExcelFilePath As String) As String
    Dim ExcelWorkbook As Workbook
    Dim ExcelWorksheet As Worksheet
    Dim FileSystemObj As Object
    Dim FolderObj As Object
    Dim FileObj As Object
    Dim SubFolderObj As Object
    Dim RowIndex As Long

    On Error GoTo ErrorHandler

    ' Má»Ÿ file Excel nÆ¡i káº¿t quáº£ sáº½ Ä‘Æ°á»£c ghi láº¡i
    Set ExcelWorkbook = Workbooks.Open(ExcelFilePath)
    Set ExcelWorksheet = ExcelWorkbook.Sheets(1)

    ' XÃ³a dá»¯ liá»‡u cÅ© trong trang tÃ­nh
    ExcelWorksheet.Cells.Clear

    ' Ghi tiÃªu Ä‘á» cá»™t
    ExcelWorksheet.Cells(1, 1).Value = "TÃªn Tá»‡p"
    ExcelWorksheet.Cells(1, 2).Value = "ÄÆ°á»ng Dáº«n Tá»‡p"

    ' Táº¡o FileSystemObject vÃ  láº¥y thÆ° má»¥c Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
    Set FileSystemObj = CreateObject("Scripting.FileSystemObject")
    Set FolderObj = FileSystemObj.GetFolder(FolderPath)

    ' Khá»Ÿi táº¡o chá»‰ sá»‘ hÃ ng Ä‘á»ƒ ghi dá»¯ liá»‡u
    RowIndex = 2

    ' Gá»i hÃ m Ä‘á»‡ quy Ä‘á»ƒ liá»‡t kÃª cÃ¡c tá»‡p
    Call ListFilesRecursive(FolderObj, ExcelWorksheet, RowIndex)

    ' LÆ°u vÃ  Ä‘Ã³ng file Excel
    ExcelWorkbook.Save
    ExcelWorkbook.Close False

    ListFilesFromSharePoint = "ThÃ nh cÃ´ng: ÄÃ£ liá»‡t kÃª cÃ¡c tá»‡p vÃ  lÆ°u vÃ o file Excel."
    Exit Function

ErrorHandler:
    ListFilesFromSharePoint = "Lá»—i: " & Err.Description
End Function

Sub ListFilesRecursive(ByVal FolderObj As Object, ByRef ExcelWorksheet As Worksheet, ByRef RowIndex As Long)
    Dim FileObj As Object
    Dim SubFolderObj As Object

    ' Liá»‡t kÃª táº¥t cáº£ cÃ¡c tá»‡p trong thÆ° má»¥c hiá»‡n táº¡i
    For Each FileObj In FolderObj.Files
        ExcelWorksheet.Cells(RowIndex, 1).Value = FileObj.Name
        ExcelWorksheet.Cells(RowIndex, 2).Value = FileObj.Path
        RowIndex = RowIndex + 1
    Next FileObj

    ' Äá»‡ quy liá»‡t kÃª cÃ¡c tá»‡p trong cÃ¡c thÆ° má»¥c con
    For Each SubFolderObj In FolderObj.SubFolders
        Call ListFilesRecursive(SubFolderObj, ExcelWorksheet, RowIndex)
    Next SubFolderObj
End Sub
```

---

### **CÃ¡c bÆ°á»›c triá»ƒn khai**

#### **1. Táº¡o file .bas**
1. Má»Ÿ **VBA Editor** trong Excel (nháº¥n `Alt + F11`).
2. Táº¡o module má»›i (`Insert > Module`).
3. DÃ¡n Ä‘oáº¡n mÃ£ VBA vÃ o module má»›i.
4. Xuáº¥t file `.bas`:
   - Trong Project Explorer, chá»n module báº¡n vá»«a táº¡o.
   - Nháº¥p chuá»™t pháº£i vÃ  chá»n `Export File`.
   - LÆ°u file vá»›i Ä‘á»‹nh dáº¡ng `.bas`, vÃ­ dá»¥: `ListFiles.bas`.

---

#### **2. Cáº¥u hÃ¬nh trong UiPath**

1. **Chuáº©n bá»‹ cÃ¡c Ä‘Æ°á»ng dáº«n:**
   - `FolderPath`: ÄÆ°á»ng dáº«n Ä‘áº§y Ä‘á»§ Ä‘áº¿n thÆ° má»¥c SharePoint cá»§a báº¡n (thÆ° má»¥c nÃ y cáº§n Ä‘Æ°á»£c Ã¡nh xáº¡ nhÆ° má»™t á»• Ä‘Ä©a máº¡ng hoáº·c cÃ³ thá»ƒ truy cáº­p qua File Explorer).
   - `ExcelFilePath`: ÄÆ°á»ng dáº«n Ä‘áº¿n file Excel mÃ  báº¡n muá»‘n lÆ°u káº¿t quáº£ (vÃ­ dá»¥: `C:\Output.xlsx`).

2. **ThÃªm Invoke VBA trong UiPath:**
   - KÃ©o tháº£ hoáº¡t Ä‘á»™ng **Invoke VBA** vÃ o workflow.
   - Trong `Properties`, cáº¥u hÃ¬nh nhÆ° sau:
     - **VBAScriptFilePath**: ÄÆ°á»ng dáº«n Ä‘áº§y Ä‘á»§ tá»›i file `.bas` cá»§a báº¡n (vÃ­ dá»¥: `C:\Path\ListFiles.bas`).
     - **EntryMethodName**: TÃªn hÃ m cáº§n gá»i (trong trÆ°á»ng há»£p nÃ y lÃ  `ListFilesFromSharePoint`).
     - **EntryMethodParameters**: Truyá»n cÃ¡c tham sá»‘:
       - Tham sá»‘ 1: `FolderPath` (vÃ­ dá»¥: `"C:\SharePointFolder"`).
       - Tham sá»‘ 2: `ExcelFilePath` (vÃ­ dá»¥: `"C:\Output.xlsx"`).

---

#### **3. Cháº¡y vÃ  xÃ¡c minh**
- Cháº¡y workflow trong UiPath.
- Kiá»ƒm tra file Excel táº¡i `ExcelFilePath`. File Excel sáº½ chá»©a táº¥t cáº£ cÃ¡c tá»‡p trong cá»™t A (TÃªn Tá»‡p) vÃ  cá»™t B (ÄÆ°á»ng Dáº«n Tá»‡p).

---

### **LÆ°u Ã½**
1. **Truy cáº­p SharePoint**:
   - ThÆ° má»¥c SharePoint cáº§n Ä‘Æ°á»£c Ã¡nh xáº¡ nhÆ° má»™t á»• Ä‘Ä©a máº¡ng hoáº·c cÃ³ thá»ƒ duyá»‡t qua File Explorer. MÃ£ nÃ y sá»­ dá»¥ng `FileSystemObject`, vá»‘n chá»‰ hoáº¡t Ä‘á»™ng vá»›i thÆ° má»¥c cá»¥c bá»™ hoáº·c Ä‘Æ°á»£c Ã¡nh xáº¡.

2. **Xá»­ lÃ½ lá»—i**:
   - MÃ£ cÃ³ xá»­ lÃ½ lá»—i Ä‘á»ƒ cung cáº¥p thÃ´ng bÃ¡o trong trÆ°á»ng há»£p cÃ³ lá»—i.

HÃ£y thá»­ triá»ƒn khai vÃ  cho tÃ´i biáº¿t náº¿u báº¡n cáº§n há»— trá»£ thÃªm! ğŸ˜Š
