DÆ°á»›i Ä‘Ã¢y lÃ  Ä‘oáº¡n mÃ£ VBA Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ liá»‡t kÃª táº¥t cáº£ cÃ¡c tá»‡p trong má»™t thÆ° má»¥c SharePoint vÃ  cÃ¡c thÆ° má»¥c con. MÃ£ nÃ y sáº½ ghi tÃªn file vÃ o cá»™t **A** vÃ  Ä‘Æ°á»ng dáº«n file vÃ o cá»™t **B** cá»§a má»™t file Excel:

### Code VBA
```vba
Sub ListFilesInSharePoint()
    Dim ws As Worksheet
    Dim FolderPath As String
    Dim FilePath As String
    Dim RowIndex As Long

    ' Äáº·t tÃªn sheet
    Set ws = ThisWorkbook.Sheets(1)

    ' XÃ³a ná»™i dung cÅ© trong sheet
    ws.Cells.Clear

    ' Äáº·t tiÃªu Ä‘á» cá»™t
    ws.Cells(1, 1).Value = "File Name"
    ws.Cells(1, 2).Value = "File Path"

    ' ÄÆ°á»ng dáº«n SharePoint (cáº§n thay Ä‘á»•i Ä‘á»ƒ phÃ¹ há»£p vá»›i há»‡ thá»‘ng cá»§a báº¡n)
    FolderPath = "https://sharepoint.com/sites/YourSiteName/SharedDocuments/YourFolder"

    ' Gá»i hÃ m liá»‡t kÃª file
    RowIndex = 2
    Call GetFiles(FolderPath, ws, RowIndex)

    MsgBox "ÄÃ£ hoÃ n táº¥t viá»‡c liá»‡t kÃª cÃ¡c tá»‡p trong SharePoint!", vbInformation
End Sub

Sub GetFiles(ByVal FolderPath As String, ByRef ws As Worksheet, ByRef RowIndex As Long)
    Dim FileSystemObj As Object
    Dim FolderObj As Object
    Dim FileObj As Object
    Dim SubFolderObj As Object

    ' Táº¡o Ä‘á»‘i tÆ°á»£ng FileSystemObject
    Set FileSystemObj = CreateObject("Scripting.FileSystemObject")
    Set FolderObj = FileSystemObj.GetFolder(FolderPath)

    ' Duyá»‡t qua cÃ¡c file trong thÆ° má»¥c
    For Each FileObj In FolderObj.Files
        ws.Cells(RowIndex, 1).Value = FileObj.Name
        ws.Cells(RowIndex, 2).Value = FileObj.Path
        RowIndex = RowIndex + 1
    Next FileObj

    ' Duyá»‡t qua cÃ¡c thÆ° má»¥c con
    For Each SubFolderObj In FolderObj.SubFolders
        Call GetFiles(SubFolderObj.Path, ws, RowIndex)
    Next SubFolderObj
End Sub
```

---

### CÃ¡c lÆ°u Ã½:
1. **Cáº¥u hÃ¬nh Ä‘Æ°á»ng dáº«n SharePoint**:
   - Thay Ä‘á»•i giÃ¡ trá»‹ cá»§a biáº¿n `FolderPath` thÃ nh Ä‘Æ°á»ng dáº«n thÆ° má»¥c SharePoint cá»§a báº¡n (URL Ä‘áº¿n tÃ i liá»‡u báº¡n muá»‘n quÃ©t).

2. **Phá»¥ thuá»™c vÃ o FileSystemObject**:
   - MÃ£ nÃ y sá»­ dá»¥ng `Scripting.FileSystemObject`, vÃ¬ váº­y báº¡n cáº§n Ä‘áº£m báº£o thÆ° viá»‡n nÃ y Ä‘Ã£ Ä‘Æ°á»£c kÃ­ch hoáº¡t:
     - VÃ o `Tools > References` trong VBA Editor.
     - KÃ­ch hoáº¡t **Microsoft Scripting Runtime**.

3. **Quyá»n truy cáº­p SharePoint**:
   - Äáº£m báº£o báº¡n cÃ³ quyá»n truy cáº­p vÃ o thÆ° má»¥c SharePoint vÃ  thÆ° má»¥c con.

---

### HÆ°á»›ng dáº«n Step-by-Step:
1. **Thiáº¿t láº­p file Excel**:
   - Táº¡o má»™t file Excel má»›i vÃ  má»Ÿ VBA Editor báº±ng cÃ¡ch nháº¥n `Alt + F11`.
   - ChÃ¨n module má»›i (`Insert > Module`) vÃ  dÃ¡n Ä‘oáº¡n code vÃ o module.

2. **Cáº¥u hÃ¬nh Ä‘Æ°á»ng dáº«n SharePoint**:
   - Chá»‰nh sá»­a `FolderPath` Ä‘á»ƒ trá» Ä‘áº¿n thÆ° má»¥c gá»‘c trong SharePoint.

3. **KÃ­ch hoáº¡t thÆ° viá»‡n `Microsoft Scripting Runtime`**:
   - VÃ o `Tools > References` trong VBA Editor vÃ  chá»n `Microsoft Scripting Runtime`.

4. **Cháº¡y code**:
   - ÄÃ³ng VBA Editor vÃ  nháº¥n `Alt + F8`.
   - Chá»n macro `ListFilesInSharePoint` vÃ  nháº¥n **Run**.

5. **Kiá»ƒm tra káº¿t quáº£**:
   - Sau khi cháº¡y, file Excel sáº½ liá»‡t kÃª táº¥t cáº£ cÃ¡c tá»‡p trong cá»™t **A** (tÃªn tá»‡p) vÃ  cá»™t **B** (Ä‘Æ°á»ng dáº«n Ä‘áº§y Ä‘á»§).

Náº¿u báº¡n cáº§n thÃªm hÆ°á»›ng dáº«n hoáº·c tÃ¹y chá»‰nh, hÃ£y cho tÃ´i biáº¿t nhÃ©! ğŸ˜Š
