It seems like I canâ€™t do more advanced data analysis right now. Please try again later.

Tuy nhiÃªn, báº¡n váº«n cÃ³ thá»ƒ lÃ m theo hÆ°á»›ng dáº«n dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ tá»± táº¡o file `.bas` gá»™p cáº£ `JsonConverter` vÃ  Ä‘oáº¡n mÃ£ Ä‘á»‡ quy SharePoint:

---

## âœ… HÆ°á»›ng dáº«n thá»§ cÃ´ng táº¡o file `.bas` hoÃ n chá»‰nh

### ğŸ”¹ BÆ°á»›c 1: Táº£i `JsonConverter.bas` gá»‘c

- Truy cáº­p link chÃ­nh thá»©c cá»§a dá»± Ã¡n:
  [https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas](https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas)
- Nháº¥n vÃ o nÃºt **Raw** â†’ Ctrl + A â†’ Ctrl + C
- DÃ¡n toÃ n bá»™ vÃ o má»™t file má»›i.

---

### ğŸ”¹ BÆ°á»›c 2: ThÃªm Ä‘oáº¡n mÃ£ Ä‘á»‡ quy láº¥y file tá»« SharePoint

á» **cuá»‘i file JsonConverter.bas**, thÃªm Ä‘oáº¡n mÃ£ sau:

```vb
' ---------------------------------------------
' Recursive SharePoint Explorer
' ---------------------------------------------
Sub GetAllSharePointFiles()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(1)
    ws.Cells.ClearContents
    ws.Range("A1").Value = "åå‰" ' TÃªn
    ws.Range("B1").Value = "ãƒ‘ã‚¹" ' ÄÆ°á»ng dáº«n

    Dim ROOT_FOLDER As String
    ROOT_FOLDER = "Shared Documents" ' Thay báº±ng thÆ° má»¥c gá»‘c cá»§a báº¡n

    ProcessFolder "/" & ROOT_FOLDER, ws, 2
End Sub

Sub ProcessFolder(FolderPath As String, ws As Worksheet, ByRef nextRow As Long)
    Dim Http As Object
    Set Http = CreateObject("MSXML2.XMLHTTP")
    
    Dim SiteUrl As String
    SiteUrl = "https://contoso.sharepoint.com/sites/TestSite"

    Dim Endpoint As String
    Endpoint = SiteUrl & "/_api/web/GetFolderByServerRelativeUrl('" & FolderPath & "')?$expand=Folders,Files"

    Http.Open "GET", Endpoint, False
    Http.setRequestHeader "Accept", "application/json;odata=verbose"
    Http.Send

    If Http.Status = 200 Then
        Dim JSON As Object
        Set JSON = ParseJson(Http.responseText)
        
        Dim folder As Object
        Set folder = JSON("d")
        
        Dim fileItem As Variant
        For Each fileItem In folder("Files")("results")
            ws.Cells(nextRow, 1).Value = fileItem("Name")
            ws.Cells(nextRow, 2).Value = fileItem("ServerRelativeUrl")
            nextRow = nextRow + 1
        Next fileItem

        Dim subfolder As Variant
        For Each subfolder In folder("Folders")("results")
            If subfolder("Name") <> "Forms" Then
                ProcessFolder subfolder("ServerRelativeUrl"), ws, nextRow
            End If
        Next subfolder
    Else
        MsgBox "HTTP Error: " & Http.Status
    End If
End Sub
```

---

### ğŸ”¹ BÆ°á»›c 3: LÆ°u file

- Má»Ÿ Notepad hoáº·c VSCode
- DÃ¡n toÃ n bá»™ ná»™i dung (JsonConverter + Ä‘oáº¡n Ä‘á»‡ quy trÃªn)
- LÆ°u thÃ nh: `SharePoint_Full.bas`

---

### ğŸ”¹ BÆ°á»›c 4: Gá»i tá»« UiPath

- DÃ¹ng **Invoke VBA**
- Gáº¯n file `.bas` báº¡n vá»«a táº¡o
- Gá»i hÃ m `GetAllSharePointFiles` mÃ  khÃ´ng cáº§n chÃ¨n code vÃ o trong Excel

---

Náº¿u báº¡n muá»‘n mÃ¬nh táº¡o láº¡i file `.bas` Ä‘Ãºng chuáº©n cho báº¡n Ä‘á»ƒ táº£i vá», mÃ¬nh sáº½ há»— trá»£ khi cÃ´ng cá»¥ hoáº¡t Ä‘á»™ng láº¡i. Báº¡n chá»‰ cáº§n nÃ³i: **â€œTáº¡o láº¡i file .bas cho tÃ´i khi tool hoáº¡t Ä‘á»™ngâ€** nhÃ©!
