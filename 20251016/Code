Ráº¥t hay â€” váº¥n Ä‘á» nÃ y lÃ  do Windows SmartScreen / Zone Identifier (Alternate Data Stream - ADS) gáº¯n â€œdáº¥u an toÃ nâ€ cho file táº£i vá» tá»« Internet hoáº·c SharePoint.
=> Khi file cÃ³ Zone.Identifier thÃ¬ Windows buá»™c Excel hiá»ƒn thá»‹ cáº£nh bÃ¡o â€œEnable Editing / Unlockâ€.


---

ğŸ¯ Má»¥c tiÃªu cá»§a báº¡n:

Khi UiPath táº£i file Excel tá»« SharePoint vá» â†’ dÃ¹ng code (VBA hoáº·c VB.NET) Ä‘á»ƒ tá»± Ä‘á»™ng â€œUnlockâ€ file, khÃ´ng cáº§n click chuá»™t pháº£i â†’ Properties â†’ Unblock.


---

âœ… CÃ¡ch 1: DÃ¹ng VB.NET trong UiPath (KhuyÃªn dÃ¹ng)

Báº¡n cÃ³ thá»ƒ xoÃ¡ Alternate Data Stream Zone.Identifier cá»§a file báº±ng VB.NET activity trong UiPath:

ğŸ”¹ Code VB.NET:

Dim filePath As String = "C:\Users\Public\Downloads\Report.xlsm"

If IO.File.Exists(filePath & ":Zone.Identifier") Then
    IO.File.Delete(filePath & ":Zone.Identifier")
End If

ğŸ”¹ CÃ¡ch dÃ¹ng trong UiPath:

1. DÃ¹ng activity Assign Ä‘á»ƒ gÃ¡n biáº¿n filePath lÃ  Ä‘Æ°á»ng dáº«n file táº£i vá».


2. DÃ¹ng activity Invoke Code

NgÃ´n ngá»¯: VB.NET

Code: Ä‘oáº¡n trÃªn

Input argument: filePath



3. Sau khi cháº¡y â†’ file Ä‘Æ°á»£c â€œunblockâ€, Excel sáº½ khÃ´ng cÃ²n cáº£nh bÃ¡o Enable Editing / Security Warning.




---

âœ… CÃ¡ch 2: DÃ¹ng PowerShell trong UiPath (náº¿u muá»‘n ngáº¯n gá»n)

CÅ©ng cÃ³ thá»ƒ gá»i lá»‡nh PowerShell trá»±c tiáº¿p:

Unblock-File -Path "C:\Users\Public\Downloads\Report.xlsm"

Trong UiPath:

DÃ¹ng Invoke PowerShell activity

CommandText: Unblock-File -Path '" + filePath + "'

Äáº·t IsScript = True



---

âœ… CÃ¡ch 3: DÃ¹ng VBA (náº¿u báº¡n chá»‰ cÃ³ quyá»n trong Excel)

VBA khÃ´ng thá»ƒ trá»±c tiáº¿p xoÃ¡ stream ADS, nhÆ°ng cÃ³ thá»ƒ dÃ¹ng â€œShellâ€ Ä‘á»ƒ gá»i PowerShell tá»« trong Excel:

Sub UnblockThisFile()
    Dim f As String
    f = ThisWorkbook.FullName
    Shell "powershell -command ""Unblock-File -Path '" & f & "'""", vbHide
End Sub

ğŸ‘‰ Tuy nhiÃªn, cÃ¡ch nÃ y chá»‰ cháº¡y Ä‘Æ°á»£c sau khi file Ä‘Ã£ má»Ÿ vÃ  ngÆ°á»i dÃ¹ng Ä‘Ã£ báº¥m Enable Content Ã­t nháº¥t 1 láº§n, nÃªn khÃ´ng hiá»‡u quáº£ Ä‘á»ƒ â€œmá»Ÿ khÃ³a trÆ°á»›c khi má»Ÿ fileâ€.


---

âœ… CÃ¡ch kiá»ƒm tra file Ä‘Ã£ bá»‹ block hay chÆ°a:

Báº¡n cÃ³ thá»ƒ kiá»ƒm tra báº±ng code:

If IO.File.Exists(filePath & ":Zone.Identifier") Then
    Console.WriteLine("File is blocked.")
Else
    Console.WriteLine("File is unblocked.")
End If


---

âœ… TÃ³m táº¯t:

Má»¥c Ä‘Ã­ch	CÃ¡ch	Æ¯u Ä‘iá»ƒm

Unblock trÆ°á»›c khi má»Ÿ Excel	VB.NET trong UiPath (xoÃ¡ Zone.Identifier)	Hiá»‡u quáº£, gá»n
Unblock nhiá»u file 1 lÆ°á»£t	Duyá»‡t folder vÃ  xoÃ¡ stream	Dá»… batch
Trong Excel VBA	KhÃ´ng kháº£ thi 100%, chá»‰ gá»i PowerShell	Chá»‰ dÃ¹ng khi khÃ´ng cÃ³ UiPath



---

Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t giÃºp má»™t Ä‘oáº¡n code VB.NET hoÃ n chá»‰nh trong UiPath cÃ³ thá»ƒ unblock toÃ n bá»™ file trong 1 folder SharePoint download (vd: C:\Temp\Download) luÃ´n khÃ´ng?
â†’ Khi Ä‘Ã³ UiPath cÃ³ thá»ƒ cháº¡y batch tá»± Ä‘á»™ng sau khi táº£i vá».

