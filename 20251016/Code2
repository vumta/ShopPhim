Tá»‘t láº¯m ğŸ‘ Váº­y mÃ¬nh sáº½ viáº¿t cho báº¡n phiÃªn báº£n hoÃ n chá»‰nh cháº¡y trong UiPath, cÃ³ thá»ƒ unblock toÃ n bá»™ file trong 1 folder (ká»ƒ cáº£ tÃªn file cÃ³ khoáº£ng tráº¯ng hoáº·c kÃ½ tá»± Ä‘áº·c biá»‡t).
ToÃ n bá»™ script nÃ y báº¡n chá»‰ cáº§n copy-dÃ¡n vÃ o Invoke PowerShell lÃ  cháº¡y Ä‘Æ°á»£c ngay.


---

âœ… Má»¥c tiÃªu

Duyá»‡t qua toÃ n bá»™ file trong 1 folder (vd. C:\Temp\Download)

Kiá»ƒm tra tá»«ng file cÃ³ bá»‹ block (Zone.Identifier) hay khÃ´ng

Náº¿u bá»‹ block â†’ tá»± Ä‘á»™ng â€œUnblockâ€

Ghi log tráº¡ng thÃ¡i tá»«ng file



---

ğŸ§  PowerShell Script hoÃ n chá»‰nh

CommandText (toÃ n bá»™ dÃ¡n vÃ o UiPath Invoke PowerShell):

param([string]$folderPath)

if (-not (Test-Path $folderPath)) {
    Write-Host "âŒ Folder not found: $folderPath"
    exit
}

Write-Host "ğŸ” Scanning folder: $folderPath"
$files = Get-ChildItem -Path $folderPath -File -Recurse

if ($files.Count -eq 0) {
    Write-Host "âš ï¸ No files found in folder."
    exit
}

foreach ($file in $files) {
    $zonePath = "$($file.FullName):Zone.Identifier"

    if (Test-Path $zonePath) {
        Write-Host "ğŸš« Blocked â†’ $($file.Name)"
        try {
            Unblock-File -LiteralPath $file.FullName
            if (-not (Test-Path $zonePath)) {
                Write-Host "âœ… Unblocked â†’ $($file.Name)"
            } else {
                Write-Host "âš ï¸ Still blocked â†’ $($file.Name)"
            }
        } catch {
            Write-Host "âŒ Error unblocking file: $($file.Name) | $_"
        }
    } else {
        Write-Host "âœ… Already unblocked â†’ $($file.Name)"
    }
}

Write-Host "ğŸ¯ Done scanning folder."


---

âš™ï¸ Cáº¥u hÃ¬nh trong UiPath

1. DÃ¹ng activity Assign

folderPath = "C:\Temp\Download"

(hoáº·c thÆ° má»¥c SharePoint báº¡n táº£i file vá»)


2. DÃ¹ng activity Invoke PowerShell

IsScript = True

CommandText = (toÃ n bá»™ script á»Ÿ trÃªn)

Parameters = { folderPath }

WriteOutputToLog = True

(TÃ¹y chá»n) Output = result (String) â†’ Ä‘á»ƒ Ä‘á»c ná»™i dung log náº¿u cáº§n





---

ğŸ§¾ Káº¿t quáº£ Log vÃ­ dá»¥

Khi cháº¡y, log cá»§a UiPath sáº½ hiá»ƒn thá»‹ nhÆ°:

ğŸ” Scanning folder: C:\Temp\Download
ğŸš« Blocked â†’ Report Q1.xlsm
âœ… Unblocked â†’ Report Q1.xlsm
âœ… Already unblocked â†’ Template.xlsx
ğŸš« Blocked â†’ Monthly Report.xlsm
âœ… Unblocked â†’ Monthly Report.xlsm
ğŸ¯ Done scanning folder.


---

ğŸ§° TÃ¹y chá»n thÃªm (náº¿u báº¡n muá»‘n)

Náº¿u báº¡n chá»‰ muá»‘n â€œunblock file Excelâ€ (bá» qua file .txt, .zip, .pdf, â€¦), thÃªm dÃ²ng lá»c:

$files = Get-ChildItem -Path $folderPath -File -Recurse | Where-Object { $_.Extension -match "xlsm|xlsx|xls" }


---

Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t luÃ´n phiÃªn báº£n workflow .xaml máº«u (cháº¡y trá»±c tiáº¿p trong UiPath) Ä‘á»ƒ báº¡n import vÃ o project khÃ´ng?
â†’ MÃ¬nh cÃ³ thá»ƒ xuáº¥t Ä‘oáº¡n Ä‘Ã³ ra file .xaml gá»“m Assign + Invoke PowerShell sáºµn.

