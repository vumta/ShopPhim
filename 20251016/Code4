Chuáº©n rá»“i ğŸ‘ â€” Ä‘Ãºng lÃ  trong UiPath, activity Invoke PowerShell khÃ´ng cÃ³ thuá»™c tÃ­nh â€œWriteOutputToLogâ€ (thuá»™c tÃ­nh Ä‘Ã³ chá»‰ cÃ³ trong phiÃªn báº£n cÅ© hoáº·c custom activity).
MÃ¬nh sáº½ hÆ°á»›ng dáº«n báº¡n chuáº©n cÃ¡ch má»›i nháº¥t (UiPath hiá»‡n táº¡i) Ä‘á»ƒ:

Gá»i PowerShell script

Nháº­n káº¿t quáº£ log / thÃ´ng bÃ¡o vá» UiPath

KhÃ´ng bá»‹ lá»—i cÃº phÃ¡p

Dá»… dÃ¹ng cho nhiá»u file trong 1 folder



---

ğŸ§© CÃ¡ch lÃ m chuáº©n nháº¥t (UiPath hiá»‡n táº¡i)

1ï¸âƒ£ Táº¡o PowerShell Script file

Táº¡o 1 file:
ğŸ“„ C:\Scripts\UnblockFolder.ps1

Ná»™i dung:

param([string]$folderPath)

if (-not (Test-Path $folderPath)) {
    Write-Output "âŒ Folder not found: $folderPath"
    exit
}

Write-Output "ğŸ” Scanning folder: $folderPath"
$files = Get-ChildItem -Path $folderPath -File -Recurse

if ($files.Count -eq 0) {
    Write-Output "âš ï¸ No files found in folder."
    exit
}

foreach ($file in $files) {
    $zonePath = "$($file.FullName):Zone.Identifier"

    if (Test-Path $zonePath) {
        Write-Output "ğŸš« Blocked â†’ $($file.Name)"
        try {
            Unblock-File -LiteralPath $file.FullName
            if (-not (Test-Path $zonePath)) {
                Write-Output "âœ… Unblocked â†’ $($file.Name)"
            } else {
                Write-Output "âš ï¸ Still blocked â†’ $($file.Name)"
            }
        } catch {
            Write-Output "âŒ Error unblocking file: $($file.Name) | $_"
        }
    } else {
        Write-Output "âœ… Already unblocked â†’ $($file.Name)"
    }
}

Write-Output "ğŸ¯ Done scanning folder."

> âš™ï¸ LÆ°u Ã½: dÃ¹ng Write-Output thay vÃ¬ Write-Host Ä‘á»ƒ UiPath nháº­n Ä‘Æ°á»£c output trong biáº¿n.




---

2ï¸âƒ£ Trong UiPath â€“ DÃ¹ng Invoke PowerShell activity

Cáº¥u hÃ¬nh:

Thuá»™c tÃ­nh	GiÃ¡ trá»‹

IsScript	False
CommandText	"C:\Scripts\UnblockFolder.ps1"
Parameters	{ folderPath }
Output	psOutput (kiá»ƒu System.Collections.Generic.IEnumerable<Object>)
ContinueOnError	False



---

3ï¸âƒ£ ThÃªm Assign Ä‘á»ƒ ná»‘i káº¿t quáº£ láº¡i

Sau khi cháº¡y xong, káº¿t quáº£ script (log) náº±m trong psOutput.

ThÃªm activity:

logText = String.Join(Environment.NewLine, psOutput)

Rá»“i dÃ¹ng Write Line hoáº·c Log Message:

logText


---

4ï¸âƒ£ VÃ­ dá»¥ Ä‘áº§y Ä‘á»§

Assign:
folderPath = "C:\Temp\Download"

Invoke PowerShell:

IsScript = False

CommandText = "C:\Scripts\UnblockFolder.ps1"

Parameters = { folderPath }

Output = psOutput


Assign:
logText = String.Join(Environment.NewLine, psOutput)

Write Line:
logText



---

5ï¸âƒ£ Káº¿t quáº£ log vÃ­ dá»¥

ğŸ” Scanning folder: C:\Temp\Download
ğŸš« Blocked â†’ Report Q1.xlsm
âœ… Unblocked â†’ Report Q1.xlsm
âœ… Already unblocked â†’ Template.xlsx
ğŸ¯ Done scanning folder.


---

Báº¡n muá»‘n mÃ¬nh gá»­i sáºµn file UnblockFolder.ps1 (Ä‘á»‹nh dáº¡ng chuáº©n UTF-8, chá»‰ cáº§n copy vÃ o C:\Scripts) khÃ´ng?
â†’ MÃ¬nh cÃ³ thá»ƒ táº¡o file vÃ  cho báº¡n link táº£i ngay, trÃ¡nh lá»—i mÃ£ hÃ³a khi copy tá»« chat.

