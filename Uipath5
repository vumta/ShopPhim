Cáº£m Æ¡n báº¡n chia sáº» chi tiáº¿t! Vá»›i **dá»¯ liá»‡u lá»›n (90.000 dÃ²ng)** vÃ  viá»‡c chá»‰ **láº¥y má»™t vÃ i cá»™t theo Ä‘Ãºng thá»© tá»± file Ä‘Ã­ch**, chÃºng ta cáº§n tá»‘i Æ°u `Invoke Code` Ä‘á»ƒ:

1. TrÃ¡nh dÃ¹ng `DataRow.ImportRow` (ráº¥t cháº­m cho data lá»›n)  
2. TrÃ¡nh `.Contains()` trong má»—i vÃ²ng láº·p â†’ nÃªn dÃ¹ng **dictionary** Ä‘á»ƒ mapping nhanh  
3. Chá»‰ copy Ä‘Ãºng cá»™t cáº§n thiáº¿t, Ä‘Ãºng thá»© tá»± file Ä‘Ã­ch

---

### âœ… **Code VB.NET Ä‘Ã£ Ä‘Æ°á»£c tá»‘i Æ°u hÃ³a â€“ ráº¥t nhanh vá»›i data lá»›n**
```vbnet
' Táº¡o tá»« Ä‘iá»ƒn map tÃªn cá»™t nguá»“n vÃ  index tÆ°Æ¡ng á»©ng
Dim columnIndexMap As New Dictionary(Of String, Integer)
For i As Integer = 0 To dtSource.Columns.Count - 1
    Dim colName As String = dtSource.Rows(0)(i).ToString().Trim()
    If Not columnIndexMap.ContainsKey(colName) Then
        columnIndexMap(colName) = i
    End If
Next

' Táº¡o báº£ng káº¿t quáº£ vá»›i Ä‘Ãºng cá»™t theo file Ä‘Ã­ch
dtFinal = New DataTable()
Dim destColumnIndexes As New List(Of Integer)

For Each destCol As DataColumn In dtDestHeader.Columns
    Dim colName As String = destCol.ColumnName.Trim()
    dtFinal.Columns.Add(colName)

    If columnIndexMap.ContainsKey(colName) Then
        destColumnIndexes.Add(columnIndexMap(colName))
    Else
        destColumnIndexes.Add(-1) ' Äá»ƒ trá»‘ng náº¿u khÃ´ng tá»“n táº¡i
    End If
Next

' Láº·p tá»« dÃ²ng thá»© 2 trá»Ÿ Ä‘i trong dtSource (bá» dÃ²ng tiÃªu Ä‘á»)
For i As Integer = 1 To dtSource.Rows.Count - 1
    Dim srcRow = dtSource.Rows(i)
    Dim newRow = dtFinal.NewRow()

    For j As Integer = 0 To destColumnIndexes.Count - 1
        Dim srcIndex = destColumnIndexes(j)
        If srcIndex >= 0 Then
            newRow(j) = srcRow(srcIndex)
        End If
    Next

    dtFinal.Rows.Add(newRow)
Next
```

---

### ğŸ“ Giáº£i thÃ­ch Æ°u Ä‘iá»ƒm:
| Tá»‘i Æ°u gÃ¬ | TÃ¡c dá»¥ng |
|----------|----------|
| âœ… DÃ¹ng Dictionary | Truy cáº­p index cá»™t theo tÃªn nhanh gáº¥p nhiá»u láº§n `.Contains()` |
| âœ… TrÃ¡nh `.Clone()` vÃ  `ImportRow` | Giáº£m overhead, tÄƒng tá»‘c Ä‘á»™ |
| âœ… Chá»‰ láº·p 2 vÃ²ng cá»‘ Ä‘á»‹nh | KhÃ´ng bá»‹ chá»“ng chÃ©o loop theo cá»™t |
| âœ… Há»£p lÃ½ hÃ³a cáº¥u trÃºc bá»™ nhá»› | Giáº£m rÃ¡c sinh ra trong Runtime |

---

### ğŸ’¡ CÃ¡ch sá»­ dá»¥ng:
- DÃ¡n vÃ o trong `Invoke Code` activity
- Input:
  - `dtSource` (Ä‘Ã£ Ä‘á»c file nguá»“n, khÃ´ng cÃ³ header)
  - `dtDestHeader` (Ä‘á»c dÃ²ng 2 file Ä‘Ã­ch, dÃ¹ng AddHeaders=True)
- Output:
  - `dtFinal`

---

Náº¿u báº¡n cáº§n mÃ¬nh:
- Xuáº¥t láº¡i toÃ n bá»™ project `.zip` vá»›i code má»›i
- Tá»± Ä‘á»™ng detect encoding
- Log tiáº¿n Ä‘á»™ xá»­ lÃ½ batch 10k rows

â†’ MÃ¬nh cÃ³ thá»ƒ há»— trá»£ ngay nhÃ©!
