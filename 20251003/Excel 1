Rá»“i ğŸ‘ mÃ¬nh sáº½ viáº¿t cho báº¡n Ä‘oáº¡n code UiPath (VB.NET trong Assign/Invoke Code) Ä‘á»ƒ xá»­ lÃ½ háº¿t cÃ¡c trÆ°á»ng há»£p khi sá»‘ thá»© tá»± tuáº§n cá»§a thÃ¡ng nÄƒm hiá»‡n táº¡i khÃ´ng map Ä‘Æ°á»£c vá»›i nÄƒm trÆ°á»›c.


---

ğŸŸ¦ Ã tÆ°á»Ÿng xá»­ lÃ½

1. TÃ­nh dateWeekend (CN tuáº§n Ä‘ang xÃ©t).


2. TÃ­nh thá»© tá»± tuáº§n trong thÃ¡ng hiá»‡n táº¡i â†’ weekOrderCurrent.


3. Láº¥y CN tuáº§n tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c theo cÃ¹ng weekOrderCurrent.


4. Kiá»ƒm tra náº¿u CN Ä‘Ã³ váº«n cÃ²n trong cÃ¹ng thÃ¡ng nÄƒm trÆ°á»›c:

Náº¿u cÃ³ â†’ giá»¯ nguyÃªn.

Náº¿u khÃ´ng (vÃ­ dá»¥ nÄƒm nay cÃ³ tuáº§n 5 nhÆ°ng nÄƒm trÆ°á»›c khÃ´ng cÃ³ tuáº§n 5) â†’ giáº£m vá» tuáº§n cuá»‘i cÃ¹ng cÃ³ tháº­t cá»§a thÃ¡ng nÄƒm trÆ°á»›c (thÆ°á»ng lÃ  tuáº§n 4).





---

ğŸŸ¦ Code máº«u trong UiPath (VB.NET)

Báº¡n cÃ³ thá»ƒ Ä‘áº·t Ä‘oáº¡n nÃ y trong Assign (nhiá»u dÃ²ng) hoáº·c trong Invoke Code:

' today lÃ  biáº¿n DateTime, vÃ­ dá»¥: DateTime.Now
Dim today As DateTime = DateTime.Now

' 1. XÃ¡c Ä‘á»‹nh dateWeekend
Dim dateWeekend As DateTime
If today.DayOfWeek = DayOfWeek.Monday Then
    dateWeekend = today.AddDays(-1) ' CN tuáº§n trÆ°á»›c
Else
    dateWeekend = today.AddDays(7 - CInt(today.DayOfWeek)) ' CN tuáº§n hiá»‡n táº¡i
End If

' 2. TÃ­nh thá»© tá»± tuáº§n trong thÃ¡ng nÄƒm hiá»‡n táº¡i
Dim weekOrderCurrent As Integer = CInt(Math.Floor((dateWeekend.Day - 1) / 7)) + 1

' 3. Láº¥y CN cá»§a tuáº§n tÆ°Æ¡ng á»©ng trong nÄƒm trÆ°á»›c
Dim firstDayPrevYearMonth As DateTime = New DateTime(dateWeekend.Year - 1, dateWeekend.Month, 1)
Dim offset As Integer = (7 - CInt(firstDayPrevYearMonth.DayOfWeek) + 1)
If offset = 7 Then offset = 0

Dim dateWeekendPrevYear As DateTime = firstDayPrevYearMonth.AddDays((weekOrderCurrent - 1) * 7 + offset)

' 4. Náº¿u CN nÃ y khÃ´ng cÃ¹ng thÃ¡ng (bá»‹ nháº£y sang thÃ¡ng sau) thÃ¬ lÃ¹i vá» tuáº§n cuá»‘i cÃ¹ng cá»§a thÃ¡ng
If dateWeekendPrevYear.Month <> firstDayPrevYearMonth.Month Then
    ' Láº¥y CN cuá»‘i cÃ¹ng cá»§a thÃ¡ng Ä‘Ã³
    Dim lastDayOfPrevYearMonth As DateTime = firstDayPrevYearMonth.AddMonths(1).AddDays(-1)
    Dim dayDiff As Integer = CInt(DayOfWeek.Sunday) - CInt(lastDayOfPrevYearMonth.DayOfWeek)
    If dayDiff < 0 Then dayDiff += 7
    dateWeekendPrevYear = lastDayOfPrevYearMonth.AddDays(dayDiff)
End If

' 5. Láº¥y full tuáº§n cá»§a nÄƒm trÆ°á»›c (T2 -> CN)
Dim startOfPrevWeek As DateTime = dateWeekendPrevYear.AddDays(-6)
Dim weekDatesPrevYear As New List(Of DateTime)
For i As Integer = 0 To 6
    weekDatesPrevYear.Add(startOfPrevWeek.AddDays(i))
Next


---

ğŸŸ¦ Káº¿t quáº£

dateWeekend â†’ CN tuáº§n xÃ©t nÄƒm nay.

weekOrderCurrent â†’ sá»‘ thá»© tá»± tuáº§n trong thÃ¡ng (nÄƒm nay).

dateWeekendPrevYear â†’ CN tuáº§n map Ä‘Æ°á»£c nÄƒm trÆ°á»›c (Ä‘Ã£ xá»­ lÃ½ trÆ°á»ng há»£p lá»‡ch tuáº§n).

weekDatesPrevYear â†’ danh sÃ¡ch ngÃ y (T2 â†’ CN) cá»§a tuáº§n nÄƒm trÆ°á»›c.



---

ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t thÃªm Ä‘oáº¡n xuáº¥t ra danh sÃ¡ch ngÃ y weekDatesPrevYear dáº¡ng chuá»—i (yyyy-MM-dd) Ä‘á»ƒ dá»… log/ghi file trong UiPath khÃ´ng?

