Ok, mÃ¬nh phÃ¢n tÃ­ch vÃ  viáº¿t láº¡i logic cá»§a báº¡n cho rÃµ rÃ ng, sau Ä‘Ã³ sáº½ Ä‘á» xuáº¥t cÃ´ng thá»©c/tá»«ng bÆ°á»›c xá»­ lÃ½ trong Excel hoáº·c Power Automate:


---

Logic chi tiáº¿t

1. XÃ¡c Ä‘á»‹nh dateWeekend:

Náº¿u Today = Thá»© 2 â†’ dateWeekend = Chá»§ nháº­t tuáº§n trÆ°á»›c.

Náº¿u Today = Thá»© 3 â†’ CN â†’ dateWeekend = Chá»§ nháº­t tuáº§n hiá»‡n táº¡i.



2. XÃ¡c Ä‘á»‹nh dÃ£y ngÃ y (WeekDates):

Náº¿u dateWeekend = CN tuáº§n trÆ°á»›c â†’ láº¥y nguyÃªn tuáº§n trÆ°á»›c (Thá»© 2 â†’ CN).

Náº¿u dateWeekend = CN tuáº§n hiá»‡n táº¡i â†’ láº¥y nguyÃªn tuáº§n hiá»‡n táº¡i tá»« Thá»© 2 â†’ (Today - 1).



3. TÃ­nh sá»‘ thá»© tá»± tuáº§n trong thÃ¡ng cá»§a dateWeekend:

Dá»±a vÃ o ngÃ y dateWeekend, tÃ­nh xem nÃ³ náº±m tuáº§n thá»© máº¥y trong thÃ¡ng.
(VÃ­ dá»¥: Chá»§ nháº­t 29/9/2024 lÃ  tuáº§n thá»© 5 cá»§a thÃ¡ng 9).



4. TÃ¬m tuáº§n tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c:

DÃ¹ng thÃ¡ng hiá»‡n táº¡i - 1 nÄƒm, vÃ  cÃ¹ng sá»‘ thá»© tá»± tuáº§n trong thÃ¡ng.

Láº¥y ra tuáº§n nÃ y á»Ÿ nÄƒm trÆ°á»›c.



5. Láº¥y dÃ£y ngÃ y nÄƒm trÆ°á»›c:

Khi xÃ¡c Ä‘á»‹nh Ä‘Ãºng tuáº§n cá»§a nÄƒm trÆ°á»›c â†’ xuáº¥t ra toÃ n bá»™ ngÃ y trong tuáº§n Ä‘Ã³ (T2 â†’ CN).





---

Excel cÃ´ng thá»©c kháº£ thi

Giáº£ sá»­ Today náº±m á»Ÿ Ã´ A1:

1. TÃ­nh dateWeekend:

=IF(WEEKDAY(A1,2)=1, A1-1, A1+(7-WEEKDAY(A1,2)))

WEEKDAY(A1,2) â†’ Thá»© 2 = 1, â€¦ CN = 7.

Náº¿u A1 lÃ  Thá»© 2 â†’ láº¥y CN tuáº§n trÆ°á»›c.

Náº¿u A1 lÃ  Thá»© 3 trá»Ÿ Ä‘i â†’ CN tuáº§n hiá»‡n táº¡i.


2. TÃ­nh ngÃ y Ä‘áº§u tuáº§n (Thá»© 2):

=DateWeekend-6

â†’ Ä‘Ã¢y lÃ  Thá»© 2 cá»§a tuáº§n cáº§n xÃ©t.

3. Sinh ra nguyÃªn tuáº§n:

Thá»© 2: =DateWeekend-6

Thá»© 3: =DateWeekend-5

â€¦

Chá»§ nháº­t: =DateWeekend


4. XÃ¡c Ä‘á»‹nh tuáº§n thá»© máº¥y trong thÃ¡ng:

=INT((DAY(DateWeekend)-1)/7)+1

5. Láº¥y ngÃ y tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c:

VÃ­ dá»¥ muá»‘n láº¥y CN nÄƒm trÆ°á»›c:

=DATE(YEAR(DateWeekend)-1, MONTH(DateWeekend),1) 
   + (Tuáº§nThá»©-1)*7 
   + (7-WEEKDAY(DATE(YEAR(DateWeekend)-1, MONTH(DateWeekend),1),2))

â†’ Sau Ä‘Ã³ cá»™ng 0 â†’ 6 Ä‘á»ƒ ra Ä‘á»§ cÃ¡c ngÃ y trong tuáº§n Ä‘Ã³.


---

ğŸ‘‰ CÃ¡ch nÃ y cÃ³ thá»ƒ triá»ƒn khai báº±ng Excel, hoáº·c náº¿u báº¡n muá»‘n mÃ¬nh viáº¿t luÃ´n phiÃªn báº£n Power Automate expression thÃ¬ mÃ¬nh sáº½ quy Ä‘á»•i ra hÃ m addDays(), dayOfWeek(), addMonths() â€¦ cho báº¡n.

Báº¡n muá»‘n mÃ¬nh viáº¿t thÃ nh Excel cÃ´ng thá»©c hoÃ n chá»‰nh (copy-paste cháº¡y Ä‘Æ°á»£c), hay thÃ nh Power Automate expression Ä‘á»ƒ dÃ¹ng luÃ´n trong Flow?

