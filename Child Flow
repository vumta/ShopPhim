DÆ°á»›i Ä‘Ã¢y lÃ  **hÆ°á»›ng dáº«n step-by-step sá»­ dá»¥ng Child Flow** trong Power Automate Ä‘á»ƒ **láº¥y toÃ n bá»™ file trong SharePoint bao gá»“m cáº£ subfolder**, báº±ng cÃ¡ch Ä‘á»‡ quy chÃ­nh Flow con gá»i láº¡i chÃ­nh nÃ³.

---

## âœ… Tá»•ng quan giáº£i phÃ¡p dÃ¹ng **Child Flow (Recursive)**

1. Táº¡o **1 Child Flow** (Flow con), nháº­n `FolderPath` lÃ m input.
2. Flow con:
   - Gá»i `List folder` Ä‘á»ƒ láº¥y file vÃ  folder con.
   - Náº¿u gáº·p **file** â†’ lÆ°u vÃ o máº£ng káº¿t quáº£.
   - Náº¿u gáº·p **folder** â†’ gá»i láº¡i chÃ­nh **Child Flow**, truyá»n vÃ o path folder con.
   - Gá»™p káº¿t quáº£ file cá»§a mÃ¬nh + tá»« cÃ¡c flow con tráº£ vá».
3. Táº¡o **Parent Flow** (Flow chÃ­nh) â†’ chá»‰ viá»‡c gá»i Child Flow 1 láº§n vá»›i Folder gá»‘c.

---

## ğŸ§± Äiá»u kiá»‡n báº¯t buá»™c:
- Flow pháº£i náº±m trong **Solution**
- Báº­t **Child Flows support**
- Cáº§n sá»­ dá»¥ng action **"Run a Child Flow"**

---

## ğŸŸ¨ BÆ°á»›c 1: Táº¡o Solution vÃ  Flow

1. VÃ o Power Automate > Chá»n **Solutions** > New Solution (náº¿u chÆ°a cÃ³)
2. Má»Ÿ Solution â†’ chá»n **+ New > Cloud flow > Instant cloud flow**
3. Táº¡o Flow con: Ä‘áº·t tÃªn vÃ­ dá»¥ `GetFilesRecursively`
   - Trigger: **Manually trigger a flow**
   - Add input: `FolderPath` (kiá»ƒu Text)

---

## ğŸŸ© BÆ°á»›c 2: Trong Flow con â€“ xá»­ lÃ½ Ä‘á»‡ quy

### ğŸŸ¦ Biáº¿n khá»Ÿi táº¡o:

- **Initialize Variable**: `AllFiles`  
  - Type: Array  
  - Value: `[]`

---

### ğŸŸ¦ List folder content:

- Action: `List folder`
  - Site: chá»n Site SharePoint
  - Folder path: `FolderPath` (láº¥y tá»« trigger input)

---

### ğŸŸ¦ Loop qua tá»«ng item (file/folder)

- **Apply to each**: `value` cá»§a `List folder`

BÃªn trong:

#### â¤ Náº¿u lÃ  **file**:
- Äiá»u kiá»‡n:
  ```plaintext
  empty(items('Apply_to_each')?['Folder'])
  ```
- Náº¿u Ä‘Ãºng â†’ `Append to array variable` â†’ `AllFiles`
  - Value:
    ```json
    {
      "Name": "@items('Apply_to_each')?['Name']",
      "Path": "@items('Apply_to_each')?['Path']"
    }
    ```

#### â¤ Náº¿u lÃ  **folder**:
- Gá»i láº¡i chÃ­nh Flow con (Ä‘á»‡ quy):

- **Run a Child Flow**:
  - Flow: chá»n chÃ­nh `GetFilesRecursively`
  - Input:  
    `FolderPath`: `items('Apply_to_each')?['Path']`

- Sau Ä‘Ã³, **Append káº¿t quáº£** vÃ o `AllFiles`

  - DÃ¹ng action: `Append to array variable`
  - Value: `outputs('Run_a_Child_Flow')?['body']`

---

### ğŸŸ¦ Sau vÃ²ng láº·p: Tráº£ káº¿t quáº£ ra

- **Response**: Tráº£ láº¡i `AllFiles`  
  - Body: `AllFiles`

---

## ğŸŸ¨ BÆ°á»›c 3: Táº¡o Flow chÃ­nh gá»i Child Flow

1. Trong cÃ¹ng Solution â†’ táº¡o 1 Cloud Flow má»›i (Instant hoáº·c Scheduled)
2. Add action: **Run a Child Flow**
   - Chá»n flow: `GetFilesRecursively`
   - Input: `FolderPath`: vÃ­ dá»¥ `"Shared Documents/Reports"`

3. Sau Ä‘Ã³ cÃ³ thá»ƒ:
   - Log ra káº¿t quáº£
   - Xuáº¥t ra Excel
   - DÃ¹ng káº¿t quáº£ tiáº¿p tá»¥c xá»­ lÃ½

---

## âœ… Káº¿t quáº£
- `AllFiles` lÃ  máº£ng chá»©a **toÃ n bá»™ file trong thÆ° má»¥c gá»‘c vÃ  má»i subfolder**, khÃ´ng giá»›i háº¡n cáº¥p Ä‘á»™ lá»“ng.

---

## ğŸ” Æ¯u Ä‘iá»ƒm cá»§a dÃ¹ng Child Flow:

- Cá»±c ká»³ dá»… hiá»ƒu & gá»n.
- KhÃ´ng cáº§n xá»­ lÃ½ queue hay vÃ²ng láº·p thá»§ cÃ´ng.
- Má»—i folder xá»­ lÃ½ riÃªng â†’ dá»… debug vÃ  chia nhá» thá»i gian cháº¡y.

---

## ğŸš€ Náº¿u báº¡n muá»‘n:
MÃ¬nh cÃ³ thá»ƒ cung cáº¥p **Flow máº«u JSON** cho cáº£ Parent vÃ  Child Flow Ä‘á»ƒ báº¡n import trá»±c tiáº¿p â€“ chá»‰ cáº§n báº¡n cho mÃ¬nh:

- **Site SharePoint**
- **ThÆ° má»¥c gá»‘c cáº§n duyá»‡t**

Báº¡n muá»‘n mÃ¬nh xuáº¥t JSON máº«u khÃ´ng?
