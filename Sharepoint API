D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt theo t·ª´ng b∆∞·ªõc ƒë·ªÉ s·ª≠ d·ª•ng SharePoint Request API trong UiPath:

---

### **B∆∞·ªõc 1: C√†i ƒë·∫∑t c√°c g√≥i c·∫ßn thi·∫øt**
1. M·ªü **UiPath Studio**.
2. Ch·ªçn **Manage Packages** t·ª´ menu.
3. T√¨m ki·∫øm v√† c√†i ƒë·∫∑t g√≥i **UiPath.WebAPI.Activities** ƒë·ªÉ s·ª≠ d·ª•ng ho·∫°t ƒë·ªông HTTP Request.

---

### **B∆∞·ªõc 2: L·∫•y th√¥ng tin SharePoint API**
1. X√°c ƒë·ªãnh API endpoint t·ª´ SharePoint (v√≠ d·ª•: URL th∆∞ m·ª•c, danh s√°ch c·∫ßn truy c·∫≠p).
2. ƒêƒÉng nh·∫≠p v√†o SharePoint ƒë·ªÉ l·∫•y Access Token ho·∫∑c th√¥ng tin x√°c th·ª±c. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng Microsoft Graph API n·∫øu c·∫ßn Access Token.

---

### **B∆∞·ªõc 3: Th√™m ho·∫°t ƒë·ªông HTTP Request**
1. Trong UiPath Studio, k√©o ho·∫°t ƒë·ªông **HTTP Request** t·ª´ **Activities Panel** v√†o workflow.
2. ƒêi·ªÅn th√¥ng tin:
   - **Method**: Ch·ªçn GET/POST/PUT/DELETE t√πy y√™u c·∫ßu API.
   - **Endpoint**: D√°n URL API SharePoint.

---

### **B∆∞·ªõc 4: C·∫•u h√¨nh Headers**
1. Trong thu·ªôc t√≠nh **Headers**, th√™m:
   - `Authorization`: `Bearer [Access Token]` (trong ƒë√≥ [Access Token] l√† token b·∫°n v·ª´a l·∫•y ƒë∆∞·ª£c).
   - `Content-Type`: `application/json`.

---

### **B∆∞·ªõc 5: T·∫°o Body (n·∫øu c·∫ßn)**
1. N·∫øu b·∫°n th·ª±c hi·ªán y√™u c·∫ßu POST ho·∫∑c PUT, t·∫°o d·ªØ li·ªáu d·∫°ng JSON cho thu·ªôc t√≠nh **Body**:
   ```json
   {
       "Title": "New Item",
       "Description": "This is a test description."
   }
   ```
2. S·ª≠ d·ª•ng ho·∫°t ƒë·ªông **Assign** ƒë·ªÉ t·∫°o Body ho·∫∑c nh·∫≠p tr·ª±c ti·∫øp v√†o thu·ªôc t√≠nh.

---

### **B∆∞·ªõc 6: X·ª≠ l√Ω Response**
1. Khi y√™u c·∫ßu ho√†n t·∫•t, d·ªØ li·ªáu tr·∫£ v·ªÅ s·∫Ω ƒë∆∞·ª£c l∆∞u trong Output Variable c·ªßa ho·∫°t ƒë·ªông HTTP Request.
2. S·ª≠ d·ª•ng ho·∫°t ƒë·ªông **Deserialize JSON** ƒë·ªÉ ph√¢n t√≠ch c√∫ ph√°p d·ªØ li·ªáu nh·∫≠n ƒë∆∞·ª£c v√† s·ª≠ d·ª•ng n√≥ trong workflow.

---

### **V√≠ d·ª• th·ª±c t·∫ø: GET danh s√°ch file t·ª´ SharePoint**
1. S·ª≠ d·ª•ng API Endpoint:
   ```
   https://yoursharepointsite/_api/web/GetFolderByServerRelativeUrl('/YourFolder')/Files
   ```
2. ƒê·∫∑t Header v·ªõi Access Token:
   ```
   Authorization: Bearer YOUR_ACCESS_TOKEN
   Content-Type: application/json
   ```
3. X·ª≠ l√Ω Response ƒë·ªÉ hi·ªÉn th·ªã danh s√°ch file.

---

N·∫øu b·∫°n g·∫∑p v·∫•n ƒë·ªÅ c·ª• th·ªÉ ·ªü b∆∞·ªõc n√†o, h√£y cho t√¥i bi·∫øt nh√©! T√¥i c√≥ th·ªÉ h·ªó tr·ª£ chi ti·∫øt h∆°n! üòä
================================
ƒê·ªÉ l·∫•y th√¥ng tin t·ª´ SharePoint API, b·∫°n c·∫ßn th·ª±c hi·ªán c√°c b∆∞·ªõc d∆∞·ªõi ƒë√¢y:

---

### **B∆∞·ªõc 1: X√°c ƒë·ªãnh m·ª•c ti√™u**
- X√°c ƒë·ªãnh nh·ªØng g√¨ b·∫°n mu·ªën th·ª±c hi·ªán th√¥ng qua API, v√≠ d·ª• nh∆∞:
  - L·∫•y danh s√°ch file ho·∫∑c folder.
  - Th√™m, s·ª≠a ho·∫∑c x√≥a d·ªØ li·ªáu trong danh s√°ch ho·∫∑c th∆∞ m·ª•c.
  - Truy xu·∫•t th√¥ng tin user, nh√≥m ho·∫∑c quy·ªÅn.

---

### **B∆∞·ªõc 2: L·∫•y URL SharePoint Site**
- ƒêƒÉng nh·∫≠p v√†o trang SharePoint c·ªßa b·∫°n.
- X√°c ƒë·ªãnh URL c·ªßa trang web ho·∫∑c th∆∞ m·ª•c b·∫°n c·∫ßn truy c·∫≠p, v√≠ d·ª•: `https://yoursharepointsite.sharepoint.com`.

---

### **B∆∞·ªõc 3: K√≠ch ho·∫°t SharePoint API**
- API c·ªßa SharePoint th∆∞·ªùng ƒë∆∞·ª£c t√≠ch h·ª£p s·∫µn, b·∫°n ch·ªâ c·∫ßn x√°c ƒë·ªãnh ƒë√∫ng endpoint ph√π h·ª£p:
  - **Danh s√°ch (List):** `/sites/{siteName}/_api/web/lists`
  - **Th∆∞ m·ª•c (Folder):** `/sites/{siteName}/_api/web/GetFolderByServerRelativeUrl('/FolderName')`

---

### **B∆∞·ªõc 4: L·∫•y Access Token**
ƒê·ªÉ s·ª≠ d·ª•ng SharePoint API, b·∫°n c·∫ßn Access Token ƒë·ªÉ x√°c th·ª±c:
1. ƒêƒÉng k√Ω ·ª©ng d·ª•ng v·ªõi Azure Active Directory.
   - ƒêi·ªÅu n√†y cho ph√©p b·∫°n c·∫•p quy·ªÅn truy c·∫≠p cho ·ª©ng d·ª•ng c·ªßa m√¨nh.
2. T·∫°o Client ID v√† Client Secret khi ƒëƒÉng k√Ω ·ª©ng d·ª•ng.
3. S·ª≠ d·ª•ng **OAuth 2.0** ƒë·ªÉ l·∫•y Access Token t·ª´ Microsoft Graph API ho·∫∑c Azure AD.

---

### **B∆∞·ªõc 5: T√¨m Endpoint API**
- M·ªü [SharePoint API Documentation](https://learn.microsoft.com/en-us/sharepoint/dev/sp-add-ins/sharepoint-net-server-and-rest-service-reference) ƒë·ªÉ t√¨m danh s√°ch c√°c API endpoint ph√π h·ª£p v·ªõi nhu c·∫ßu c·ªßa b·∫°n.

---

### **B∆∞·ªõc 6: Ki·ªÉm tra v√† th·ª≠ nghi·ªám**
- S·ª≠ d·ª•ng c√¥ng c·ª• nh∆∞ Postman ƒë·ªÉ th·ª≠ nghi·ªám API:
  - Th√™m Access Token v√†o ph·∫ßn **Headers**.
  - G·ª≠i y√™u c·∫ßu GET, POST, PUT, DELETE ƒë·∫øn ƒë√∫ng endpoint.

---

N·∫øu b·∫°n c·∫ßn th√™m tr·ª£ gi√∫p ƒë·ªÉ th·ª±c hi·ªán c√°c b∆∞·ªõc n√†y ho·∫∑c c√≥ th·∫Øc m·∫Øc c·ª• th·ªÉ, h√£y cho t√¥i bi·∫øt nh√©! üòä
===============================
D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt t·ª´ng b∆∞·ªõc ƒë·ªÉ l·∫•y Access Token t·ª´ Azure Active Directory (Azure AD) ƒë·ªÉ s·ª≠ d·ª•ng v·ªõi SharePoint API:

---

### **B∆∞·ªõc 1: ƒêƒÉng nh·∫≠p v√†o Azure Portal**
1. Truy c·∫≠p [Azure Portal](https://portal.azure.com).
2. ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n qu·∫£n tr·ªã vi√™n.

---

### **B∆∞·ªõc 2: ƒêƒÉng k√Ω ·ª©ng d·ª•ng**
1. Trong Azure Portal, v√†o m·ª•c **Azure Active Directory** > **App registrations**.
2. Ch·ªçn **New registration**.
3. ƒêi·ªÅn th√¥ng tin:
   - **Name**: ƒê·∫∑t t√™n cho ·ª©ng d·ª•ng (v√≠ d·ª•: "SharePointAPIApp").
   - **Supported account types**: Ch·ªçn **Single tenant** ho·∫∑c **Multi-tenant** t√πy thu·ªôc v√†o nhu c·∫ßu.
   - **Redirect URI**: ƒê·ªÉ tr·ªëng ho·∫∑c ƒëi·ªÅn URL n·∫øu b·∫°n s·ª≠ d·ª•ng ·ª©ng d·ª•ng c√≥ giao di·ªán ng∆∞·ªùi d√πng.
4. Nh·∫•n **Register** ƒë·ªÉ ho√†n t·∫•t.

---

### **B∆∞·ªõc 3: T·∫°o Client ID v√† Client Secret**
1. Sau khi ƒëƒÉng k√Ω ·ª©ng d·ª•ng, b·∫°n s·∫Ω th·∫•y **Application (client) ID**. L∆∞u l·∫°i th√¥ng tin n√†y.
2. V√†o m·ª•c **Certificates & secrets**.
3. Ch·ªçn **New client secret**.
   - ƒêi·ªÅn m√¥ t·∫£.
   - Ch·ªçn th·ªùi h·∫°n h·∫øt h·∫°n (v√≠ d·ª•: 6 th√°ng, 12 th√°ng).
4. Nh·∫•n **Add** v√† l∆∞u l·∫°i **Value** c·ªßa Client Secret.

---

### **B∆∞·ªõc 4: C·∫•p quy·ªÅn cho ·ª©ng d·ª•ng**
1. V√†o m·ª•c **API permissions** c·ªßa ·ª©ng d·ª•ng.
2. Ch·ªçn **Add a permission**.
3. Ch·ªçn **Microsoft Graph** ho·∫∑c **SharePoint** t√πy nhu c·∫ßu.
4. Ch·ªçn quy·ªÅn (v√≠ d·ª•: `Sites.ReadWrite.All`, `Sites.Read.All`).
5. Nh·∫•n **Grant admin consent** ƒë·ªÉ c·∫•p quy·ªÅn cho ·ª©ng d·ª•ng.

---

### **B∆∞·ªõc 5: L·∫•y Access Token**
1. S·ª≠ d·ª•ng c√¥ng c·ª• nh∆∞ Postman ho·∫∑c code ƒë·ªÉ g·ª≠i y√™u c·∫ßu l·∫•y Access Token. 
2. G·ª≠i y√™u c·∫ßu HTTP POST ƒë·∫øn endpoint:
   ```
   https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token
   ```
   - `{tenant_id}` l√† ID c·ªßa tenant trong Azure AD.
3. Trong Body c·ªßa y√™u c·∫ßu, nh·∫≠p:
   ```json
   {
       "grant_type": "client_credentials",
       "client_id": "[Client ID]",
       "client_secret": "[Client Secret]",
       "scope": "https://graph.microsoft.com/.default"
   }
   ```
4. Khi y√™u c·∫ßu ho√†n t·∫•t, b·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c Access Token trong ph·∫ßn ph·∫£n h·ªìi.

---

### **B∆∞·ªõc 6: S·ª≠ d·ª•ng Access Token**
1. Th√™m Access Token n√†y v√†o **Headers** c·ªßa c√°c y√™u c·∫ßu API SharePoint.
   ```
   Authorization: Bearer [Access Token]
   ```

---

N·∫øu b·∫°n g·∫∑p kh√≥ khƒÉn ·ªü b·∫•t k·ª≥ b∆∞·ªõc n√†o, t√¥i r·∫•t s·∫µn l√≤ng h∆∞·ªõng d·∫´n chi ti·∫øt th√™m. B·∫°n mu·ªën th·ª≠ b∆∞·ªõc n√†o tr∆∞·ªõc? üòä
