D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt t·ª´ng b∆∞·ªõc ƒë·ªÉ b·∫°n d√πng NTLM Authentication trong UiPath, g·ªçi SharePoint REST API:

1. **L·∫•y danh s√°ch file t·ª´ th∆∞ m·ª•c Source**  
2. **Ghi metadata (t√™n, ƒë∆∞·ªùng d·∫´n) v√†o Excel**  
3. **ƒê·ªçc Excel, r·ªìi move t·ª´ng file sang th∆∞ m·ª•c Destination**  

---

## 0. Chu·∫©n b·ªã chung

- C√†i package **UiPath.WebAPI.Activities**  
- Import namespace **Newtonsoft.Json.Linq** (n·∫øu c·∫ßn Deserialize JSON)  
- T·∫°o m·ªôt **Sequence** ch√≠nh, v√† trong panel **Variables** th√™m:

| T√™n bi·∫øn         | Ki·ªÉu            | M√¥ t·∫£                                                       |
|------------------|-----------------|-------------------------------------------------------------|
| `spSiteUrl`      | String          | `https://contoso.sharepoint.com/sites/MySite`              |
| `domain`         | String          | (ƒë·ªÉ tr·ªëng ho·∫∑c `contoso`)                                   |
| `spUsername`     | String          | `user@contoso.com`                                          |
| `spPassword`     | SecureString    | password t∆∞∆°ng ·ª©ng                                          |
| `libraryName`    | String          | V√≠ d·ª• `"Shared Documents"`                                  |
| `sourceFolder`   | String          | V√≠ d·ª• `"FolderA"`                                           |
| `destFolder`     | String          | V√≠ d·ª• `"FolderB"`                                           |
| `excelFilePath`  | String          | ƒê∆∞·ªùng d·∫´n file Excel xu·∫•t ra, v√≠ d·ª• `"C:\temp\Files.xlsx"` |

---

## 1. L·∫•y FormDigestValue (cho t·∫•t c·∫£ POST)

1. **Sequence**: **Get Request Digest**  
2. **HTTP Request**¬†activity  
   - **Endpoint**:  
     ```vb
     spSiteUrl + "/_api/contextinfo"
     ```
   - **Method**: POST  
   - **Authentication**: NTLM (Domain/Username/Password nh∆∞ tr√™n)  
   - **Headers**:
     | Name   | Value                             |
     | ------ | --------------------------------- |
     | Accept | `application/json;odata=verbose`  |
   - **Outputs**:
     - **Response** ‚Üí `digestResponse` (String)  
     - **StatusCode** ‚Üí `digestStatus` (Int32)  

3. **Deserialize JSON** ‚Üí l∆∞u v√†o `jDigest` (JObject)  
4. **Extract**:
   ```vb
   formDigest = jDigest("d")("GetContextWebInformation")("FormDigestValue").ToString
   ```

---

## 2. L·∫•y danh s√°ch file & ghi v√†o Excel

### 2.1. L·∫•y file list

1. **Sequence**: **Get File List**  
2. **HTTP Request**¬†activity  
   - **Endpoint**:
     ```vb
     spSiteUrl + 
       "/_api/web/GetFolderByServerRelativeUrl('/" + libraryName + "/" + sourceFolder + "')/Files"
     ```
   - **Method**: GET  
   - **Authentication**: NTLM  
   - **Headers**:
     | Name   | Value                            |
     | ------ | -------------------------------- |
     | Accept | `application/json;odata=verbose` |
   - **Outputs**:
     - **Response** ‚Üí `filesResponse` (String)  
     - **StatusCode** ‚Üí `filesStatus` (Int32)  

3. **If** `filesStatus <> 200` ‚Üí Throw Exception / Log error  

4. **Deserialize JSON**  
   ```vb
   jFiles = JObject.Parse(filesResponse)("d")("results")
   ```
5. **Build DataTable**  
   - **Activity**: **Build Data Table**  
   - Columns: `"Name"` (String), `"ServerRelativeUrl"` (String)  
   - **Output** ‚Üí `dtFiles`  

6. **For Each** item in `jFiles` (TypeArgument = JToken)  
   - **Assign**  
     ```vb
     row = dtFiles.NewRow()
     row("Name") = item("Name").ToString
     row("ServerRelativeUrl") = item("ServerRelativeUrl").ToString
     dtFiles.Rows.Add(row)
     ```

### 2.2. Ghi DataTable ra Excel

1. **Excel Application Scope** (`excelFilePath`)  
2. **Write Range** (Sheet1!A1)  
   - **DataTable**: `dtFiles`  
   - **AddHeaders**: True  

---

## 3. ƒê·ªçc Excel & Move File

### 3.1. ƒê·ªçc Excel

1. **Sequence**: **Read Excel For Moves**  
2. **Excel Application Scope** (`excelFilePath`)  
3. **Read Range**  
   - **SheetName**: `"Sheet1"`  
   - **Range**: `""` (ƒë·ªÉ l·∫•y to√†n sheet)  
   - **Output** ‚Üí `dtToMove` (DataTable)

### 3.2. Move t·ª´ng file

1. **For Each Row** in `dtToMove`  
2. **Build**  
   ```vb
   srcUrl = row("ServerRelativeUrl").ToString
   dstUrl = "/" + libraryName + "/" + destFolder + "/" + row("Name").ToString
   movetoEndpoint = spSiteUrl + "/_api/web/GetFileByServerRelativeUrl('" + srcUrl + "')/moveto(newurl='" + dstUrl + "',flags=1)"
   ```
3. **HTTP Request**¬†activity  
   - **Name**: `HTTP_MoveFile`  
   - **Endpoint**: `movetoEndpoint`  
   - **Method**: POST  
   - **Authentication**: NTLM  
   - **Headers**:
     | Name            | Value                              |
     | --------------- | ---------------------------------- |
     | Accept          | `application/json;odata=verbose`   |
     | Content-Type    | `application/json;odata=verbose`   |
     | X-RequestDigest | `formDigest`                       |
   - **Outputs**:
     - **StatusCode** ‚Üí `moveStatus` (Int32)  
4. **If** `moveStatus = 200 Or moveStatus = 204` ‚Üí Log ‚ÄúMoved `{row("Name")}` th√†nh c√¥ng‚Äù  
   **Else** ‚Üí Log ‚ÄúL·ªói di chuy·ªÉn `{row("Name")}`: {moveStatus}‚Äù

---

## 4. T√≥m t·∫Øt

1. **Get Digest** (1 l·∫ßn)  
2. **GET /Files** ‚Üí Build DataTable ‚Üí Write Excel  
3. **Read Excel** ‚Üí For Each ‚Üí POST /moveto ‚Üí Move file  

V·ªõi workflow tr√™n, b·∫°n ƒë√£ ho√†n to√†n ‚Äúskip‚Äù Azure¬†AD, d√πng NTLM ƒë·ªÉ l·∫•y file list, ghi metadata v√†o Excel, r·ªìi d·ª±a tr√™n Excel ƒë·ªÉ move file trong SharePoint. N·∫øu c·∫ßn th√™m paging (n·∫øu >100 file), ho·∫∑c l·ªçc file theo extension, b·∫°n ch·ªâ vi·ªác th√™m `$top`/`$filter` v√†o URL GET. Ch√∫c b·∫°n th√†nh c√¥ng!
=======
D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt t·ª´ng b∆∞·ªõc ƒë·ªÉ b·∫°n thi·∫øt l·∫≠p v√† g·ªçi SharePoint REST API b·∫±ng NTLM Authentication trong UiPath. M√¨nh s·∫Ω l·∫•y v√≠ d·ª• ‚ÄúL·∫•y danh s√°ch Items‚Äù (GET) v√† ‚ÄúT·∫°o m·ªõi Item‚Äù (POST) tr√™n m·ªôt SharePoint Online site.

---

## 1. Chu·∫©n b·ªã m√¥i tr∆∞·ªùng

1. M·ªü UiPath Studio, t·∫°o ho·∫∑c m·ªü d·ª± √°n c·ªßa b·∫°n.  
2. V√†o **Manage Packages** ‚Üí c√†i **UiPath.WebAPI.Activities**.  
3. (N·∫øu c·∫ßn parse JSON) V√†o **Imports** ‚Üí th√™m namespace `Newtonsoft.Json.Linq`.  

---

## 2. Thi·∫øt l·∫≠p bi·∫øn chung

Trong panel **Variables** c·ªßa Sequence ch√≠nh, t·∫°o c√°c bi·∫øn sau:

| T√™n bi·∫øn       | Ki·ªÉu           | M√¥ t·∫£                                    |
| -------------- | -------------- | ---------------------------------------- |
| `spSiteUrl`    | String         | URL site, v√≠ d·ª• `https://contoso.sharepoint.com/sites/MySite` |
| `spUsername`   | String         | T√†i kho·∫£n c√≥ quy·ªÅn truy c·∫≠p (v√≠ d·ª•: `user@contoso.com`)       |
| `spPassword`   | SecureString   | Password (k√©o th·∫£ v√†o ƒë·ªÉ b·∫£o m·∫≠t)        |
| `domain`       | String         | Domain (c√≥ th·ªÉ ƒë·ªÉ tr·ªëng ho·∫∑c `contoso`)  |

---

## 3. L·∫•y danh s√°ch Items (GET)

1. **T·∫°o Sequence** m·ªõi, ƒë·∫∑t t√™n ‚ÄúGet SP List Items‚Äù.  
2. **Activity**: **HTTP Request** (UiPath.WebAPI.Activities)  
   - **Name**: `HTTP_GetItems`  
   - **Endpoint**:
     ```
     spSiteUrl + "/_api/web/lists/GetByTitle('MyList')/items"
     ```
   - **Method**: GET  
   - **Authentication**:
     - **Type**: NTLM  
     - **Domain**: `domain`  
     - **Username**: `spUsername`  
     - **Password**: `spPassword`  
   - **Headers**:
     | Name      | Value                                 |
     | --------- | ------------------------------------- |
     | Accept    | `application/json;odata=verbose`      |
   - **Outputs**:
     - **Result** ‚Üí `itemsResponse` (String)
     - **StatusCode** ‚Üí `itemsStatus` (Int32)

3. **Ki·ªÉm tra StatusCode**  
   - Th√™m **If** activity: `itemsStatus = 200`  
     - **Then**: ti·∫øp t·ª•c  
     - **Else**: Throw Business Rule Exception (t√πy b·∫°n)

4. **Deserialize JSON**  
   - **Activity**: **Deserialize JSON**  
     - **Input**: `itemsResponse`  
     - **TypeArgument**: `Newtonsoft.Json.Linq.JObject`  
     - **Output**: `jItemsObj`

5. **L·∫•y m·∫£ng results**  
   ```vb
   Dim results As JArray = jItemsObj("d")("results")
   ```
6. **For Each**  
   - **TypeArgument**: `Newtonsoft.Json.Linq.JToken`  
   - **Values**: `results`  
   - **Body**: v√≠ d·ª• `Log Message`: `item("Title").ToString`

---

## 4. T·∫°o m·ªõi Item (POST)

> **L∆∞u √Ω**: V·ªõi POST/DELETE b·∫°n v·∫´n c·∫ßn form‚Äëdigest (Request Digest) ƒë·ªÉ ƒë·∫£m b·∫£o session.

### 4.1. L·∫•y FormDigestValue

1. **Sequence**: ‚ÄúGet Request Digest‚Äù  
2. **HTTP Request**  
   - **Name**: `HTTP_GetDigest`  
   - **Endpoint**:  
     ```
     spSiteUrl + "/_api/contextinfo"
     ```
   - **Method**: POST  
   - **Authentication**: gi·ªëng b∆∞·ªõc GET (NTLM)  
   - **Headers**:  
     | Name   | Value                           |
     | ------ | ------------------------------- |
     | Accept | `application/json;odata=verbose`|
   - **Outputs**:  
     - `digestResponse` (String)  
     - `digestStatus` (Int32)

3. **Deserialize JSON** ‚Üí `jDigestObj` (JObject)  
4. **Extract FormDigestValue**  
   ```vb
   formDigest = jDigestObj("d")("GetContextWebInformation")("FormDigestValue").ToString
   ```

### 4.2. G·ª≠i POST t·∫°o Item

1. **Sequence**: ‚ÄúCreate SP List Item‚Äù  
2. **HTTP Request**  
   - **Name**: `HTTP_CreateItem`  
   - **Endpoint**:  
     ```
     spSiteUrl + "/_api/web/lists/GetByTitle('MyList')/items"
     ```
   - **Method**: POST  
   - **Authentication**: NTLM (gi·ªëng tr√™n)  
   - **Headers**:  
     | Name            | Value                                        |
     | --------------- | -------------------------------------------- |
     | Authorization   | (b·ªè tr·ªëng v·ªõi NTLM)                          |
     | Accept          | `application/json;odata=verbose`             |
     | Content-Type    | `application/json;odata=verbose`             |
     | X-RequestDigest | `formDigest` (String)                       |
   - **Body**: chuy·ªÉn `Body` format = Raw (application/json)
     ```json
     {
       "__metadata": { "type": "SP.Data.MyListListItem" },
       "Title": "Test t·ª´ UiPath NTLM",
       "CustomField": "Gi√° tr·ªã NTLM"
     }
     ```
   - **Outputs**:  
     - `createResponse` (String)  
     - `createStatus` (Int32)

3. **Ki·ªÉm tra k·∫øt qu·∫£**  
   - If `createStatus = 201` th√¨ Success, else Throw Exception ho·∫∑c log l·ªói.

---

## 5. C√°c l∆∞u √Ω

- V·ªõi **PATCH/MERGE** cho update:  
  - Method = MERGE ho·∫∑c PATCH  
  - Th√™m header `IF-MATCH: *`  
- V·ªõi **DELETE**:  
  - Method = DELETE  
  - Header `IF-MATCH: *`  
- C√≥ th·ªÉ d√πng `$select`, `$filter`, `$top`‚Ä¶ trong URL ƒë·ªÉ l·ªçc d·ªØ li·ªáu.

---

Gi·ªù b·∫°n ƒë√£ c√≥ m·ªôt workflow NTLM‚Äëonly, kh√¥ng qua Azure¬†AD, ƒë·ªÉ th·ª±c hi·ªán CRUD tr√™n SharePoint List. N·∫øu c√≤n ch·ªó n√†o ch∆∞a r√µ ho·∫∑c c·∫ßn m·ªü r·ªông th√™m (v√≠ d·ª• paging, error handling n√¢ng cao‚Ä¶), c·ª© b√°o m√¨nh nh√©!

------------------------------------------------------------------------------------------------------------
D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt theo t·ª´ng b∆∞·ªõc ƒë·ªÉ s·ª≠ d·ª•ng SharePoint Request API trong UiPath:

---

### **B∆∞·ªõc 1: C√†i ƒë·∫∑t c√°c g√≥i c·∫ßn thi·∫øt**
1. M·ªü **UiPath Studio**.
2. Ch·ªçn **Manage Packages** t·ª´ menu.
3. T√¨m ki·∫øm v√† c√†i ƒë·∫∑t g√≥i **UiPath.WebAPI.Activities** ƒë·ªÉ s·ª≠ d·ª•ng ho·∫°t ƒë·ªông HTTP Request.

---

### **B∆∞·ªõc 2: L·∫•y th√¥ng tin SharePoint API**
1. X√°c ƒë·ªãnh API endpoint t·ª´ SharePoint (v√≠ d·ª•: URL th∆∞ m·ª•c, danh s√°ch c·∫ßn truy c·∫≠p).
2. ƒêƒÉng nh·∫≠p v√†o SharePoint ƒë·ªÉ l·∫•y Access Token ho·∫∑c th√¥ng tin x√°c th·ª±c. B·∫°n c√≥ th·ªÉ s·ª≠ d·ª•ng Microsoft Graph API n·∫øu c·∫ßn Access Token.

---

### **B∆∞·ªõc 3: Th√™m ho·∫°t ƒë·ªông HTTP Request**
1. Trong UiPath Studio, k√©o ho·∫°t ƒë·ªông **HTTP Request** t·ª´ **Activities Panel** v√†o workflow.
2. ƒêi·ªÅn th√¥ng tin:
   - **Method**: Ch·ªçn GET/POST/PUT/DELETE t√πy y√™u c·∫ßu API.
   - **Endpoint**: D√°n URL API SharePoint.

---

### **B∆∞·ªõc 4: C·∫•u h√¨nh Headers**
1. Trong thu·ªôc t√≠nh **Headers**, th√™m:
   - `Authorization`: `Bearer [Access Token]` (trong ƒë√≥ [Access Token] l√† token b·∫°n v·ª´a l·∫•y ƒë∆∞·ª£c).
   - `Content-Type`: `application/json`.

---

### **B∆∞·ªõc 5: T·∫°o Body (n·∫øu c·∫ßn)**
1. N·∫øu b·∫°n th·ª±c hi·ªán y√™u c·∫ßu POST ho·∫∑c PUT, t·∫°o d·ªØ li·ªáu d·∫°ng JSON cho thu·ªôc t√≠nh **Body**:
   ```json
   {
       "Title": "New Item",
       "Description": "This is a test description."
   }
   ```
2. S·ª≠ d·ª•ng ho·∫°t ƒë·ªông **Assign** ƒë·ªÉ t·∫°o Body ho·∫∑c nh·∫≠p tr·ª±c ti·∫øp v√†o thu·ªôc t√≠nh.

---

### **B∆∞·ªõc 6: X·ª≠ l√Ω Response**
1. Khi y√™u c·∫ßu ho√†n t·∫•t, d·ªØ li·ªáu tr·∫£ v·ªÅ s·∫Ω ƒë∆∞·ª£c l∆∞u trong Output Variable c·ªßa ho·∫°t ƒë·ªông HTTP Request.
2. S·ª≠ d·ª•ng ho·∫°t ƒë·ªông **Deserialize JSON** ƒë·ªÉ ph√¢n t√≠ch c√∫ ph√°p d·ªØ li·ªáu nh·∫≠n ƒë∆∞·ª£c v√† s·ª≠ d·ª•ng n√≥ trong workflow.

---

### **V√≠ d·ª• th·ª±c t·∫ø: GET danh s√°ch file t·ª´ SharePoint**
1. S·ª≠ d·ª•ng API Endpoint:
   ```
   https://yoursharepointsite/_api/web/GetFolderByServerRelativeUrl('/YourFolder')/Files
   ```
2. ƒê·∫∑t Header v·ªõi Access Token:
   ```
   Authorization: Bearer YOUR_ACCESS_TOKEN
   Content-Type: application/json
   ```
3. X·ª≠ l√Ω Response ƒë·ªÉ hi·ªÉn th·ªã danh s√°ch file.

---

N·∫øu b·∫°n g·∫∑p v·∫•n ƒë·ªÅ c·ª• th·ªÉ ·ªü b∆∞·ªõc n√†o, h√£y cho t√¥i bi·∫øt nh√©! T√¥i c√≥ th·ªÉ h·ªó tr·ª£ chi ti·∫øt h∆°n! üòä
================================
ƒê·ªÉ l·∫•y th√¥ng tin t·ª´ SharePoint API, b·∫°n c·∫ßn th·ª±c hi·ªán c√°c b∆∞·ªõc d∆∞·ªõi ƒë√¢y:

---

### **B∆∞·ªõc 1: X√°c ƒë·ªãnh m·ª•c ti√™u**
- X√°c ƒë·ªãnh nh·ªØng g√¨ b·∫°n mu·ªën th·ª±c hi·ªán th√¥ng qua API, v√≠ d·ª• nh∆∞:
  - L·∫•y danh s√°ch file ho·∫∑c folder.
  - Th√™m, s·ª≠a ho·∫∑c x√≥a d·ªØ li·ªáu trong danh s√°ch ho·∫∑c th∆∞ m·ª•c.
  - Truy xu·∫•t th√¥ng tin user, nh√≥m ho·∫∑c quy·ªÅn.

---

### **B∆∞·ªõc 2: L·∫•y URL SharePoint Site**
- ƒêƒÉng nh·∫≠p v√†o trang SharePoint c·ªßa b·∫°n.
- X√°c ƒë·ªãnh URL c·ªßa trang web ho·∫∑c th∆∞ m·ª•c b·∫°n c·∫ßn truy c·∫≠p, v√≠ d·ª•: `https://yoursharepointsite.sharepoint.com`.

---

### **B∆∞·ªõc 3: K√≠ch ho·∫°t SharePoint API**
- API c·ªßa SharePoint th∆∞·ªùng ƒë∆∞·ª£c t√≠ch h·ª£p s·∫µn, b·∫°n ch·ªâ c·∫ßn x√°c ƒë·ªãnh ƒë√∫ng endpoint ph√π h·ª£p:
  - **Danh s√°ch (List):** `/sites/{siteName}/_api/web/lists`
  - **Th∆∞ m·ª•c (Folder):** `/sites/{siteName}/_api/web/GetFolderByServerRelativeUrl('/FolderName')`

---

### **B∆∞·ªõc 4: L·∫•y Access Token**
ƒê·ªÉ s·ª≠ d·ª•ng SharePoint API, b·∫°n c·∫ßn Access Token ƒë·ªÉ x√°c th·ª±c:
1. ƒêƒÉng k√Ω ·ª©ng d·ª•ng v·ªõi Azure Active Directory.
   - ƒêi·ªÅu n√†y cho ph√©p b·∫°n c·∫•p quy·ªÅn truy c·∫≠p cho ·ª©ng d·ª•ng c·ªßa m√¨nh.
2. T·∫°o Client ID v√† Client Secret khi ƒëƒÉng k√Ω ·ª©ng d·ª•ng.
3. S·ª≠ d·ª•ng **OAuth 2.0** ƒë·ªÉ l·∫•y Access Token t·ª´ Microsoft Graph API ho·∫∑c Azure AD.

---

### **B∆∞·ªõc 5: T√¨m Endpoint API**
- M·ªü [SharePoint API Documentation](https://learn.microsoft.com/en-us/sharepoint/dev/sp-add-ins/sharepoint-net-server-and-rest-service-reference) ƒë·ªÉ t√¨m danh s√°ch c√°c API endpoint ph√π h·ª£p v·ªõi nhu c·∫ßu c·ªßa b·∫°n.

---

### **B∆∞·ªõc 6: Ki·ªÉm tra v√† th·ª≠ nghi·ªám**
- S·ª≠ d·ª•ng c√¥ng c·ª• nh∆∞ Postman ƒë·ªÉ th·ª≠ nghi·ªám API:
  - Th√™m Access Token v√†o ph·∫ßn **Headers**.
  - G·ª≠i y√™u c·∫ßu GET, POST, PUT, DELETE ƒë·∫øn ƒë√∫ng endpoint.

---

N·∫øu b·∫°n c·∫ßn th√™m tr·ª£ gi√∫p ƒë·ªÉ th·ª±c hi·ªán c√°c b∆∞·ªõc n√†y ho·∫∑c c√≥ th·∫Øc m·∫Øc c·ª• th·ªÉ, h√£y cho t√¥i bi·∫øt nh√©! üòä
===============================
D∆∞·ªõi ƒë√¢y l√† h∆∞·ªõng d·∫´n chi ti·∫øt t·ª´ng b∆∞·ªõc ƒë·ªÉ l·∫•y Access Token t·ª´ Azure Active Directory (Azure AD) ƒë·ªÉ s·ª≠ d·ª•ng v·ªõi SharePoint API:

---

### **B∆∞·ªõc 1: ƒêƒÉng nh·∫≠p v√†o Azure Portal**
1. Truy c·∫≠p [Azure Portal](https://portal.azure.com).
2. ƒêƒÉng nh·∫≠p b·∫±ng t√†i kho·∫£n qu·∫£n tr·ªã vi√™n.

---

### **B∆∞·ªõc 2: ƒêƒÉng k√Ω ·ª©ng d·ª•ng**
1. Trong Azure Portal, v√†o m·ª•c **Azure Active Directory** > **App registrations**.
2. Ch·ªçn **New registration**.
3. ƒêi·ªÅn th√¥ng tin:
   - **Name**: ƒê·∫∑t t√™n cho ·ª©ng d·ª•ng (v√≠ d·ª•: "SharePointAPIApp").
   - **Supported account types**: Ch·ªçn **Single tenant** ho·∫∑c **Multi-tenant** t√πy thu·ªôc v√†o nhu c·∫ßu.
   - **Redirect URI**: ƒê·ªÉ tr·ªëng ho·∫∑c ƒëi·ªÅn URL n·∫øu b·∫°n s·ª≠ d·ª•ng ·ª©ng d·ª•ng c√≥ giao di·ªán ng∆∞·ªùi d√πng.
4. Nh·∫•n **Register** ƒë·ªÉ ho√†n t·∫•t.

---

### **B∆∞·ªõc 3: T·∫°o Client ID v√† Client Secret**
1. Sau khi ƒëƒÉng k√Ω ·ª©ng d·ª•ng, b·∫°n s·∫Ω th·∫•y **Application (client) ID**. L∆∞u l·∫°i th√¥ng tin n√†y.
2. V√†o m·ª•c **Certificates & secrets**.
3. Ch·ªçn **New client secret**.
   - ƒêi·ªÅn m√¥ t·∫£.
   - Ch·ªçn th·ªùi h·∫°n h·∫øt h·∫°n (v√≠ d·ª•: 6 th√°ng, 12 th√°ng).
4. Nh·∫•n **Add** v√† l∆∞u l·∫°i **Value** c·ªßa Client Secret.

---

### **B∆∞·ªõc 4: C·∫•p quy·ªÅn cho ·ª©ng d·ª•ng**
1. V√†o m·ª•c **API permissions** c·ªßa ·ª©ng d·ª•ng.
2. Ch·ªçn **Add a permission**.
3. Ch·ªçn **Microsoft Graph** ho·∫∑c **SharePoint** t√πy nhu c·∫ßu.
4. Ch·ªçn quy·ªÅn (v√≠ d·ª•: `Sites.ReadWrite.All`, `Sites.Read.All`).
5. Nh·∫•n **Grant admin consent** ƒë·ªÉ c·∫•p quy·ªÅn cho ·ª©ng d·ª•ng.

---

### **B∆∞·ªõc 5: L·∫•y Access Token**
1. S·ª≠ d·ª•ng c√¥ng c·ª• nh∆∞ Postman ho·∫∑c code ƒë·ªÉ g·ª≠i y√™u c·∫ßu l·∫•y Access Token. 
2. G·ª≠i y√™u c·∫ßu HTTP POST ƒë·∫øn endpoint:
   ```
   https://login.microsoftonline.com/{tenant_id}/oauth2/v2.0/token
   ```
   - `{tenant_id}` l√† ID c·ªßa tenant trong Azure AD.
3. Trong Body c·ªßa y√™u c·∫ßu, nh·∫≠p:
   ```json
   {
       "grant_type": "client_credentials",
       "client_id": "[Client ID]",
       "client_secret": "[Client Secret]",
       "scope": "https://graph.microsoft.com/.default"
   }
   ```
4. Khi y√™u c·∫ßu ho√†n t·∫•t, b·∫°n s·∫Ω nh·∫≠n ƒë∆∞·ª£c Access Token trong ph·∫ßn ph·∫£n h·ªìi.

---

### **B∆∞·ªõc 6: S·ª≠ d·ª•ng Access Token**
1. Th√™m Access Token n√†y v√†o **Headers** c·ªßa c√°c y√™u c·∫ßu API SharePoint.
   ```
   Authorization: Bearer [Access Token]
   ```

---

N·∫øu b·∫°n g·∫∑p kh√≥ khƒÉn ·ªü b·∫•t k·ª≥ b∆∞·ªõc n√†o, t√¥i r·∫•t s·∫µn l√≤ng h∆∞·ªõng d·∫´n chi ti·∫øt th√™m. B·∫°n mu·ªën th·ª≠ b∆∞·ªõc n√†o tr∆∞·ªõc? üòä
