Ch√†o b·∫°n,
ƒê·ªÉ ƒë·ªãnh d·∫°ng s·ªë th√†nh 2 ch·ªØ s·ªë (v√≠ d·ª•: 5 th√†nh 05, 12 gi·ªØ nguy√™n 12), b·∫°n c√≥ 2 l·ª±a ch·ªçn t√πy thu·ªôc v√†o nhu c·∫ßu s·ª≠ d·ª•ng k·∫øt qu·∫£ ƒë√≥:
L·ª±a ch·ªçn 1: Ch·ªâ thay ƒë·ªïi hi·ªÉn th·ªã (D√πng h√†m FormatDestinationColumns)
N·∫øu b·∫°n ch·ªâ c·∫ßn nh√¨n th·∫•y s·ªë 05 tr√™n Excel nh∆∞ng b·∫£n ch·∫•t n√≥ v·∫´n l√† s·ªë (Number) ƒë·ªÉ t√≠nh to√°n c·ªông tr·ª´ ƒë∆∞·ª£c:
B·∫°n kh√¥ng c·∫ßn s·ª≠a code VBA, ch·ªâ c·∫ßn thay ƒë·ªïi tham s·ªë trong PAD:
 * Action: Set variable (%FormatMapping%)
 * Value: IndexC·ªôt|00
   * V√≠ d·ª• cho c·ªôt P (Index 16): 16|00
L·ª±a ch·ªçn 2: Chuy·ªÉn h·∫≥n th√†nh Text (D√πng h√†m TransformColumnData)
N·∫øu b·∫°n mu·ªën gi√° tr·ªã th·ª±c s·ª± bi·∫øn th√†nh Text (c√≥ d·∫•u nh√°y ' ·∫©n, v√≠ d·ª• '05), gi·ªëng nh∆∞ y√™u c·∫ßu '005 tr∆∞·ªõc ƒë√≥, b·∫°n c·∫ßn c·∫≠p nh·∫≠t Function TransformColumnData.
T√¥i ƒë√£ th√™m case TEXT_00 v√†o code d∆∞·ªõi ƒë√¢y.
1. üìÑ C·∫≠p nh·∫≠t Code VBA: TransformColumnData
B·∫°n h√£y thay th·∫ø to√†n b·ªô Function TransformColumnData c≈© b·∫±ng ƒëo·∫°n code m·ªõi n√†y (ƒë√£ th√™m ph·∫ßn x·ª≠ l√Ω TEXT_00):
' ------------------------------------------------------------------------------------------
' FUNCTION 4: TRANSFORM DATA (Apply logic to change values)
' ------------------------------------------------------------------------------------------
' Mapping Format: "ColIndex|OperationCode"
' Supported Codes:
' - TEXT_00         : Converts 5 -> "05" (Text format)  <-- M·ªöI TH√äM
' - TEXT_000        : Converts 5 -> "005" (Text format)
' - YEAR_LAST_DIGIT : Converts 2025 -> 5, 2026 -> 6
' ------------------------------------------------------------------------------------------
Public Function TransformColumnData(ByVal DestinationPath As String, _
                                    ByVal TransformMapping As String) As String

    Dim wbDest As Workbook
    Dim wsDest As Worksheet
    Dim arrMapping As Variant
    Dim arrPair As Variant
    Dim lDestIndex As Long
    Dim sOperation As String
    Dim lLastRow As Long
    Dim lHeaderRow As Long
    Dim i As Long
    Dim rng As Range, cell As Range
    Dim vValue As Variant

    TransformColumnData = "Success"
    On Error GoTo ErrorHandler

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    ' Open Destination Workbook
    Set wbDest = Workbooks.Open(DestinationPath)
    Set wsDest = wbDest.Sheets(1)
    lHeaderRow = 1

    ' Determine the last used row
    On Error Resume Next
    lLastRow = wsDest.Cells.Find(What:="*", After:=wsDest.Range("A1"), _
               LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByRows, _
               SearchDirection:=xlPrevious).Row
    On Error GoTo ErrorHandler

    If lLastRow <= lHeaderRow Then
        TransformColumnData = "Success (No Data Rows Found)"
        GoTo Finalize
    End If

    ' --- Process Mapping (Using "#" delimiter) ---
    arrMapping = Split(TransformMapping, "#")

    ' --- Start Transformation Process ---
    For i = LBound(arrMapping) To UBound(arrMapping)
        If Trim(arrMapping(i)) <> "" Then
            ' Split pair using "|" delimiter
            arrPair = Split(arrMapping(i), "|")
            
            If UBound(arrPair) = 1 Then
                On Error Resume Next
                lDestIndex = CLng(Trim(arrPair(0)))
                On Error GoTo ErrorHandler
                
                sOperation = UCase(Trim(arrPair(1))) ' Convert to Uppercase
                
                If lDestIndex > 0 Then
                    Set rng = wsDest.Range(wsDest.Cells(lHeaderRow + 1, lDestIndex), wsDest.Cells(lLastRow, lDestIndex))
                    
                    For Each cell In rng
                        vValue = cell.Value
                        
                        If Not IsError(vValue) And Len(CStr(vValue)) > 0 Then
                            Select Case sOperation
                            
                                ' --- CASE M·ªöI: 2 CH·ªÆ S·ªê (05) ---
                                Case "TEXT_00"
                                    cell.NumberFormat = "@" ' Text format
                                    If IsNumeric(vValue) Then
                                        cell.Value = Format(vValue, "00")
                                    End If

                                ' --- CASE C≈®: 3 CH·ªÆ S·ªê (005) ---
                                Case "TEXT_000"
                                    cell.NumberFormat = "@"
                                    If IsNumeric(vValue) Then
                                        cell.Value = Format(vValue, "000")
                                    End If
                                    
                                ' --- CASE C≈®: L·∫§Y S·ªê CU·ªêI NƒÇM (2025 -> 5) ---
                                Case "YEAR_LAST_DIGIT"
                                    Dim sYear As String
                                    If IsDate(vValue) Then
                                        sYear = CStr(Year(vValue))
                                    Else
                                        sYear = CStr(vValue)
                                    End If
                                    If Len(sYear) > 0 Then
                                        cell.Value = Right(sYear, 1)
                                    End If
                            End Select
                        End If
                    Next cell
                End If
            End If
        End If
    Next

    wbDest.Save

Finalize:
    wbDest.Close SaveChanges:=False
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Exit Function

ErrorHandler:
    Dim sErrorLog As String
    sErrorLog = "VBA Runtime Error: " & Err.Description
    TransformColumnData = "Fatal Error: " & sErrorLog
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    On Error Resume Next
    If Not wbDest Is Nothing Then wbDest.Close SaveChanges:=False
End Function

2. ü§ñ C·∫•u h√¨nh trong PAD
B·∫°n c·∫≠p nh·∫≠t bi·∫øn %TransformMapping% ƒë·ªÉ s·ª≠ d·ª•ng m√£ l·ªánh m·ªõi l√† TEXT_00.
V√≠ d·ª•: B·∫°n mu·ªën c·ªôt 15 (C·ªôt O) hi·ªÉn th·ªã 2 ch·ªØ s·ªë.
 * Variable: %TransformMapping%
 * Value: 15|TEXT_00
N·∫øu k·∫øt h·ª£p v·ªõi c√°c y√™u c·∫ßu tr∆∞·ªõc (C·ªôt 11,12,13 l√† 005, C·ªôt 14 l√† NƒÉm, C·ªôt 15 l√† 05):
 * Value: 11|TEXT_000#12|TEXT_000#13|TEXT_000#14|YEAR_LAST_DIGIT#15|TEXT_00
