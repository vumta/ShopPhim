Ráº¥t hay ğŸ‘ â€” ta sáº½ chuyá»ƒn toÃ n bá»™ logic Excel báº¡n nÃªu (3 bÆ°á»›c) thÃ nh chuá»—i Assign LINQ trong UiPath (copy-paste cháº¡y Ä‘Æ°á»£c ngay).
Má»¥c tiÃªu:

Nháº­p Ä‘áº§u vÃ o dateWeekend (kiá»ƒu DateTime, lÃ  Chá»§ nháº­t cá»§a tuáº§n hiá»‡n táº¡i).

TÃ­nh thá»© tá»± tuáº§n (weekNumCurrent),

Láº¥y tuáº§n tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c (weekNumPrev = weekNumCurrent),

TÃ­nh ra táº¥t cáº£ 7 ngÃ y cá»§a tuáº§n Ä‘Ã³ (thá»© 2 â†’ CN) trong nÄƒm trÆ°á»›c (List of DateTime).



---

ğŸ§© Chuá»—i Assign hoÃ n chá»‰nh (UiPath LINQ version)

1ï¸âƒ£ today (tuá»³ báº¡n, cÃ³ thá»ƒ bá» náº¿u Ä‘Ã£ cÃ³)

today = Now.Date

2ï¸âƒ£ dateWeekend â€” chá»§ nháº­t cá»§a tuáº§n hiá»‡n táº¡i

(vÃ­ dá»¥: náº¿u hÃ´m nay lÃ  Thá»© 4 â†’ CN tuáº§n nÃ y)

dateWeekend = today.AddDays(DayOfWeek.Sunday - today.DayOfWeek)


---

3ï¸âƒ£ weekNumCurrent â€” thá»© tá»± tuáº§n trong nÄƒm hiá»‡n táº¡i (theo cÃ´ng thá»©c Excel)

weekNumCurrent = CInt(Math.Floor((dateWeekend - New DateTime(dateWeekend.Year,1,1) + TimeSpan.FromDays(DatePart(DateInterval.Weekday, New DateTime(dateWeekend.Year,1,1), FirstDayOfWeek.Monday) - 1)).TotalDays / 7)) + 1

> ğŸ“˜ Giá»‘ng cÃ´ng thá»©c Excel:

=INT((A1 - DATE(YEAR(A1),1,1) + WEEKDAY(DATE(YEAR(A1),1,1),2)) / 7) + 1




---

4ï¸âƒ£ weekNumPrev â€” tuáº§n tÆ°Æ¡ng á»©ng cá»§a nÄƒm trÆ°á»›c

weekNumPrev = weekNumCurrent


---

5ï¸âƒ£ firstDayPrevYear â€” ngÃ y 01/01 cá»§a nÄƒm trÆ°á»›c

firstDayPrevYear = New DateTime(dateWeekend.Year - 1, 1, 1)


---

6ï¸âƒ£ weekendPrevYear â€” Chá»§ nháº­t cá»§a tuáº§n tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c

(theo cÃ´ng thá»©c Excel:
=DATE(YEAR(A1)-1,1,1) + (B1-1)*7 + (7 - WEEKDAY(DATE(YEAR(A1)-1,1,1),2)))

weekendPrevYear = firstDayPrevYear.AddDays((weekNumPrev - 1) * 7 + (7 - CInt(firstDayPrevYear.DayOfWeek = DayOfWeek.Sunday)*7 - (CInt(firstDayPrevYear.DayOfWeek) - 1)))

â— NhÆ°ng cÃ´ng thá»©c Excel WEEKDAY(...,2) quy Æ°á»›c Thá»© 2=1, CN=7.
Trong .NET, DayOfWeek.Monday=1, Sunday=0, nÃªn pháº£i hiá»‡u chá»‰nh:
CÃ¡ch rÃµ rÃ ng hÆ¡n vÃ  an toÃ n hÆ¡n (Ä‘á»c dá»…):

weekendPrevYear = firstDayPrevYear.AddDays((weekNumPrev - 1) * 7 + (7 - If(firstDayPrevYear.DayOfWeek = DayOfWeek.Sunday, 7, CInt(firstDayPrevYear.DayOfWeek))))


---

7ï¸âƒ£ weekDatesPrevYear â€” danh sÃ¡ch 7 ngÃ y (Thá»© 2 â†’ CN) cá»§a tuáº§n Ä‘Ã³

weekDatesPrevYear = Enumerable.Range(0,7).Select(Function(i) weekendPrevYear.AddDays(i - 6)).ToList()


---

8ï¸âƒ£ weekDatesPrevYearStr â€” format ra chuá»—i yyyyMMdd

weekDatesPrevYearStr = weekDatesPrevYear.Select(Function(d) d.ToString("yyyyMMdd")).ToList()


---

âœ… Káº¿t quáº£:

Biáº¿n	Kiá»ƒu	Ã nghÄ©a

weekNumCurrent	Int32	Sá»‘ thá»© tá»± tuáº§n cá»§a dateWeekend trong nÄƒm hiá»‡n táº¡i
weekNumPrev	Int32	Tuáº§n tÆ°Æ¡ng á»©ng cá»§a nÄƒm trÆ°á»›c (báº±ng nhau)
weekendPrevYear	DateTime	Chá»§ nháº­t cá»§a tuáº§n Ä‘Ã³ trong nÄƒm trÆ°á»›c
weekDatesPrevYear	List(Of DateTime)	Danh sÃ¡ch ngÃ y (Thá»© 2 â†’ CN) cá»§a tuáº§n Ä‘Ã³ nÄƒm trÆ°á»›c
weekDatesPrevYearStr	List(Of String)	Danh sÃ¡ch ngÃ y dáº¡ng "yyyyMMdd" Ä‘á»ƒ báº¡n append vÃ o DataTable, ghi Excel, v.v.



---

ğŸ§® VÃ­ dá»¥:

Giáº£ sá»­:

today = 2025-10-13 (Thá»© 2)
dateWeekend = 2025-10-19

â†’ weekNumCurrent = 42
â†’ weekNumPrev = 42
â†’ weekendPrevYear = 2024-10-13
â†’ weekDatesPrevYearStr = ["20241007","20241008","20241009","20241010","20241011","20241012","20241013"]


---

Báº¡n cÃ³ muá»‘n mÃ¬nh bá»• sung thÃªm Assign Ä‘á»ƒ Ä‘Æ°a dá»¯ liá»‡u tuáº§n nÃ y + tuáº§n nÄƒm trÆ°á»›c vÃ o cÃ¹ng má»™t DataTable (giá»‘ng logic trÆ°á»›c Ä‘Ã³) Ä‘á»ƒ dÃ¹ng luÃ´n trong UiPath khÃ´ng?
Khi Ä‘Ã³ báº¡n chá»‰ cáº§n copy toÃ n bá»™ Assign + 1 Write Range lÃ  cháº¡y.

