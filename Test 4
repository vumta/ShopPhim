Cáº£m Æ¡n báº¡n Ä‘Ã£ pháº£n há»“i! ğŸ› ï¸  
ÄÃºng rá»“i, pháº§n khai bÃ¡o kiá»ƒu `[string, string[][]][]` sáº½ gÃ¢y lá»—i trong **Office Script**, vÃ¬ TypeScript trong mÃ´i trÆ°á»ng Office Script **khÃ´ng há»— trá»£ tuple array khai bÃ¡o kiá»ƒu phá»©c táº¡p nhÆ° váº­y**.

---

## âœ… CÃ¡ch sá»­a phÃ¹ há»£p vá»›i Office Script

Báº¡n nÃªn thay tháº¿ báº±ng khai bÃ¡o **object** Ä‘Æ¡n giáº£n hÆ¡n, vÃ­ dá»¥:

```ts
type ColumnData = {
  columnName: string;
  values: string[][];
};
```

Sau Ä‘Ã³, kiá»ƒu dá»¯ liá»‡u sáº½ lÃ :

```ts
ColumnData[]
```

---

## âœ… Cáº­p nháº­t láº¡i hÃ m Office Script tÆ°Æ¡ng thÃ­ch

### ğŸ” **HÃ m trÃ­ch xuáº¥t tá»« file nguá»“n (Ä‘á»c dá»¯ liá»‡u)**

```ts
function main(workbook: ExcelScript.Workbook, columnNames: string[]): ColumnData[] {
  const sheet = workbook.getActiveWorksheet();
  const values = sheet.getUsedRange().getValues();

  const headers = values[0] as string[];
  let result: ColumnData[] = [];

  for (let name of columnNames) {
    const colIndex = headers.indexOf(name);
    if (colIndex === -1) continue;

    const columnValues = values.slice(1).map(row => [String(row[colIndex])]);
    result.push({
      columnName: name,
      values: columnValues
    });
  }

  return result;
}

type ColumnData = {
  columnName: string;
  values: string[][];
};
```

---

### ğŸ” **HÃ m ghi vÃ o file Ä‘Ã­ch theo tÃªn cá»™t dÃ²ng 2**

```ts
function main(workbook: ExcelScript.Workbook, inputData: ColumnData[]) {
  const sheet = workbook.getActiveWorksheet();
  const headerRow = 2;
  const startRow = 3;

  const headers = sheet.getRange(`A${headerRow}:Z${headerRow}`).getValues()[0] as string[];
  const colMap: Record<string, number> = {};

  headers.forEach((name, i) => {
    if (name) colMap[String(name).trim()] = i;
  });

  const rowCount = inputData[0].values.length;

  for (let i = 0; i < rowCount; i++) {
    for (let column of inputData) {
      const colIndex = colMap[column.columnName];
      if (colIndex !== undefined) {
        sheet.getCell(startRow - 1 + i, colIndex).setValue(column.values[i][0]);
      }
    }
  }
}

type ColumnData = {
  columnName: string;
  values: string[][];
};
```

---

### âœ… Æ¯u Ä‘iá»ƒm cÃ¡ch dÃ¹ng `object`:

- Dá»… Ä‘á»c, dá»… má»Ÿ rá»™ng (cÃ³ thá»ƒ thÃªm `dataType`, `format`, v.v. sau nÃ y).
- Dá»… thao tÃ¡c trong Power Automate.
- TÆ°Æ¡ng thÃ­ch hoÃ n toÃ n vá»›i Office Script.

---

Báº¡n muá»‘n mÃ¬nh giÃºp thÃªm pháº§n **Parse JSON máº«u cho kiá»ƒu `ColumnData[]` nÃ y** Ä‘á»ƒ dÃ¹ng trong Power Automate khÃ´ng?
