ÄÃ¢y lÃ  hÆ°á»›ng dáº«n chi tiáº¿t **step-by-step** Ä‘á»ƒ sá»­a láº¡i cÃ¡ch táº¡o máº£ng JSON trong Power Automate, Ä‘áº£m báº£o biáº¿n `AllFiles` lÃ  **máº£ng cÃ¡c object JSON**, khÃ´ng pháº£i máº£ng cÃ¡c chuá»—i (`string`). Äiá»u nÃ y giÃºp trÃ¡nh lá»—i khi phÃ¢n tÃ­ch káº¿t quáº£ trong **UiPath** báº±ng `Deserialize JSON`.

---

## âœ… Má»¥c tiÃªu:
Táº¡o `AllFiles` dÆ°á»›i dáº¡ng:
```json
[
  { "Name": "file1.txt", "Path": "/sites/â€¦/file1.txt" },
  { "Name": "file2.txt", "Path": "/sites/â€¦/file2.txt" }
]
```

KhÃ´ng pháº£i dáº¡ng sai:
```json
[
  "{\"Name\":\"file1.txt\",\"Path\":\"/sites/â€¦/file1.txt\"}"
]
```

---

## ğŸ›  Step-by-step trong Power Automate

---

### ğŸ”¹ BÆ°á»›c 1: Khá»Ÿi táº¡o biáº¿n `AllFiles`
- **Action**: *Initialize variable*
- **Name**: `AllFiles`
- **Type**: `Array`
- **Value**: `[]`

---

### ğŸ”¹ BÆ°á»›c 2: Láº·p qua danh sÃ¡ch file

- **Action**: *Apply to each*
- **Input**: Array cÃ¡c file báº¡n láº¥y Ä‘Æ°á»£c tá»« Child Flow hoáº·c HTTP Request (vÃ­ dá»¥: `body('Parse_JSON')?['Files']`)

---

### ğŸ”¹ BÆ°á»›c 3: Táº¡o object JSON Ä‘Ãºng Ä‘á»‹nh dáº¡ng

BÃªn trong `Apply to each`, thÃªm:

- **Action**: *Append to array variable*
- **Name**: `AllFiles`
- **Value**:
```json
{
  "Name": @{items('Apply_to_each')?['Name']},
  "Path": @{items('Apply_to_each')?['ServerRelativeUrl']}
}
```

ğŸ“Œ **LÆ°u Ã½**: KHÃ”NG dÃ¹ng `string()` hoáº·c `json()` quanh object â€” Ä‘iá»u nÃ y sáº½ khiáº¿n object bá»‹ chuyá»ƒn thÃ nh chuá»—i JSON khÃ´ng mong muá»‘n.

---

### ğŸ”¹ BÆ°á»›c 4: Gá»­i káº¿t quáº£ qua Action "Response" (náº¿u cÃ³)

- **Action**: *Response*
  - **Status code**: `200`
  - **Headers**: `Content-Type: application/json`
  - **Body**:
```json
{
  "AllFiles": @{variables('AllFiles')}
}
```

---

## ğŸ”„ TrÃªn UiPath

- **Activity**: `Deserialize JSON`
- Input: `responseString`
- Output: `jsonObject`

Báº¡n cÃ³ thá»ƒ dÃ¹ng `For Each item in jsonObject("AllFiles")` Ä‘á»ƒ Ä‘á»c tá»«ng file.

---

Náº¿u báº¡n muá»‘n mÃ¬nh táº¡o **file `.zip` máº«u cho Flow cha + Flow con**, mÃ¬nh cÃ³ thá»ƒ há»— trá»£. Cáº§n khÃ´ng?
