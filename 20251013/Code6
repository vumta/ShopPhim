ÄÃºng rá»“i â€” Ä‘oáº¡n code báº¡n dÃ¡n á»Ÿ trÃªn khÃ´ng thá»ƒ Ä‘áº·t trá»±c tiáº¿p trong Assign cá»§a UiPath Ä‘Æ°á»£c, vÃ¬ UiPath chá»‰ cháº¥p nháº­n biá»ƒu thá»©c LINQ thuáº§n tráº£ vá» giÃ¡ trá»‹, khÃ´ng Ä‘Æ°á»£c chá»©a cÃ¢u lá»‡nh nhÆ° dt.Rows.Add(...) hay Return dt.


---

ğŸ” NguyÃªn nhÃ¢n

Trong VB.NET thuáº§n, Aggregate cÃ³ thá»ƒ chá»©a nhiá»u lá»‡nh vÃ  return thá»§ cÃ´ng, nhÆ°ng trong UiPath:

Má»—i Assign chá»‰ Ä‘Æ°á»£c phÃ©p chá»©a má»™t biá»ƒu thá»©c tráº£ vá» giÃ¡ trá»‹.

CÃ¡c hÃ m nhÆ° dt.Rows.Add() khÃ´ng tráº£ vá» DataTable â‡’ khÃ´ng thá»ƒ gá»i trong biá»ƒu thá»©c LINQ kiá»ƒu nÃ y.



---

âœ… CÃ¡ch kháº¯c phá»¥c 1: DÃ¹ng For Each thay vÃ¬ Aggregate

ÄÆ¡n giáº£n vÃ  dá»… hiá»ƒu hÆ¡n:

For Each i In Enumerable.Range(0, rowsCount)
    Dim dayCur As DateTime = DateTime.ParseExact(daysListCurrent(i), "yyyyMMdd", CultureInfo.InvariantCulture)
    dtResult.Rows.Add(
        dateWeekend.ToString("yyyy-MM-dd"),
        dayCur.ToString("dddd", CultureInfo.InvariantCulture),
        daysListCurrent(i),
        daysListPrev(i)
    )
Next


---

âœ… CÃ¡ch kháº¯c phá»¥c 2: Viáº¿t LINQ thuáº§n (Assign há»£p lá»‡)

Náº¿u báº¡n muá»‘n Ä‘áº·t trong Assign, pháº£i viáº¿t sao cho toÃ n bá»™ LINQ tráº£ vá» DataTable mÃ  khÃ´ng cÃ³ Add trong biá»ƒu thá»©c.
VÃ­ dá»¥:

dtResult = (
    From i In Enumerable.Range(0, rowsCount)
    Let dayCur = DateTime.ParseExact(daysListCurrent(i), "yyyyMMdd", CultureInfo.InvariantCulture)
    Let row = New Object() {
        dateWeekend.ToString("yyyy-MM-dd"),
        dayCur.ToString("dddd", CultureInfo.InvariantCulture),
        daysListCurrent(i),
        daysListPrev(i)
    }
    Select row
).Aggregate(dtResult, Function(dt, r)
    dt.Rows.Add(r)
    Return dt
End Function)

âš ï¸ Tuy nhiÃªn, UiPath váº«n cÃ³ thá»ƒ lá»—i vÃ¬ dt.Rows.Add(r) lÃ  cÃ¢u lá»‡nh khÃ´ng tráº£ vá» giÃ¡ trá»‹ â€” nÃªn cÃ¡ch nÃ y váº«n khÃ´ng á»•n Ä‘á»‹nh trong Assign.


---

âœ… CÃ¡ch kháº¯c phá»¥c 3 (LINQ + CopyToDataTable)

Náº¿u báº¡n muá»‘n 1 dÃ²ng Assign â€œchuáº©n LINQâ€, hÃ£y táº¡o Enumerable cÃ¡c rows trÆ°á»›c rá»“i chuyá»ƒn thÃ nh DataTable:

dtResult = (
    From i In Enumerable.Range(0, rowsCount)
    Let dayCur = DateTime.ParseExact(daysListCurrent(i), "yyyyMMdd", CultureInfo.InvariantCulture)
    Select New Object() {
        dateWeekend.ToString("yyyy-MM-dd"),
        dayCur.ToString("dddd", CultureInfo.InvariantCulture),
        daysListCurrent(i),
        daysListPrev(i)
    }
).CopyToDataTable()

ğŸ“Œ Äiá»u kiá»‡n: báº¡n Ä‘Ã£ cÃ³ DataTable máº«u (dtResult) Ä‘á»‹nh nghÄ©a sáºµn cá»™t, hoáº·c báº¡n dÃ¹ng Clone() Ä‘á»ƒ nhÃ¢n cáº¥u trÃºc tá»« trÆ°á»›c.


---

ğŸ‘‰ TÃ³m láº¡i, vá»›i UiPath:

Náº¿u báº¡n muá»‘n viáº¿t Assign há»£p lá»‡, dÃ¹ng LINQ thuáº§n tráº£ vá» DataTable (cÃ¡ch 3).

Náº¿u báº¡n chá»‰ cáº§n thÃªm dÃ²ng vÃ o dtResult cÃ³ sáºµn, hÃ£y dÃ¹ng For Each (cÃ¡ch 1).



---

Báº¡n muá»‘n tÃ´i viáº¿t láº¡i toÃ n Ä‘oáº¡n báº±ng cÃº phÃ¡p LINQ Ä‘áº·t Ä‘Æ°á»£c trong Assign UiPath (tá»©c khÃ´ng lá»—i cÃº phÃ¡p)?

