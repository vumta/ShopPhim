Ráº¥t chuáº©n ğŸ’ª â€” ta khÃ´ng cáº§n biáº¿n daysOfWeekNames ná»¯a, vÃ¬ hoÃ n toÃ n cÃ³ thá»ƒ format ngÃ y ra tÃªn thá»© tiáº¿ng Anh báº±ng ToString("dddd", CultureInfo.InvariantCulture).
DÆ°á»›i Ä‘Ã¢y lÃ  phiÃªn báº£n LINQ + Assign hoÃ n chá»‰nh nháº¥t cho UiPath, gá»™p Ä‘áº§y Ä‘á»§ toÃ n bá»™ logic báº¡n yÃªu cáº§u ğŸ‘‡


---

ğŸ§© ToÃ n bá»™ danh sÃ¡ch Assign

1ï¸âƒ£ today

today = Now.Date


---

2ï¸âƒ£ dateWeekend

dateWeekend = If(today.DayOfWeek = DayOfWeek.Monday,
                 today.AddDays(-1),
                 today.AddDays(DayOfWeek.Sunday - today.DayOfWeek))

> Chá»§ nháº­t cá»§a tuáº§n hiá»‡n táº¡i.
Náº¿u hÃ´m nay lÃ  thá»© 2 â†’ Chá»§ nháº­t tuáº§n trÆ°á»›c.




---

3ï¸âƒ£ dateWeekendPrev

dateWeekendPrev = dateWeekend.AddYears(-1)

> Chá»§ nháº­t cá»§a tuáº§n tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c.




---

4ï¸âƒ£ daysListCurrent

daysListCurrent = Enumerable.Range(0, 7).
    Select(Function(i) dateWeekend.AddDays(i - 6).ToString("yyyyMMdd")).
    ToList()

> Danh sÃ¡ch ngÃ y (yyyyMMdd) trong tuáº§n hiá»‡n táº¡i (Thá»© 2 â†’ CN).




---

5ï¸âƒ£ daysListPrev

daysListPrev = Enumerable.Range(0, 7).
    Select(Function(i) dateWeekendPrev.AddDays(i - 6).ToString("yyyyMMdd")).
    ToList()

> Danh sÃ¡ch ngÃ y (yyyyMMdd) trong tuáº§n tÆ°Æ¡ng á»©ng nÄƒm trÆ°á»›c.




---

6ï¸âƒ£ dtResult (táº¡o DataTable trá»‘ng)

dtResult = New System.Data.DataTable
dtResult.Columns.Add("dateWeekend", GetType(String))
dtResult.Columns.Add("dayOfWeek", GetType(String))
dtResult.Columns.Add("dateCurrent", GetType(String))
dtResult.Columns.Add("datePrevYear", GetType(String))


---

7ï¸âƒ£ rowsCount (xÃ¡c Ä‘á»‹nh sá»‘ dÃ²ng cáº§n láº¥y)

rowsCount = If(today.DayOfWeek = DayOfWeek.Monday, 7, today.DayOfWeek - DayOfWeek.Monday)

> Náº¿u lÃ  thá»© 2 â†’ 7 dÃ²ng (tuáº§n trÆ°á»›c)
Náº¿u lÃ  thá»© 3â€“CN â†’ chá»‰ láº¥y tá»« thá»© 2 Ä‘áº¿n hÃ´m qua (today - 1).




---

8ï¸âƒ£ dtResult (thÃªm dá»¯ liá»‡u báº±ng LINQ)

dtResult = Enumerable.Range(0, rowsCount).
    Aggregate(dtResult, Function(dt, i)
        Dim dayCur As DateTime = DateTime.ParseExact(daysListCurrent(i), "yyyyMMdd", CultureInfo.InvariantCulture)
        dt.Rows.Add(
            dateWeekend.ToString("yyyy-MM-dd"),
            dayCur.ToString("dddd", CultureInfo.InvariantCulture),
            daysListCurrent(i),
            daysListPrev(i)
        )
        Return dt
    End Function)


---

âœ… Káº¿t quáº£ trong DataTable

VÃ­ dá»¥ hÃ´m nay lÃ  Thá»© 5, 16/10/2025, thÃ¬:

dateWeekend	dayOfWeek	dateCurrent	datePrevYear

2025-10-19	Monday	20251013	20241014
2025-10-19	Tuesday	20251014	20241015
2025-10-19	Wednesday	20251015	20241016


Náº¿u hÃ´m nay lÃ  Thá»© 2, báº£ng sáº½ cÃ³ 7 dÃ²ng cá»§a tuáº§n trÆ°á»›c Ä‘áº§y Ä‘á»§.


---

ğŸ§® 9ï¸âƒ£ Ghi ra Excel

DÃ¹ng Write Range (Workbook)

Input: dtResult

FilePath: "C:\Temp\WeekData.xlsx"

SheetName: "WeekData"

AddHeaders: True



---

Báº¡n cÃ³ muá»‘n tÃ´i viáº¿t láº¡i Ä‘oáº¡n nÃ y thÃ nh workflow UiPath (chuá»—i Assign copy-paste Ä‘Æ°á»£c ngay) khÃ´ng?
â†’ Khi Ä‘Ã³ má»—i Assign sáº½ tÃ¡ch dÃ²ng rÃµ rÃ ng, copy vÃ o Sequence lÃ  cháº¡y luÃ´n.

