R·∫•t t·ªët ‚Äî b·∫°n mu·ªën d·∫°ng LINQ expression ƒë·ªÉ g√°n tr·ª±c ti·∫øp trong Assign (t·ª©c kh√¥ng c·∫ßn t·∫°o function ri√™ng, m·ªói b∆∞·ªõc ch·ªâ l√† 1 bi·ªÉu th·ª©c thu·∫ßn).
D∆∞·ªõi ƒë√¢y l√† phi√™n b·∫£n thu·∫ßn LINQ + inline VB.NET, t·ªëi ∆∞u ƒë·ªÉ b·∫°n copy v√†o UiPath Assign.


---

üß© 1Ô∏è‚É£ dateWeekend

dateWeekend = If(Now.DayOfWeek = DayOfWeek.Monday,
                 Now.AddDays(-1),
                 Now.AddDays(7 - CInt(Now.DayOfWeek)))

‚û° CN tu·∫ßn tr∆∞·ªõc n·∫øu h√¥m nay l√† Th·ª© 2, ng∆∞·ª£c l·∫°i CN tu·∫ßn hi·ªán t·∫°i.


---

üß© 2Ô∏è‚É£ weekDates

weekDates = If(Now.DayOfWeek = DayOfWeek.Monday,
               Enumerable.Range(0,7).
                   Select(Function(i) dateWeekend.AddDays(-6 + i)).
                   ToList(),
               Enumerable.Range(0, CInt(Now.DayOfWeek) - 1).
                   Select(Function(i) dateWeekend.AddDays(-6 + i)).
                   ToList())

‚û° Tu·∫ßn tr∆∞·ªõc ƒë·ªß 7 ng√†y n·∫øu Th·ª© 2,
ho·∫∑c tu·∫ßn hi·ªán t·∫°i t·ª´ Th·ª© 2 ‚Üí h√¥m qua n·∫øu ‚â• Th·ª© 3.


---

üß© 3Ô∏è‚É£ weekNumCurrent

weekNumCurrent = Globalization.CultureInfo.CurrentCulture.Calendar.GetWeekOfYear(
                    dateWeekend,
                    Globalization.CalendarWeekRule.FirstFourDayWeek,
                    DayOfWeek.Monday)

‚û° Th·ª© t·ª± tu·∫ßn trong nƒÉm hi·ªán t·∫°i (ISO week, b·∫Øt ƒë·∫ßu Th·ª© 2).


---

üß© 4Ô∏è‚É£ dateWeekendPrev

dateWeekendPrev =
    New Date(Now.Year - 1, 1, 1).
        AddDays(
            ((CInt(DayOfWeek.Monday) - CInt(New Date(Now.Year - 1, 1, 1).DayOfWeek) + 7) Mod 7) +  'offset ƒë·∫øn Th·ª© 2 ƒë·∫ßu ti√™n
            ((weekNumCurrent - 1) * 7) + 6) 'C·ªông (weekNum -1)*7 + 6 ƒë·ªÉ ra Ch·ªß nh·∫≠t

‚û° Ch·ªß nh·∫≠t t∆∞∆°ng ·ª©ng c·ªßa tu·∫ßn weekNumCurrent trong nƒÉm tr∆∞·ªõc.


---

üß© 5Ô∏è‚É£ weekDatesPrev

weekDatesPrev = Enumerable.Range(0,7).
                     Select(Function(i) dateWeekendPrev.AddDays(-6 + i)).
                     ToList()

‚û° D√£y ng√†y (Th·ª© 2 ‚Üí CN) c·ªßa tu·∫ßn t∆∞∆°ng ·ª©ng trong nƒÉm tr∆∞·ªõc.


---

‚úÖ T·ªïng k·∫øt

Bi·∫øn	D·∫°ng	√ù nghƒ©a

dateWeekend	Date	CN tu·∫ßn hi·ªán t·∫°i ho·∫∑c tu·∫ßn tr∆∞·ªõc
weekDates	List(Of Date)	D√£y ng√†y c·ªßa tu·∫ßn hi·ªán t·∫°i
weekNumCurrent	Integer	Th·ª© t·ª± tu·∫ßn trong nƒÉm hi·ªán t·∫°i
dateWeekendPrev	Date	CN c·ªßa tu·∫ßn t∆∞∆°ng ·ª©ng nƒÉm tr∆∞·ªõc
weekDatesPrev	List(Of Date)	D√£y ng√†y c·ªßa tu·∫ßn nƒÉm tr∆∞·ªõc



---

B·∫°n c√≥ mu·ªën t√¥i vi·∫øt th√™m 1 Assign cu·ªëi c√πng g·ªôp to√†n b·ªô th√†nh JSON string ki·ªÉu:

{"CurrentWeek":["2025-10-06","2025-10-07",...],"PrevYearWeek":["2024-10-07",...]}

ƒë·ªÉ b·∫°n d·ªÖ xu·∫•t ra log trong UiPath kh√¥ng?

