Ho√†n ch·ªânh ƒë√¢y üëá ‚Äî m√¨nh vi·∫øt l·∫°i to√†n b·ªô n·ªôi dung + ph·∫ßn c√≤n thi·∫øu, theo ƒë√∫ng th·ª© t·ª± Assign trong UiPath ƒë·ªÉ b·∫°n ch·ªâ c·∫ßn copy v√†o l√† ch·∫°y ƒë∆∞·ª£c lu√¥n.
M·ªçi ƒëo·∫°n code ƒë·ªÅu d√πng LINQ-compatible d·∫°ng Assign (kh√¥ng c·∫ßn VB script).


---

üß© TO√ÄN B·ªò LOGIC LINQ + ASSIGN UIPAHT ‚Äî L·∫§Y D·ªÆ LI·ªÜU TU·∫¶N V√Ä GHI RA EXCEL


---

‚úÖ 1Ô∏è‚É£ C√°c bi·∫øn ƒë·∫ßu v√†o / trung gian

Bi·∫øn	Ki·ªÉu d·ªØ li·ªáu	M√¥ t·∫£

today	DateTime	Ng√†y hi·ªán t·∫°i
dateWeekend	DateTime	Ng√†y Ch·ªß nh·∫≠t c·ªßa tu·∫ßn c·∫ßn t√≠nh
weekOfYear	Int32	Th·ª© t·ª± tu·∫ßn trong nƒÉm hi·ªán t·∫°i
dateWeekendPrev	DateTime	Ch·ªß nh·∫≠t c√πng tu·∫ßn c·ªßa nƒÉm tr∆∞·ªõc
daysListPrev	List(Of String)	Danh s√°ch ng√†y (yyyyMMdd) c·ªßa tu·∫ßn nƒÉm tr∆∞·ªõc
daysListCurrent	List(Of String)	Danh s√°ch ng√†y (yyyyMMdd) c·ªßa tu·∫ßn hi·ªán t·∫°i
daysOfWeekNames	List(Of String)	T√™n th·ª© trong tu·∫ßn (English)
dtResult	System.Data.DataTable	B·∫£ng k·∫øt qu·∫£ ƒë·ªÉ ghi ra Excel



---

‚úÖ 2Ô∏è‚É£ T·ª´ng b∆∞·ªõc Assign (copy nguy√™n t·ª´ng d√≤ng v√†o UiPath)


---

(1) today

today = Now.Date


---

(2) dateWeekend

> N·∫øu h√¥m nay l√† Th·ª© 2 ‚Üí Ch·ªß nh·∫≠t tu·∫ßn tr∆∞·ªõc
N·∫øu l√† Th·ª© 3 ‚Üí CN ‚Üí l·∫•y CN tu·∫ßn hi·ªán t·∫°i



dateWeekend = If(
    today.DayOfWeek = DayOfWeek.Monday,
    today.AddDays(-1),
    today.AddDays(DayOfWeek.Sunday - today.DayOfWeek)
)


---

(3) weekOfYear

weekOfYear = Globalization.CultureInfo.InvariantCulture.Calendar.GetWeekOfYear(
    dateWeekend,
    Globalization.CalendarWeekRule.FirstFourDayWeek,
    DayOfWeek.Monday
)


---

(4) dateWeekendPrev

dateWeekendPrev = dateWeekend.AddYears(-1)


---

(5) daysListPrev

daysListPrev = Enumerable.Range(0,7).
    Select(Function(i) dateWeekendPrev.AddDays(-6 + i).ToString("yyyyMMdd")).
    ToList()


---

(6) daysListCurrent

daysListCurrent = Enumerable.Range(0,7).
    Select(Function(i) dateWeekend.AddDays(-6 + i).ToString("yyyyMMdd")).
    ToList()


---

(7) daysOfWeekNames

> T√™n th·ª© trong tu·∫ßn (English): Monday ‚Üí Sunday



daysOfWeekNames = Enumerable.Range(0,7).
    Select(Function(i) dateWeekend.AddDays(-6 + i).ToString("dddd")).
    ToList()


---

‚úÖ 3Ô∏è‚É£ T·∫°o DataTable v√† add d·ªØ li·ªáu


---

(8) T·∫°o DataTable tr·ªëng

dtResult = New System.Data.DataTable


---

(9) Th√™m c√°c c·ªôt

dtResult.Columns.Add("dateWeekend", GetType(String))
dtResult.Columns.Add("dayOfWeek", GetType(String))
dtResult.Columns.Add("dateCurrent", GetType(String))
dtResult.Columns.Add("datePrevYear", GetType(String))


---

(10) Th√™m d√≤ng d·ªØ li·ªáu b·∫±ng LINQ

dtResult = Enumerable.Range(0,7).
    Aggregate(dtResult, Function(dt,i)
        dt.Rows.Add(
            dateWeekend.ToString("yyyy-MM-dd"),
            daysOfWeekNames(i),
            daysListCurrent(i),
            daysListPrev(i)
        )
        Return dt
    End Function)


---

‚úÖ 4Ô∏è‚É£ Ghi ra Excel

D√πng activity Write Range (Workbook)

Thu·ªôc t√≠nh	Gi√° tr·ªã

Input DataTable	dtResult
File Path	"C:\YourPath\WeekDates.xlsx"
Sheet Name	"WeekData"
Add Headers	True



---

üìä K·∫øt qu·∫£ trong Excel

dateWeekend	dayOfWeek	dateCurrent	datePrevYear

2025-10-19	Monday	20251013	20241014
2025-10-19	Tuesday	20251014	20241015
2025-10-19	Wednesday	20251015	20241016
2025-10-19	Thursday	20251016	20241017
2025-10-19	Friday	20251017	20241018
2025-10-19	Saturday	20251018	20241019
2025-10-19	Sunday	20251019	20241020



---

üßÆ T√≥m t·∫Øt nhanh th·ª© t·ª± Assign

STT	Bi·∫øn	Bi·ªÉu th·ª©c ch√≠nh

1	today	Now.Date
2	dateWeekend	If(today.DayOfWeek = DayOfWeek.Monday, today.AddDays(-1), today.AddDays(DayOfWeek.Sunday - today.DayOfWeek))
3	weekOfYear	Globalization.CultureInfo.InvariantCulture.Calendar.GetWeekOfYear(dateWeekend, Globalization.CalendarWeekRule.FirstFourDayWeek, DayOfWeek.Monday)
4	dateWeekendPrev	dateWeekend.AddYears(-1)
5	daysListPrev	Enumerable.Range(0,7).Select(Function(i) dateWeekendPrev.AddDays(-6 + i).ToString("yyyyMMdd")).ToList()
6	daysListCurrent	Enumerable.Range(0,7).Select(Function(i) dateWeekend.AddDays(-6 + i).ToString("yyyyMMdd")).ToList()
7	daysOfWeekNames	Enumerable.Range(0,7).Select(Function(i) dateWeekend.AddDays(-6 + i).ToString("dddd")).ToList()
8	dtResult	New System.Data.DataTable
9	Add columns	dtResult.Columns.Add(...)
10	Add rows	Enumerable.Range(0,7).Aggregate(...Add...)



---

B·∫°n c√≥ mu·ªën m√¨nh th√™m c·ªôt ‚ÄúWeekNumber‚Äù (th·ª© t·ª± tu·∫ßn trong nƒÉm hi·ªán t·∫°i) v√†o DataTable lu√¥n ‚Äî ƒë·ªÉ ti·ªán khi xu·∫•t Excel kh√¥ng?

