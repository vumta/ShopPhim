Trong UiPath, náº¿u báº¡n khÃ´ng xÃ³a hÃ ng váº­t lÃ½ trong Excel mÃ  chá»‰ xÃ³a ná»™i dung (data) thÃ¬ hÃ ng váº«n tá»“n táº¡i, vÃ  báº¡n cáº§n viáº¿t láº¡i data chÃ­nh xÃ¡c vÃ o nhá»¯ng dÃ²ng chÆ°a bá»‹ xÃ³a.

Giáº£ sá»­ báº¡n cÃ³:

10 hÃ ng tá»« dÃ²ng 2 Ä‘áº¿n 11 (dÃ²ng 1 lÃ  tiÃªu Ä‘á»).

Báº¡n xÃ³a data tá»« hÃ ng 4 Ä‘áº¿n 7 (tá»©c dÃ²ng 3 Ä‘áº¿n 6 náº¿u tÃ­nh tá»« index 0).

Báº¡n muá»‘n viáº¿t data chá»‰ vÃ o nhá»¯ng dÃ²ng cÃ²n giá»¯ nguyÃªn ná»™i dung (khÃ´ng bá»‹ xÃ³a).



---

ğŸ”§ HÆ°á»›ng xá»­ lÃ½ trong UiPath

â¶ Äá»c toÃ n bá»™ Excel vÃ o DataTable

DÃ¹ng Read Range Ä‘á»ƒ láº¥y toÃ n bá»™ dá»¯ liá»‡u (bao gá»“m cáº£ dÃ²ng trá»‘ng) vÃ o DataTable dtData.

Read Range - Output: dtData

> Náº¿u dÃ¹ng Excel Application Scope + Read Range (Classic), nhá»› check Preserve Format vÃ  AddHeaders náº¿u cÃ³ tiÃªu Ä‘á».




---

â· Duyá»‡t qua tá»«ng dÃ²ng, kiá»ƒm tra dÃ²ng nÃ o cÃ²n dá»¯ liá»‡u

DÃ¹ng For Each Row Ä‘á»ƒ duyá»‡t tá»«ng dÃ²ng trong dtData. Trong má»—i vÃ²ng láº·p, kiá»ƒm tra dÃ²ng nÃ o cÃ²n dá»¯ liá»‡u thÃ¬ má»›i xá»­ lÃ½ (ghi láº¡i):

For Each row in dtData
  Assign index = dtData.Rows.IndexOf(row) + 2  â† vÃ¬ Excel báº¯t Ä‘áº§u tá»« dÃ²ng 2 náº¿u dÃ²ng 1 lÃ  tiÃªu Ä‘á»
  If Not String.IsNullOrWhiteSpace(row("TÃªnCá»™t1").ToString) OrElse Not String.IsNullOrWhiteSpace(row("TÃªnCá»™t2").ToString)
    â†’ Ghi láº¡i dá»¯ liá»‡u vÃ o dÃ²ng `index`


---

â¸ Ghi láº¡i dá»¯ liá»‡u

DÃ¹ng Write Cell hoáº·c Set Range (vá»›i DataTable cÃ³ 1 dÃ²ng) Ä‘á»ƒ ghi láº¡i Ä‘Ãºng vá»‹ trÃ­:

Write Cell
- Value: "GiÃ¡ trá»‹ má»›i"
- Range: "B" + index.ToString

Hoáº·c dÃ¹ng Write Range náº¿u muá»‘n ghi láº¡i 1 hÃ ng Ä‘áº§y Ä‘á»§:

Assign: dtSingleRow = dtData.Clone
Assign: dtSingleRow.ImportRow(row)
Write Range (Start Cell: "A" + index.ToString, Input: dtSingleRow)


---

âœ… TÃ³m táº¯t

BÆ°á»›c	HÃ nh Ä‘á»™ng

1	DÃ¹ng Read Range láº¥y toÃ n bá»™ dá»¯ liá»‡u
2	Duyá»‡t tá»«ng dÃ²ng, kiá»ƒm tra dÃ²ng nÃ o cÃ²n data
3	Láº¥y Ä‘Ãºng index dÃ²ng (cá»™ng thÃªm 2 náº¿u cÃ³ tiÃªu Ä‘á»)
4	DÃ¹ng Write Cell hoáº·c Write Range Ä‘á»ƒ ghi láº¡i Ä‘Ãºng dÃ²ng



---

Náº¿u báº¡n muá»‘n ghi vÃ o dÃ²ng nÃ o bá»‹ xÃ³a ná»™i dung (trá»‘ng) thÃ¬ lÃ m ngÆ°á»£c láº¡i:

If String.IsNullOrWhiteSpace(row("TÃªnCá»™t1").ToString) AndAlso String.IsNullOrWhiteSpace(row("TÃªnCá»™t2").ToString)

Báº¡n cáº§n mÃ¬nh giÃºp viáº¿t rÃµ tá»«ng activity hay cáº§n logic Ä‘á»ƒ xá»­ lÃ½ theo Ä‘iá»u kiá»‡n cá»¥ thá»ƒ (vÃ­ dá»¥ ghi láº¡i dÃ²ng nÃ o, giá»¯ dÃ²ng nÃ o)?

