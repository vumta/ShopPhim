D∆∞·ªõi ƒë√¢y l√† m·ªôt ƒëo·∫°n VBA ho√†n ch·ªânh, gi√∫p b·∫°n convert b·∫•t k·ª≥ c√¥ng th·ª©c Excel n√†o th√†nh chu·ªói d√πng ƒë∆∞·ª£c trong VBA code (t·ª©c l√† ƒë√£ escape ƒë·∫ßy ƒë·ªß d·∫•u " ƒë·ªÉ d√πng trong .Formula =).


---

‚úÖ Ch·ª©c nƒÉng:

ƒê·ªçc c√¥ng th·ª©c t·ª´ √¥ ƒëang ch·ªçn (ho·∫∑c to√†n b·ªô v√πng ƒë∆∞·ª£c ch·ªçn).

Xu·∫•t ra Immediate Window (Ctrl + G) m·ªôt chu·ªói ƒë√£ escape s·∫µn ƒë·ªÉ b·∫°n copy b·ªè v√†o code VBA.



---

üîß Code VBA:

Sub ConvertFormulaToVBAString()
    Dim cell As Range
    Dim formulaText As String
    Dim vbaFormula As String

    If TypeName(Selection) <> "Range" Then
        MsgBox "Vui l√≤ng ch·ªçn m·ªôt ho·∫∑c nhi·ªÅu √¥ ch·ª©a c√¥ng th·ª©c!", vbExclamation
        Exit Sub
    End If

    For Each cell In Selection
        If cell.HasFormula Then
            formulaText = cell.Formula
            ' Escape d·∫•u " ƒë·ªÉ d√πng trong chu·ªói VBA
            formulaText = Replace(formulaText, """", """""")
            vbaFormula = "Range(""" & cell.Address(False, False) & """).Formula = """ & formulaText & """"
            Debug.Print vbaFormula
        Else
            Debug.Print "√î " & cell.Address(False, False) & " kh√¥ng c√≥ c√¥ng th·ª©c."
        End If
    Next cell

    MsgBox "ƒê√£ xu·∫•t chu·ªói c√¥ng th·ª©c v√†o Immediate Window (Ctrl + G ƒë·ªÉ xem).", vbInformation
End Sub


---

‚úÖ V√≠ d·ª•:

N·∫øu √¥ A1 c√≥ c√¥ng th·ª©c:

=IF(A2="","",A2&B2)

Ch·∫°y macro s·∫Ω in ra trong Immediate:

Range("A1").Formula = "=IF(A2="""","""",A2&B2)"


---

üí° G·ª£i √Ω m·ªü r·ªông:

C√≥ th·ªÉ ch·ªânh ƒë·ªÉ xu·∫•t ra .FormulaLocal n·∫øu b·∫°n d√πng Excel ti·∫øng Vi·ªát.

C√≥ th·ªÉ xu·∫•t ra file .txt n·∫øu b·∫°n mu·ªën l∆∞u h√†ng lo·∫°t c√¥ng th·ª©c.



---

N·∫øu b·∫°n c·∫ßn phi√™n b·∫£n n√¢ng cao h∆°n (xu·∫•t h√†ng lo·∫°t, ghi ra sheet kh√°c, xu·∫•t ra clipboard, ho·∫∑c h·ªó tr·ª£ c√¥ng th·ª©c m·∫£ng), c·ª© n√≥i m√¨nh vi·∫øt th√™m nh√©!

