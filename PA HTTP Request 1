Náº¿u báº¡n tháº¥y `Files = null` trong káº¿t quáº£ tráº£ vá» tá»« SharePoint REST API, cÃ³ má»™t vÃ i nguyÃªn nhÃ¢n thÆ°á»ng gáº·p, vÃ  mÃ¬nh sáº½ hÆ°á»›ng dáº«n cÃ¡ch **xá»­ lÃ½ triá»‡t Ä‘á»ƒ** Ä‘á»ƒ báº¡n luÃ´n láº¥y Ä‘Æ°á»£c danh sÃ¡ch file chÃ­nh xÃ¡c, ká»ƒ cáº£ khi cÃ³ subfolder hoáº·c khÃ´ng cÃ³ file nÃ o.

---

## ğŸ§  **Hiá»ƒu rÃµ váº¥n Ä‘á»: VÃ¬ sao `Files = null`**

### âœ… TrÆ°á»ng há»£p cÃ³ thá»ƒ xáº£y ra:
| TÃ¬nh huá»‘ng                               | Diá»…n giáº£i                                                                 |
|-----------------------------------------|--------------------------------------------------------------------------|
| Folder khÃ´ng chá»©a file nÃ o              | GiÃ¡ trá»‹ `Files` sáº½ lÃ  `null` hoáº·c máº£ng rá»—ng.                             |
| Báº¡n gá»i sai endpoint API                | CÃ³ thá»ƒ `Files` khÃ´ng Ä‘Æ°á»£c expand Ä‘Ãºng nÃªn khÃ´ng cÃ³ trong response.      |
| Báº¡n Ä‘ang láº¥y thÃ´ng tin `Folder`, khÃ´ng pháº£i `Folder/File collection` | CÃ³ thá»ƒ chá»‰ Ä‘ang xem thÃ´ng tin folder chá»© khÃ´ng láº¥y ná»™i dung trong Ä‘Ã³.   |

---

## âœ… **CÃ¡ch kháº¯c phá»¥c dá»©t Ä‘iá»ƒm**

### ğŸ”§ CÃ¡ch gá»i REST API Ä‘Ãºng:

#### DÃ¹ng Ä‘Ãºng endpoint Ä‘á»ƒ Ä‘áº£m báº£o cÃ³ cáº£ `Files` vÃ  `Folders`:
```plaintext
/_api/web/GetFolderByServerRelativeUrl('<serverRelativePath>')?$expand=Folders,Files
```

#### VÃ­ dá»¥:
```plaintext
/_api/web/GetFolderByServerRelativeUrl('/Shared Documents/Reports')?$expand=Folders,Files
```

> KhÃ´ng nÃªn gá»i `/Folders?$expand=Folders,Files` nhÆ° trÆ°á»›c, vÃ¬ nÃ³ chá»‰ liá»‡t kÃª cÃ¡c folder con, **khÃ´ng hiá»ƒn thá»‹ `Files` trá»±c tiáº¿p trong folder cha**.

---

## âœ… **CÃ¡ch xá»­ lÃ½ náº¿u `Files` lÃ  `null`**

Trong Power Automate, khi `Files` lÃ  `null`, báº¡n pháº£i kiá»ƒm tra trÆ°á»›c khi duyá»‡t máº£ng:

### ğŸ‘‡ CÃ¡ch xá»­ lÃ½ an toÃ n trong `Apply to each`:

1. **Sá»­ dá»¥ng `coalesce()`**:
   DÃ²ng nÃ y sáº½ Ä‘áº£m báº£o náº¿u `Files` null thÃ¬ thay báº±ng máº£ng rá»—ng `[]`.

```plaintext
coalesce(body('Parse_JSON')?['Files'], [])
```

2. **DÃ¹ng trong vÃ²ng láº·p Apply to each**:

```plaintext
Apply to each: value = coalesce(body('Parse_JSON')?['Files'], [])
```

â¡ï¸ Äiá»u nÃ y giÃºp báº¡n trÃ¡nh lá»—i khi `Files = null` vÃ  váº«n tiáº¿p tá»¥c flow.

---

## âœ… **CÃ¡ch test nhanh**

ThÃªm má»™t action `Compose` sau khi gá»i API vÃ  gÃ¡n:
```plaintext
body('Send_an_HTTP_request_to_SharePoint')?['Files']
```

Cháº¡y thá»­ vÃ  xem káº¿t quáº£:  
- Náº¿u lÃ  `null`: folder khÃ´ng cÃ³ file nÃ o hoáº·c báº¡n dÃ¹ng sai API.
- Náº¿u lÃ  `[]`: khÃ´ng cÃ³ file nhÆ°ng API Ä‘Ãºng.
- Náº¿u cÃ³ máº£ng: báº¡n cÃ³ thá»ƒ tiáº¿p tá»¥c xá»­ lÃ½ bÃ¬nh thÆ°á»ng.

---

## âœ… **Gá»£i Ã½ má»Ÿ rá»™ng**
Náº¿u báº¡n Ä‘ang duyá»‡t Ä‘á»‡ quy cÃ¡c subfolder:

- Vá»›i má»—i láº§n gá»i API, hÃ£y gá»i Ä‘Ãºng endpoint:
```plaintext
/_api/web/GetFolderByServerRelativeUrl('@{items('Apply_to_each')?['ServerRelativeUrl']}')?$expand=Folders,Files
```

---

## ğŸ“Œ Tá»•ng káº¿t

| Váº¥n Ä‘á»                        | CÃ¡ch xá»­ lÃ½                                 |
|------------------------------|--------------------------------------------|
| `Files = null`               | DÃ¹ng `coalesce()` Ä‘á»ƒ chuyá»ƒn sang máº£ng rá»—ng |
| KhÃ´ng tháº¥y `Files` trong JSON | Kiá»ƒm tra endpoint gá»i API Ä‘Ã£ Ä‘Ãºng chÆ°a     |
| KhÃ´ng cÃ³ file trong folder   | ÄÃ¢y lÃ  bÃ¬nh thÆ°á»ng, khÃ´ng pháº£i lá»—i         |

---

Cáº§n mÃ¬nh táº¡o máº«u flow demo dÃ¹ng `coalesce()` + Ä‘á»‡ quy Ä‘áº§y Ä‘á»§ thÃ¬ mÃ¬nh cÃ³ thá»ƒ hÆ°á»›ng dáº«n báº¡n tiáº¿p nhÃ©. Báº¡n muá»‘n dÃ¹ng trong Cloud Flow hay Power Automate Desktop?
