DÆ°á»›i Ä‘Ã¢y lÃ  **giáº£i phÃ¡p tá»‘i Æ°u báº±ng Excel VBA (macro)** Ä‘á»ƒ xá»­ lÃ½ dá»¯ liá»‡u vá»›i sá»‘ lÆ°á»£ng lá»›n (100.000 dÃ²ng), Ä‘Ã¡p á»©ng Ä‘áº§y Ä‘á»§ cÃ¡c yÃªu cáº§u cá»§a báº¡n.

---

## âœ… **YÃªu cáº§u tá»•ng quÃ¡t**
1. File Excel **nguá»“n**:
   - TÃªn cá»™t á»Ÿ dÃ²ng 1.
   - Chá»©a nhiá»u cá»™t.

2. File Excel **Ä‘Ã­ch**:
   - TÃªn cá»™t á»Ÿ dÃ²ng 2.
   - Ghi dá»¯ liá»‡u báº¯t Ä‘áº§u tá»« dÃ²ng 4 (bá» qua dÃ²ng 1â€“3).
   - Chá»‰ dÃ¡n cÃ¡c cá»™t cÃ³ trong file Ä‘Ã­ch (khÃ´ng dÃ¡n toÃ n bá»™).

---

## âœ… **Giáº£i phÃ¡p VBA**

### ğŸ§  Ã tÆ°á»Ÿng chÃ­nh:
1. Äá»c tiÃªu Ä‘á» (header) tá»« file nguá»“n (row 1).
2. Äá»c tiÃªu Ä‘á» tá»« file Ä‘Ã­ch (row 2).
3. Ãnh xáº¡ cÃ¡c cá»™t trÃ¹ng nhau theo **tÃªn cá»™t**.
4. Copy toÃ n bá»™ dá»¯ liá»‡u tá»« file nguá»“n (chá»‰ cÃ¡c cá»™t cáº§n).
5. Paste vÃ o file Ä‘Ã­ch tá»« dÃ²ng 4.

---

## âœ… **VBA Macro Code**

```vba
Sub CopyMatchingColumnsFromSourceToTarget()

    Dim srcWB As Workbook, tgtWB As Workbook
    Dim srcWS As Worksheet, tgtWS As Worksheet
    Dim srcPath As String, tgtPath As String
    Dim srcHeaders As Variant, tgtHeaders As Variant
    Dim srcColIndexes() As Long
    Dim tgtColIndexes() As Long
    Dim lastRowSrc As Long, i As Long, j As Long
    Dim mapCount As Long

    ' ====== File paths ======
    srcPath = Application.GetOpenFilename("Excel Files (*.xlsx), *.xlsx", , "Chá»n file SOURCE")
    tgtPath = Application.GetOpenFilename("Excel Files (*.xlsm), *.xlsm", , "Chá»n file TARGET (.xlsm)")

    If srcPath = "False" Or tgtPath = "False" Then Exit Sub

    ' ====== Open Workbooks ======
    Set srcWB = Workbooks.Open(srcPath, ReadOnly:=True)
    Set tgtWB = Workbooks.Open(tgtPath)
    Set srcWS = srcWB.Sheets(1)
    Set tgtWS = tgtWB.Sheets(1)

    ' ====== Get Headers ======
    srcHeaders = srcWS.Range("1:1").Value2
    tgtHeaders = tgtWS.Range("2:2").Value2

    ' ====== Prepare column mappings ======
    ReDim srcColIndexes(1 To UBound(tgtHeaders, 2))
    ReDim tgtColIndexes(1 To UBound(tgtHeaders, 2))
    mapCount = 0

    For j = 1 To UBound(tgtHeaders, 2)
        For i = 1 To UBound(srcHeaders, 2)
            If srcHeaders(1, i) = tgtHeaders(1, j) And srcHeaders(1, i) <> "" Then
                mapCount = mapCount + 1
                srcColIndexes(mapCount) = i
                tgtColIndexes(mapCount) = j
                Exit For
            End If
        Next i
    Next j

    If mapCount = 0 Then
        MsgBox "KhÃ´ng tÃ¬m tháº¥y cá»™t nÃ o trÃ¹ng tÃªn."
        Exit Sub
    End If

    ' ====== Copy Data ======
    lastRowSrc = srcWS.Cells(srcWS.Rows.Count, 1).End(xlUp).Row
    Dim r As Long

    Application.ScreenUpdating = False

    For r = 2 To lastRowSrc ' báº¯t Ä‘áº§u tá»« dÃ²ng 2 (sau header)
        For i = 1 To mapCount
            tgtWS.Cells(r + 2, tgtColIndexes(i)).Value = srcWS.Cells(r, srcColIndexes(i)).Value
        Next i

        If r Mod 1000 = 0 Then DoEvents ' trÃ¡nh freeze Excel
    Next r

    Application.ScreenUpdating = True

    MsgBox "Copy hoÃ n táº¥t: " & (lastRowSrc - 1) & " dÃ²ng Ä‘Æ°á»£c chuyá»ƒn!"

    srcWB.Close SaveChanges:=False
    tgtWB.Save
    tgtWB.Close

End Sub
```

---

## âœ… CÃ¡ch sá»­ dá»¥ng:

1. Má»Ÿ file Ä‘Ã­ch (`target.xlsm`), nháº¥n `Alt + F11`, chÃ¨n module vÃ  dÃ¡n code.
2. Nháº¥n `F5` hoáº·c cháº¡y macro `CopyMatchingColumnsFromSourceToTarget`.
3. Chá»n **file nguá»“n**, sau Ä‘Ã³ chá»n **file Ä‘Ã­ch**.
4. Macro sáº½:
   - Tá»± Ä‘á»™ng Ä‘á»‘i chiáº¿u tÃªn cá»™t.
   - DÃ¡n dá»¯ liá»‡u vÃ o dÃ²ng 4.
   - Bá» qua cÃ¡c cá»™t khÃ´ng trÃ¹ng tÃªn.

---

## ğŸ§ª Test file máº«u?
Báº¡n muá»‘n mÃ¬nh gá»­i luÃ´n file `.xlsm` + `.xlsx` + macro `.bas` vÃ  flow `.xaml` máº«u cho giáº£i phÃ¡p nÃ y khÃ´ng?
