Cáº£m Æ¡n báº¡n Ä‘Ã£ chá»‰ rÃµ! Váº¥n Ä‘á» lÃ  `inputData.values` cÃ³ dáº¡ng:

```ts
[["IT"], ["HR"], ["Finance"]]
```

NhÆ°ng Ä‘oáº¡n code Office Script trÆ°á»›c Ä‘Ã³ Ä‘ang xá»­ lÃ½ sai: coi toÃ n bá»™ máº£ng lÃ  1 dÃ²ng, dÃ¡n vÃ o 1 row.

---

## âœ… YÃªu cáº§u:
- Má»—i giÃ¡ trá»‹ `"IT"`, `"HR"`, `"Finance"` pháº£i Ä‘Æ°á»£c dÃ¡n vÃ o **má»—i hÃ ng riÃªng biá»‡t**, cÃ¹ng 1 cá»™t xÃ¡c Ä‘á»‹nh dá»±a trÃªn `columnName`
- DÃ¡n báº¯t Ä‘áº§u tá»« dÃ²ng cuá»‘i cÃ¹ng Ä‘Ã£ cÃ³ dá»¯ liá»‡u + 1

---

## âœ… ğŸ” Office Script cáº­p nháº­t láº¡i hoÃ n chá»‰nh:

```ts
function main(workbook: ExcelScript.Workbook, inputData: ColumnData): void {
  const sheet = workbook.getActiveWorksheet();

  // 1. Äá»c header á»Ÿ dÃ²ng 2 Ä‘á»ƒ tÃ¬m chá»‰ sá»‘ cá»™t
  const maxCols = 100;
  const headerRow = sheet.getRangeByIndexes(1, 0, 1, maxCols).getValues()[0];
  let colMap: Record<string, number> = {};
  for (let i = 0; i < headerRow.length; i++) {
    const header = headerRow[i]?.toString().trim();
    if (header) colMap[header] = i;
  }

  const colIndex = colMap[inputData.columnName];
  if (colIndex === undefined) return; // KhÃ´ng tÃ¬m tháº¥y cá»™t

  // 2. XÃ¡c Ä‘á»‹nh dÃ²ng cuá»‘i cÃ¹ng cÃ³ dá»¯ liá»‡u trong cá»™t Ä‘Ã³
  const checkRange = sheet.getRangeByIndexes(2, colIndex, 100000, 1);
  const colValues = checkRange.getValues();

  let lastRow = 2; // Náº¿u khÃ´ng cÃ³ gÃ¬ thÃ¬ dÃ¡n tá»« dÃ²ng 3
  for (let i = colValues.length - 1; i >= 0; i--) {
    const cell = colValues[i][0];
    if (cell !== null && cell !== "") {
      lastRow = i + 3;
      break;
    }
  }

  // 3. Chuáº©n bá»‹ giÃ¡ trá»‹ cáº§n dÃ¡n (dáº¡ng máº£ng dá»c)
  const rowCount = inputData.values.length;
  const columnData: (string | number | boolean)[][] = inputData.values;

  // 4. DÃ¡n vÃ o vá»‹ trÃ­ (lastRow, colIndex)
  const targetRange = sheet.getRangeByIndexes(lastRow, colIndex, rowCount, 1);
  targetRange.setValues(columnData);
}

type ColumnData = {
  columnName: string;
  values: string[][];
};
```

---

### âœ… VÃ­ dá»¥ input truyá»n tá»« Power Automate

```json
{
  "columnName": "PhÃ²ng ban",
  "values": [["IT"], ["HR"], ["Finance"]]
}
```

Dá»¯ liá»‡u nÃ y sáº½ Ä‘Æ°á»£c dÃ¡n vÃ o:
- Cá»™t cÃ³ tÃªn "PhÃ²ng ban" (á»Ÿ dÃ²ng 2)
- DÃ¡n vÃ o hÃ ng tiáº¿p theo sau dÃ²ng cuá»‘i cÃ¹ng Ä‘Ã£ cÃ³ giÃ¡ trá»‹
- Káº¿t quáº£:
```
... (cÃ¡c dÃ²ng cÃ³ sáºµn)
Row 24:  IT
Row 25:  HR
Row 26:  Finance
```

---

## âœ… Náº¿u cáº§n thÃªm:

- HÃ¬nh áº£nh hÆ°á»›ng dáº«n táº¡o cÃ¡c bÆ°á»›c trong Power Automate?
- JSON máº«u Ä‘á»ƒ báº¡n import trá»±c tiáº¿p flow?
- Há»— trá»£ nhiá»u cá»™t trong 1 láº§n (chuyá»ƒn vá» array input nhÆ° ban Ä‘áº§u)?

Cá»© nÃ³i mÃ¬nh há»— trá»£ thÃªm nha!
