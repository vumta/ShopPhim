Ráº¥t rÃµ ğŸ‘
DÆ°á»›i Ä‘Ã¢y lÃ  ná»™i dung Ä‘áº§y Ä‘á»§ cá»§a file .bas Ä‘á»ƒ báº¡n dÃ¹ng trong UiPath (Invoke VBA).
Má»¥c Ä‘Ã­ch: refresh má»™t Power Query cá»¥ thá»ƒ trong Excel theo tÃªn connection "Query - <TÃªn_Truy_váº¥n>".


---

ğŸ“„ File: RefreshSpecificPowerQuery.bas

Attribute VB_Name = "RefreshSpecificPowerQuery"
Option Explicit

'====================================================
' MODULE: RefreshSpecificPowerQuery
' DÃ¹ng Ä‘á»ƒ refresh Power Query cá»¥ thá»ƒ trong workbook.
' CÃ³ thá»ƒ gá»i tá»« UiPath báº±ng Invoke VBA.
'====================================================

'-----------------------------------------
' Refresh Power Query theo tÃªn truy váº¥n
'-----------------------------------------
Public Sub RefreshSpecificPowerQuery(QueryName As String)
    Dim connName As String
    connName = "Query - " & QueryName
    
    On Error GoTo ErrHandler
    ActiveWorkbook.Connections(connName).Refresh
    Debug.Print "Power Query refreshed successfully: " & connName
    Exit Sub
    
ErrHandler:
    MsgBox "KhÃ´ng tÃ¬m tháº¥y Query cÃ³ tÃªn: " & connName, vbExclamation, "RefreshSpecificPowerQuery"
End Sub


---

âš™ï¸ CÃ¡ch sá»­ dá»¥ng trong UiPath

1. LÆ°u Ä‘oáº¡n code nÃ y vÃ o file:

RefreshSpecificPowerQuery.bas


2. Trong UiPath:

DÃ¹ng activity Invoke VBA

VBA File Path: Ä‘Æ°á»ng dáº«n tá»›i file .bas nÃ y

Entry Method Name:

RefreshSpecificPowerQuery

Parameters:

{"TÃªn_Truy_váº¥n"}

(vÃ­ dá»¥: {"SalesData"})





---

ğŸ§© VÃ­ dá»¥ cháº¡y trá»±c tiáº¿p trong Excel (test nhanh)

Sub TestRefresh()
    RefreshSpecificPowerQuery "SalesData"
End Sub


---

Báº¡n cÃ³ muá»‘n tÃ´i táº¡o sáºµn file .bas Ä‘á»ƒ táº£i vá» ngay khÃ´ng (dáº¡ng hoÃ n chá»‰nh Ä‘á»ƒ dÃ¹ng luÃ´n trong UiPath)?
