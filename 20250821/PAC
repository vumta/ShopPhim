Ã€ ğŸ‘ báº¡n Ä‘ang bá»‹ Ä‘Ãºng trÆ°á»ng há»£p 4:

> XÃ³a file Excel rá»“i upload file má»›i â†’ Power Automate váº«n cache láº¡i metadata cÅ© â†’ Get tables ra trá»‘ng hoáº·c bÃ¡o khÃ´ng cÃ³ table.




---

ğŸ”§ CÃ¡ch xá»­ lÃ½ khi bá»‹ cache

CÃ¡ch 1. KhÃ´ng xÃ³a file â†’ chá»‰ Overwrite (Replace)

TrÃªn SharePoint/OneDrive, náº¿u báº¡n replace file thÃ¬ table metadata sáº½ giá»¯ á»•n hÆ¡n.

Khi Ä‘Ã³ Get tables sáº½ Ä‘á»c Ä‘Æ°á»£c table trong file má»›i.

ÄÃ¢y lÃ  cÃ¡ch Microsoft khuyáº¿n nghá»‹, vÃ¬ má»—i láº§n delete + upload thÃ¬ file cÃ³ fileId má»›i, Flow máº¥t liÃªn káº¿t.



---

CÃ¡ch 2. XÃ³a cache báº±ng cÃ¡ch tham chiáº¿u Custom value thay vÃ¬ chá»n tá»« UI

Khi chá»n file á»Ÿ Get tables hoáº·c List rows, thÆ°á»ng báº¡n báº¥m Browse â†’ nÃ³ lÆ°u ID cá»©ng.

Báº¡n thay báº±ng Custom value vá»›i cÃ´ng thá»©c kiá»ƒu:


/Documents/Reports/MyExcel.xlsx

hoáº·c (náº¿u dÃ¹ng SharePoint):

/sites/TestSite/Shared Documents/Reports/MyExcel.xlsx

â†’ NhÆ° váº­y Flow sáº½ luÃ´n Ä‘á»c file path, khÃ´ng quan tÃ¢m fileId.
Khi báº¡n upload file má»›i (cÃ¹ng tÃªn, cÃ¹ng path), Get tables sáº½ hoáº¡t Ä‘á»™ng.


---

CÃ¡ch 3. Force refresh báº±ng Delay + Get tables láº¡i

CÃ³ lÃºc SharePoint/OneDrive chÆ°a ká»‹p cáº­p nháº­t metadata khi báº¡n vá»«a upload.

Báº¡n cÃ³ thá»ƒ thÃªm action:

1. Upload file


2. Delay 5â€“10 giÃ¢y


3. Get tables â†’ khi Ä‘Ã³ sáº½ tháº¥y table má»›i.





---

CÃ¡ch 4. Äá»c báº£ng theo tÃªn mong muá»‘n

Sau khi Get tables, báº¡n lá»c ra table Ä‘Ãºng tÃªn. VÃ­ dá»¥:


first(
  filter(
    outputs('Get_tables')?['body/value'],
    item()?['name'] eq 'DataTable'
  )
)?['id']

â†’ LuÃ´n láº¥y Ä‘Ãºng table "DataTable" trong file má»›i (dÃ¹ fileId khÃ¡c).


---

ğŸ‘‰ TÃ³m láº¡i, Ä‘á»ƒ xá»­ lÃ½ háº³n tÃ¬nh huá»‘ng xÃ³a & upload file má»›i báº¡n nÃªn káº¿t há»£p:

DÃ¹ng Custom value (path) thay vÃ¬ chá»n file trong UI.

DÃ¹ng Get tables â†’ lá»c theo tÃªn.

Náº¿u cáº§n, thÃªm Delay 5â€“10 giÃ¢y sau upload.



---

Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t cho báº¡n má»™t Ä‘oáº¡n máº«u trong Flow (dÃ¹ng Get tables â†’ lá»c theo tÃªn Table â†’ List rows) Ä‘á»ƒ copy-paste dÃ¹ng luÃ´n khÃ´ng?

