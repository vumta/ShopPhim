Äá»ƒ truyá»n cÃ¡c parameter tá»« UiPath vÃ o Ä‘oáº¡n code VBA, chÃºng ta cáº§n sá»­ dá»¥ng cÃ¡c ká»¹ thuáº­t nhÆ° táº¡o `Public Sub` vÃ  nháº­n tham sá»‘ qua cÃ¡c biáº¿n VBA. DÆ°á»›i Ä‘Ã¢y lÃ  phiÃªn báº£n cáº­p nháº­t cá»§a code VBA Ä‘á»ƒ nháº­n parameter, kÃ¨m hÆ°á»›ng dáº«n chi tiáº¿t tá»«ng bÆ°á»›c.

### Code VBA cáº­p nháº­t vá»›i kháº£ nÄƒng nháº­n parameter
```vba
Public Sub CopyPasteWithParameters(ByVal sourceFilePath As String, ByVal targetFilePath As String, ByVal columnsToCopy As String)
    Dim sourceWorkbook As Workbook
    Dim targetWorkbook As Workbook
    Dim sourceSheet As Worksheet
    Dim targetSheet As Worksheet
    Dim sourceColumns() As String
    Dim targetCol As Integer
    Dim lastRow As Long
    Dim sourceData As Variant
    Dim i As Integer
    
    On Error GoTo ErrorHandler

    ' Má»Ÿ file gá»‘c vÃ  file Ä‘Ã­ch tá»« Ä‘Æ°á»ng dáº«n truyá»n vÃ o
    Set sourceWorkbook = Workbooks.Open(sourceFilePath)
    Set targetWorkbook = Workbooks.Open(targetFilePath)
    
    ' Láº¥y sheet Ä‘áº§u tiÃªn cá»§a file gá»‘c vÃ  sheet thá»© 2 cá»§a file Ä‘Ã­ch
    Set sourceSheet = sourceWorkbook.Sheets(1)
    Set targetSheet = targetWorkbook.Sheets(2)

    ' Chuyá»ƒn cÃ¡c cá»™t tá»« chuá»—i thÃ nh máº£ng
    sourceColumns = Split(columnsToCopy, ",")

    ' Kiá»ƒm tra xem sheet Ä‘Ã­ch cÃ³ Ä‘á»§ dá»¯ liá»‡u trong hÃ ng thá»© 2
    If Application.CountA(targetSheet.Rows(2)) = 0 Then
        MsgBox "HÃ ng thá»© 2 trong sheet Ä‘Ã­ch khÃ´ng cÃ³ dá»¯ liá»‡u! Vui lÃ²ng kiá»ƒm tra láº¡i.", vbCritical
        GoTo CleanUp
    End If

    ' Duyá»‡t qua cÃ¡c cá»™t Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
    For i = LBound(sourceColumns) To UBound(sourceColumns)
        ' TÃ¬m cá»™t Ä‘Ã­ch cÃ³ cÃ¹ng tÃªn trong hÃ ng thá»© 2 cá»§a sheet Ä‘Ã­ch
        On Error Resume Next
        targetCol = 0
        targetCol = Application.Match(sourceColumns(i), targetSheet.Rows(2), 0)
        On Error GoTo 0

        If targetCol > 0 Then
            ' XÃ¡c Ä‘á»‹nh sá»‘ hÃ ng cuá»‘i cÃ¹ng trong cá»™t gá»‘c
            lastRow = sourceSheet.Cells(sourceSheet.Rows.Count, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0)).End(xlUp).Row

            ' Kiá»ƒm tra náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u á»Ÿ cá»™t nguá»“n
            If lastRow < 2 Then
                MsgBox "KhÃ´ng tÃ¬m tháº¥y dá»¯ liá»‡u trong cá»™t " & sourceColumns(i) & " cá»§a file gá»‘c!", vbExclamation
                GoTo CleanUp
            End If

            ' Sao chÃ©p dá»¯ liá»‡u vÃ o máº£ng
            sourceData = sourceSheet.Range(sourceSheet.Cells(2, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0)), _
                                           sourceSheet.Cells(lastRow, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0))).Value

            ' DÃ¡n dá»¯ liá»‡u vÃ o cá»™t Ä‘Ã­ch tá»« hÃ ng thá»© 5
            targetSheet.Range(targetSheet.Cells(5, targetCol), targetSheet.Cells(UBound(sourceData, 1) + 4, targetCol)).Value = sourceData
        Else
            MsgBox "KhÃ´ng tÃ¬m tháº¥y cá»™t Ä‘Ã­ch cho " & sourceColumns(i) & " trong file Ä‘Ã­ch!", vbExclamation
        End If
    Next i

    ' LÆ°u vÃ  Ä‘Ã³ng file
    targetWorkbook.Save
    sourceWorkbook.Close False
    targetWorkbook.Close True

    MsgBox "HoÃ n thÃ nh sao chÃ©p dá»¯ liá»‡u vá»›i sheet thá»© 2 vÃ  hÃ ng thá»© 5 cá»§a Ä‘Ã­ch!", vbInformation
    Exit Sub

ErrorHandler:
    MsgBox "ÄÃ£ xáº£y ra lá»—i trong quÃ¡ trÃ¬nh thá»±c thi: " & Err.Description, vbCritical

CleanUp:
    ' ÄÃ³ng file náº¿u cáº§n thiáº¿t
    If Not sourceWorkbook Is Nothing Then sourceWorkbook.Close False
    If Not targetWorkbook Is Nothing Then targetWorkbook.Close True
End Sub
```

### HÆ°á»›ng dáº«n chi tiáº¿t Ä‘á»ƒ truyá»n parameter tá»« UiPath vÃ o code VBA

#### **1. Chuáº©n bá»‹ file VBA**
- Táº¡o file VBA (`.bas`) chá»©a Ä‘oáº¡n mÃ£ á»Ÿ trÃªn.
- Import file `.bas` nÃ y vÃ o file Excel Ä‘Ã­ch báº±ng cÃ¡ch:
  - Má»Ÿ VBA Editor (Alt + F11).
  - Chá»n `File > Import File` vÃ  chá»n file `.bas`.

#### **2. Táº¡o workflow trong UiPath**
1. **Import file Excel**:
   - Sá»­ dá»¥ng UiPath activity **Excel Application Scope** Ä‘á»ƒ má»Ÿ file Excel nÆ¡i macro Ä‘Ã£ Ä‘Æ°á»£c import.

2. **Truyá»n parameter vÃ o VBA**:
   - Sá»­ dá»¥ng activity **Invoke VBA** cá»§a UiPath:
     - **Macro Name**: Äiá»n tÃªn macro lÃ  `CopyPasteWithParameters`.
     - **Parameters**: Truyá»n cÃ¡c giÃ¡ trá»‹ vÃ o macro. VÃ­ dá»¥:
       - `sourceFilePath`: ÄÆ°á»ng dáº«n tá»›i file gá»‘c.
       - `targetFilePath`: ÄÆ°á»ng dáº«n tá»›i file Ä‘Ã­ch.
       - `columnsToCopy`: TÃªn cÃ¡c cá»™t, phÃ¢n tÃ¡ch báº±ng dáº¥u pháº©y (VD: `"Column1,Column2,Column3"`).

3. **Setup workflow**:
   - KÃ©o tháº£ activity **Invoke VBA** vÃ o trong flow.
   - Äáº£m báº£o Ä‘Æ°á»ng dáº«n file chÃ­nh xÃ¡c vÃ  macro VBA Ä‘Ã£ Ä‘Æ°á»£c import.

#### **3. Kiá»ƒm tra káº¿t quáº£**
- Khi flow cháº¡y, VBA sáº½ nháº­n cÃ¡c parameter tá»« UiPath vÃ  thá»±c hiá»‡n mÃ£ dá»±a trÃªn giÃ¡ trá»‹ Ä‘Æ°á»£c truyá»n vÃ o.
- Kiá»ƒm tra file Ä‘Ã­ch Ä‘á»ƒ xÃ¡c nháº­n dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ Ä‘Ãºng.

### Nhá»¯ng lÆ°u Ã½:
- ÄÆ°á»ng dáº«n file cáº§n pháº£i lÃ  tuyá»‡t Ä‘á»‘i (full path).
- File Excel Ä‘Ã­ch pháº£i chá»©a macro VBA Ä‘Ã£ Ä‘Æ°á»£c import trÆ°á»›c khi UiPath gá»i.
- Náº¿u xáº£y ra lá»—i, kiá»ƒm tra ká»¹ cÃ¡c giÃ¡ trá»‹ Ä‘Æ°á»£c truyá»n vÃ o (parameter).

Náº¿u báº¡n cáº§n há»— trá»£ thÃªm trong viá»‡c tÃ­ch há»£p vá»›i UiPath, tÃ´i luÃ´n sáºµn lÃ²ng giÃºp nhÃ©! ğŸ˜Š
