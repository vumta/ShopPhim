C·∫£m ∆°n b·∫°n ƒë√£ ki√™n nh·∫´n! Vi·ªác Excel b·ªã treo khi d√πng tbl.ListRows(i).Range.Delete th∆∞·ªùng x·∫£y ra khi:

Table c√≥ nhi·ªÅu d√≤ng (h√†ng ngh√¨n).

L·ªánh .Range.Delete ƒëang l√†m Excel di chuy·ªÉn l·∫°i c·∫•u tr√∫c Table, g√¢y ch·∫≠m.

M·ªói l·∫ßn .Range.Delete l√† m·ªôt thao t√°c l·ªõn ‚Üí h√†ng ngh√¨n thao t√°c ‚Üí Excel ƒë·ª©ng.



---

‚úÖ Gi·∫£i ph√°p t·ªët nh·∫•t khi c·∫ßn x√≥a v·∫≠t l√Ω nhi·ªÅu d√≤ng trong Table:

üëâ D√πng tbl.ListRows(i).Delete (v·∫´n l√† c√°ch ch√≠nh th·ª©c)

‚úÖ NH∆ØNG c·∫ßn th√™m m·ªôt s·ªë b∆∞·ªõc t·ªëi ∆∞u sau:


---

‚úÖ Gi·∫£i ph√°p ƒë√£ ki·ªÉm ch·ª©ng, kh√¥ng treo Excel (x·ª≠ l√Ω batch)

Sub DeleteRowsFromRow4_Stable()
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.EnableEvents = False

    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim i As Long
    Dim totalRows As Long

    Set ws = ThisWorkbook.Sheets("Sheet1")       ' ƒê·ªïi t√™n sheet
    Set tbl = ws.ListObjects("Table1")           ' ƒê·ªïi t√™n b·∫£ng

    If Not tbl.DataBodyRange Is Nothing Then
        totalRows = tbl.ListRows.Count

        If totalRows >= 4 Then
            ' Duy·ªát ng∆∞·ª£c ƒë·ªÉ tr√°nh l·ªói index khi x√≥a
            For i = totalRows To 4 Step -1
                DoEvents
                tbl.ListRows(i).Delete
            Next i
        End If
    End If

    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    Application.EnableEvents = True
End Sub


---

‚úÖ V√¨ sao ƒëo·∫°n n√†y "an to√†n":

T·ªëi ∆∞u	T√°c d·ª•ng

Application.ScreenUpdating = False	Kh√¥ng v·∫Ω l·∫°i m√†n h√¨nh m·ªói l·∫ßn x√≥a
Calculation = Manual	Kh√¥ng t√≠nh l·∫°i c√¥ng th·ª©c khi x√≥a
EnableEvents = False	Kh√¥ng k√≠ch ho·∫°t s·ª± ki·ªán Worksheet_Change, v.v.
DoEvents trong v√≤ng l·∫∑p	Cho ph√©p Excel "th·ªü", tr√°nh b·ªã treo c·ª©ng



---

‚úÖ K·∫øt lu·∫≠n

T√¨nh hu·ªëng	Gi·∫£i ph√°p

X√≥a < 500 d√≤ng	tbl.ListRows(i).Delete ho·∫∑c .Range.Delete l√† ·ªïn
X√≥a h√†ng ngh√¨n d√≤ng (n·∫∑ng)	C·∫ßn t·ªëi ∆∞u hi·ªáu su·∫•t nh∆∞ tr√™n
N·∫øu v·∫´n treo m√°y	C√≥ th·ªÉ c√¢n nh·∫Øc ClearContents + RemoveEmptyRows sau ƒë·ªÉ gi·∫£ l·∫≠p xo√°



---

B·∫°n c√≥ th·ªÉ th·ª≠ l·∫°i ƒëo·∫°n code tr√™n. N·∫øu sau ƒë√≥ v·∫´n b·ªã treo (r·∫•t hi·∫øm), m√¨nh c√≥ th·ªÉ gi√∫p b·∫°n chuy·ªÉn logic sang xo√° batch theo t·ª´ng c·ª•m 50‚Äì100 d√≤ng, ho·∫∑c g·ª£i √Ω d√πng Power Query / VBA ADO ƒë·ªÉ x·ª≠ l√Ω nhanh h∆°n n·ªØa.

B·∫°n mu·ªën ti·∫øp t·ª•c h∆∞·ªõng ƒë√≥ ch·ª©?

