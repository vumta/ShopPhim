Cáº£m Æ¡n báº¡n Ä‘Ã£ pháº£n há»“i. Lá»—i Runtime Error 1004 thÆ°á»ng xáº£y ra khi báº¡n dÃ¹ng .EntireRow.Delete trÃªn vÃ¹ng trong báº£ng Excel (ListObject), vÃ¬:

Excel khÃ´ng cho phÃ©p xÃ³a trá»±c tiáº¿p dÃ²ng worksheet náº¿u vÃ¹ng Ä‘Ã³ lÃ  má»™t pháº§n cá»§a Table (ListObject).

tbl.DataBodyRange.Rows(4).Resize(...) tráº£ vá» vÃ¹ng náº±m trong Table â†’ .EntireRow.Delete sáº½ gÃ¢y lá»—i.



---

âœ… Giáº£i phÃ¡p sá»­a lá»—i: Chá»‰ dÃ¹ng .Delete trá»±c tiáº¿p trÃªn ListRows(i) hoáº·c .Delete toÃ n dÃ²ng trong báº£ng thÃ´ng qua .ListRows(i).Range.Delete

MÃ¬nh sáº½ cung cáº¥p 2 cÃ¡ch sá»­a chuáº©n, an toÃ n, nhanh hÆ¡n vÃ  khÃ´ng bá»‹ lá»—i:


---

âœ… CÃ¡ch 1 (sá»­a): DÃ¹ng .Range.Delete thay vÃ¬ .EntireRow.Delete

Sub DeleteFromFourthRow_UsingRangeDelete()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim totalRows As Long
    Dim i As Long

    Set ws = ThisWorkbook.Sheets("Sheet1")
    Set tbl = ws.ListObjects("Table1")

    If Not tbl.DataBodyRange Is Nothing Then
        totalRows = tbl.DataBodyRange.Rows.Count

        If totalRows >= 4 Then
            For i = totalRows To 4 Step -1
                tbl.ListRows(i).Range.Delete
            Next i
        End If
    End If
End Sub

ğŸ”¹ KhÃ¡c biá»‡t:

Thay vÃ¬ tbl.ListRows(i).Delete â†’ dÃ¹ng tbl.ListRows(i).Range.Delete

Nhanh hÆ¡n, khÃ´ng gÃ¢y lá»—i treo nhÆ° .ListRows(i).Delete



---

âœ… CÃ¡ch 2 (tá»‘t nháº¥t): DÃ¹ng .Resize Ä‘á»ƒ ClearContents thay vÃ¬ .Delete

Náº¿u báº¡n chá»‰ muá»‘n xoÃ¡ ná»™i dung dÃ²ng (khÃ´ng cáº§n xoÃ¡ váº­t lÃ½ dÃ²ng) Ä‘á»ƒ giá»¯ Ä‘á»‹nh dáº¡ng báº£ng:

Sub ClearContentsFromFourthRowInTable()
    Dim ws As Worksheet
    Dim tbl As ListObject
    Dim totalRows As Long
    Dim rowsToClear As Long

    Set ws = ThisWorkbook.Sheets("Sheet1")
    Set tbl = ws.ListObjects("Table1")

    If Not tbl.DataBodyRange Is Nothing Then
        totalRows = tbl.DataBodyRange.Rows.Count

        If totalRows >= 4 Then
            rowsToClear = totalRows - 3
            tbl.DataBodyRange.Rows(4).Resize(rowsToClear).ClearContents
        End If
    End If
End Sub

ğŸ”¹ Æ¯u Ä‘iá»ƒm:

KhÃ´ng lá»—i 1004

Giá»¯ nguyÃªn cáº¥u trÃºc báº£ng (váº«n cÃ³ Ä‘á»§ dÃ²ng, format, dropdown, v.v.)

Ráº¥t nhanh, phÃ¹ há»£p báº£ng lá»›n



---

âœ… Káº¿t luáº­n

Má»¥c tiÃªu	Giáº£i phÃ¡p tá»‘t nháº¥t

XoÃ¡ dÃ²ng váº­t lÃ½ khá»i báº£ng	DÃ¹ng tbl.ListRows(i).Range.Delete tá»« dÆ°á»›i lÃªn
XoÃ¡ ná»™i dung, giá»¯ dÃ²ng báº£ng	DÃ¹ng tbl.DataBodyRange.Rows(4).Resize(...).ClearContents


Báº¡n cáº§n xÃ³a váº­t lÃ½ hay chá»‰ cáº§n xoÃ¡ ná»™i dung? Cho mÃ¬nh biáº¿t thÃªm Ä‘á»ƒ tá»‘i Æ°u phÃ¹ há»£p nháº¥t nhÃ©.

