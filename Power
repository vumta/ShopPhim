DÆ°á»›i Ä‘Ã¢y lÃ  hÆ°á»›ng dáº«n **chi tiáº¿t tá»«ng bÆ°á»›c** Ä‘á»ƒ **GET FILES TRONG THÆ¯ Má»¤C SHAREPOINT** báº±ng **Power Automate**:

---

## ğŸ¯ Má»¥c tiÃªu:
Láº¥y danh sÃ¡ch **táº¥t cáº£ file** trong má»™t thÆ° má»¥c cá»¥ thá»ƒ trong SharePoint, vÃ­ dá»¥:  
`https://contoso.sharepoint.com/sites/TestSite/Shared Documents/Reports`

---

## ğŸ§© BÆ°á»›c-by-BÆ°á»›c Trong Power Automate

---

### ğŸ”¹ BÆ°á»›c 1: Táº¡o má»™t Flow má»›i

- VÃ o [Power Automate Portal](https://make.powerautomate.com/)
- Chá»n **Create** â†’ **Instant cloud flow**
- Äáº·t tÃªn: `GetFilesInFolder`
- Chá»n trigger: `Manually trigger a flow` hoáº·c `When an HTTP request is received` náº¿u muá»‘n gá»i tá»« UiPath

---

### ğŸ”¹ BÆ°á»›c 2: ThÃªm action `Get files (properties only)`

TÃ¬m: **Get files (properties only)** â†’ Chá»n loáº¡i káº¿t ná»‘i lÃ  SharePoint

#### Thiáº¿t láº­p nhÆ° sau:

- **Site Address**:  
  `https://contoso.sharepoint.com/sites/TestSite`

- **Library Name**:  
  `Documents` (thÆ° viá»‡n gá»‘c cá»§a SharePoint)

- **Folder**:  
  `Reports` *(hoáº·c `"Shared Documents/Reports"` náº¿u dÃ¹ng Ä‘Æ°á»ng dáº«n Ä‘áº§y Ä‘á»§)*

> ğŸ’¡ Náº¿u báº¡n khÃ´ng tháº¥y folder trong dropdown â†’ cÃ³ thá»ƒ gÃµ tay vÃ o Ä‘Æ°á»ng dáº«n tÆ°Æ¡ng Ä‘á»‘i.

---

### ğŸ”¹ BÆ°á»›c 3: ThÃªm â€œApply to eachâ€ (náº¿u cáº§n xá»­ lÃ½ tá»«ng file)

- **Input**:  
  `value` (output cá»§a bÆ°á»›c â€œGet filesâ€)

BÃªn trong, báº¡n cÃ³ thá»ƒ:
- Truy cáº­p `item()?['Name']` â†’ tÃªn file  
- `item()?['ServerRelativeUrl']` â†’ Ä‘Æ°á»ng dáº«n ná»™i bá»™  
- `item()?['FileRef']`, `item()?['Id']`, `item()?['Modified']`, v.v.

---

### ğŸ”¹ (Tuá»³ chá»n) BÆ°á»›c 4: Tráº£ vá» káº¿t quáº£ JSON (náº¿u gá»i tá»« UiPath)

- Táº¡o **biáº¿n máº£ng** (`Initialize variable` â†’ type = Array)
- Trong vÃ²ng `Apply to each`, dÃ¹ng `Append to array variable` Ä‘á»ƒ thÃªm tá»«ng file:

```json
{
  "Name": "@{items('Apply_to_each')?['Name']}",
  "Url": "@{items('Apply_to_each')?['FileRef']}"
}
```

- Sau `Apply to each`, dÃ¹ng `Response` action Ä‘á»ƒ tráº£ vá» máº£ng JSON Ä‘Ã³

---

## ğŸ§ª VÃ­ dá»¥ output JSON:

```json
[
  {
    "Name": "Report1.xlsx",
    "Url": "/sites/TestSite/Shared Documents/Reports/Report1.xlsx"
  },
  {
    "Name": "Report2.xlsx",
    "Url": "/sites/TestSite/Shared Documents/Reports/Report2.xlsx"
  }
]
```

---

## âœ… Xong rá»“i!

Giá» báº¡n cÃ³ thá»ƒ:
- Gá»i flow tá»« UiPath (báº±ng HTTP POST)
- Hoáº·c dÃ¹ng flow Ä‘á»ƒ xá»­ lÃ½ file tiáº¿p theo (di chuyá»ƒn, táº£i vá», Ä‘á»•i tÃªn...)

---

ğŸ“Œ **Báº¡n cÃ³ cáº§n mÃ¬nh gá»­i máº«u Flow (JSON export)** hoáº·c `.xaml` máº«u gá»i tá»« UiPath khÃ´ng?  
Chá»‰ cáº§n nÃ³i **"CÃ³"**, mÃ¬nh sáº½ gá»­i ngay!
