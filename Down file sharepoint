Tuyá»‡t vá»i, Ä‘á»ƒ táº£i toÃ n bá»™ folder tá»« **SharePoint** vá» mÃ¡y tÃ­nh **local** báº±ng **UiPath**, báº¡n cÃ³ thá»ƒ thá»±c hiá»‡n theo 2 cÃ¡ch chÃ­nh:

---

### ğŸ…°ï¸ CÃ¡ch 1: Sá»­ dá»¥ng **UiPath Microsoft365 Activities (Graph API)**
ÄÃ¢y lÃ  cÃ¡ch chuáº©n, sá»­ dá»¥ng **Microsoft 365 Scope** Ä‘á»ƒ truy cáº­p SharePoint.

---

#### âœ… YÃªu cáº§u chuáº©n bá»‹:

1. **TÃ i khoáº£n Office 365** cÃ³ quyá»n truy cáº­p thÆ° má»¥c SharePoint.
2. **ÄÄƒng kÃ½ á»©ng dá»¥ng Azure AD (App Registration)** (náº¿u báº¡n khÃ´ng dÃ¹ng account cá»§a UiPath Apps).
3. CÃ i package:
   - `UiPath.MicrosoftOffice365.Activities`

---

### ğŸ§­ Step-by-step:

#### ğŸ”¹ BÆ°á»›c 1: CÃ i Package
- Má»Ÿ **Manage Packages** trong UiPath Studio.
- CÃ i: `UiPath.MicrosoftOffice365.Activities`

---

#### ğŸ”¹ BÆ°á»›c 2: Thiáº¿t láº­p Microsoft 365 Scope

- KÃ©o **Microsoft365 Scope** vÃ o flow.
- Äiá»n cÃ¡c thÃ´ng tin:
  - **Application ID**, **Tenant ID**, **Client Secret** (tá»« Azure AD).
  - **Services**: chá»n `SharePoint`, `Files`, `Sites`.

---

#### ğŸ”¹ BÆ°á»›c 3: DÃ¹ng â€œFind Files and Foldersâ€ Ä‘á»ƒ láº¥y danh sÃ¡ch file trong folder

- KÃ©o activity **Find Files and Folders**.
- Set `Parent Folder`: `"Shared Documents/TenFolderCuaBan"`  
  (Ä‘Æ°á»ng dáº«n tÃ­nh tá»« gá»‘c Document Library)
- Output: `sharepointFiles` (List of DriveItem)

---

#### ğŸ”¹ BÆ°á»›c 4: DÃ¹ng â€œDownload Fileâ€ Ä‘á»ƒ táº£i tá»«ng file

- DÃ¹ng For Each: `For Each file In sharepointFiles`
- BÃªn trong:
  - **Download File**
    - DriveItem: `file`
    - LocalPath: `"C:\DuongDanLocal\" + file.Name`

---

### ğŸ…±ï¸ CÃ¡ch 2: Sá»­ dá»¥ng giao diá»‡n web SharePoint + UiPath UI Automation (Ã­t khuyáº¿n khÃ­ch)

Náº¿u khÃ´ng dÃ¹ng Ä‘Æ°á»£c API thÃ¬ cÃ³ thá»ƒ:

---

#### ğŸ§­ Step-by-step:

1. Má»Ÿ Chrome/Edge vÃ  Ä‘Äƒng nháº­p vÃ o SharePoint Ä‘áº¿n Ä‘Ãºng folder báº¡n cáº§n táº£i.
2. DÃ¹ng UiPath:
   - **Open Browser**: má»Ÿ Ä‘Æ°á»ng dáº«n SharePoint folder.
   - **Click** vÃ o nÃºt `Download` hoáº·c chá»n `Sync` (náº¿u cÃ³).
   - Hoáº·c: Select all â†’ Click Download â†’ Táº£i `.zip`
3. DÃ¹ng `Wait for Download` + `Move File` Ä‘á»ƒ chuyá»ƒn file zip vá» folder Ä‘Ã­ch.
4. DÃ¹ng activity `Unzip Files` Ä‘á»ƒ giáº£i nÃ©n vá» thÆ° má»¥c local.

---

### ğŸ§  Máº¹o:

- Náº¿u folder SharePoint lá»›n vÃ  báº¡n cÃ³ quyá»n truy cáº­p tá»‘t, Æ°u tiÃªn dÃ¹ng **Graph API** (CÃ¡ch 1) â†’ cháº¡y nhanh, á»•n Ä‘á»‹nh, dá»… xá»­ lÃ½ lá»—i.
- Náº¿u dÃ¹ng cÃ¡ch UI Automation (CÃ¡ch 2), hÃ£y Ä‘áº£m báº£o Ä‘á»™ á»•n Ä‘á»‹nh cá»§a UI (sá»­ dá»¥ng `Retry Scope`, `Element Exists`).

---

Báº¡n Ä‘ang cÃ³ app Azure AD sáºµn chÆ°a? Náº¿u chÆ°a mÃ¬nh cÃ³ thá»ƒ hÆ°á»›ng dáº«n táº¡o 1 cÃ¡i ráº¥t nhanh.
