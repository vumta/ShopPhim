Cáº£m Æ¡n báº¡n Ä‘Ã£ cáº­p nháº­t â€” dÆ°á»›i Ä‘Ã¢y lÃ  phiÃªn báº£n **VBA Macro cáº­p nháº­t Ä‘á»ƒ xá»­ lÃ½ cáº£ file nguá»“n vÃ  Ä‘Ã­ch Ä‘á»u lÃ  `.xlsx`** (khÃ´ng dÃ¹ng `.xlsm`), vÃ  váº«n Ä‘áº£m báº£o:

- Truyá»n vÃ o:
  - TÃªn Sheet Ä‘Ã­ch.
  - Danh sÃ¡ch tÃªn cá»™t cáº§n copy tá»« nguá»“n.
- Header:
  - Nguá»“n: náº±m á»Ÿ **dÃ²ng 1**.
  - ÄÃ­ch: náº±m á»Ÿ **dÃ²ng 2**.
- Dá»¯ liá»‡u:
  - Nguá»“n: báº¯t Ä‘áº§u tá»« **dÃ²ng 3**.
  - DÃ¡n vÃ o file Ä‘Ã­ch tá»« **dÃ²ng 5**.

---

### âœ… VBA Macro hoÃ n chá»‰nh (cho `.xlsx`):

```vb
Sub CopyColumnsBetweenXlsx()

    Dim srcWB As Workbook, tgtWB As Workbook
    Dim srcWS As Worksheet, tgtWS As Worksheet
    Dim srcHeaders As Variant, tgtHeaders As Variant
    Dim copyColumns As Variant
    Dim srcColIndexes() As Long
    Dim tgtColIndexes() As Long
    Dim srcPath As String, tgtPath As String
    Dim i As Long, j As Long, r As Long
    Dim mapCount As Long
    Dim tgtSheetName As String

    ' === Cáº¤U HÃŒNH ===
    tgtSheetName = InputBox("Nháº­p tÃªn Sheet trong file Ä‘Ã­ch:", "TÃªn Sheet", "Sheet1")
    copyColumns = Array("TÃªn KH", "Email", "Sá»‘ Ä‘iá»‡n thoáº¡i")

    ' === CHá»ŒN FILE NGUá»’N & ÄÃCH (.xlsx) ===
    srcPath = Application.GetOpenFilename("Excel Files (*.xlsx), *.xlsx", , "Chá»n file NGUá»’N")
    tgtPath = Application.GetOpenFilename("Excel Files (*.xlsx), *.xlsx", , "Chá»n file ÄÃCH")

    If srcPath = "False" Or tgtPath = "False" Then Exit Sub

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Set srcWB = Workbooks.Open(srcPath, ReadOnly:=True)
    Set tgtWB = Workbooks.Open(tgtPath)
    Set srcWS = srcWB.Sheets(1)
    Set tgtWS = tgtWB.Sheets(tgtSheetName)

    ' === HEADER ===
    srcHeaders = srcWS.Range("1:1").Value2
    tgtHeaders = tgtWS.Range("2:2").Value2

    ReDim srcColIndexes(0 To UBound(copyColumns))
    ReDim tgtColIndexes(0 To UBound(copyColumns))

    ' === MAPPING Cá»˜T ===
    For i = 0 To UBound(copyColumns)
        For j = 1 To UBound(srcHeaders, 2)
            If srcHeaders(1, j) = copyColumns(i) Then
                srcColIndexes(i) = j
                Exit For
            End If
        Next j
        For j = 1 To UBound(tgtHeaders, 2)
            If tgtHeaders(1, j) = copyColumns(i) Then
                tgtColIndexes(i) = j
                mapCount = mapCount + 1
                Exit For
            End If
        Next j
    Next i

    If mapCount = 0 Then
        MsgBox "KhÃ´ng tÃ¬m tháº¥y cá»™t nÃ o khá»›p giá»¯a nguá»“n vÃ  Ä‘Ã­ch."
        GoTo Cleanup
    End If

    ' === DÃN Dá»® LIá»†U Tá»ª DÃ’NG 3 NGUá»’N â†’ DÃ’NG 5 ÄÃCH ===
    Dim lastRowSrc As Long
    lastRowSrc = srcWS.Cells(srcWS.Rows.Count, 1).End(xlUp).Row

    For r = 3 To lastRowSrc
        For i = 0 To UBound(copyColumns)
            If srcColIndexes(i) > 0 And tgtColIndexes(i) > 0 Then
                tgtWS.Cells(r + 2, tgtColIndexes(i)).Value = srcWS.Cells(r, srcColIndexes(i)).Value
            End If
        Next i
        If r Mod 1000 = 0 Then DoEvents
    Next r

    MsgBox "Copy xong " & (lastRowSrc - 2) & " dÃ²ng dá»¯ liá»‡u!", vbInformation

Cleanup:
    srcWB.Close SaveChanges:=False
    tgtWB.Save
    tgtWB.Close
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

End Sub
```

---

### ğŸ“Œ CÃ¡ch sá»­ dá»¥ng:

1. **Má»Ÿ má»™t file Excel má»›i**.
2. Nháº¥n `Alt + F11` Ä‘á»ƒ má»Ÿ Visual Basic Editor.
3. Chá»n `Insert > Module`, dÃ¡n Ä‘oáº¡n macro trÃªn vÃ o.
4. Nháº¥n `F5` Ä‘á»ƒ cháº¡y macro.
5. Láº§n lÆ°á»£t chá»n file `.xlsx` nguá»“n vÃ  Ä‘Ã­ch.
6. Nháº­p tÃªn Sheet Ä‘Ã­ch (vÃ­ dá»¥: `Sheet1`).

---

### âœ… Báº¡n cÃ³ muá»‘n mÃ¬nh táº¡o láº¡i:

- File máº«u `source.xlsx`, `destination.xlsx`, vÃ 
- Macro `.bas` Ä‘Ã£ export sáºµn?
- Flow UiPath `.xaml` gá»i macro (qua Excel Application Scope)?

MÃ¬nh cÃ³ thá»ƒ nÃ©n táº¥t cáº£ vÃ o `.zip` gá»­i báº¡n trong 1 click. Báº¡n muá»‘n khÃ´ng?
