Chu·∫©n r·ªìi üëç m√¨nh s·∫Ω vi·∫øt h∆∞·ªõng d·∫´n chi ti·∫øt ƒë·ªÉ b·∫°n copy-paste th·∫≥ng v√†o UiPath Invoke Code.


---

üîπ B∆∞·ªõc 1: Chu·∫©n b·ªã bi·∫øn trong UiPath

B·∫°n c·∫ßn 2 bi·∫øn (arguments):

csvPath (In, String) ‚Üí ƒë∆∞·ªùng d·∫´n t·ªõi file CSV (v√≠ d·ª•: "C:\Data\input.csv")

txtPath (In, String) ‚Üí ƒë∆∞·ªùng d·∫´n mu·ªën l∆∞u TXT (v√≠ d·ª•: "C:\Data\output.txt")



---

üîπ B∆∞·ªõc 2: Th√™m Activity Invoke Code

Language: VB.NET

Arguments:

Direction	Name	Type

In	csvPath	String
In	txtPath	String




---

üîπ B∆∞·ªõc 3: D√°n code n√†y v√†o Invoke Code

Imports System.IO
Imports System.Text

' === Convert CSV -> TXT (tab-delimited, UTF-8 no BOM) ===
Sub Main()
    ' Ki·ªÉm tra file CSV t·ªìn t·∫°i
    If Not File.Exists(csvPath) Then
        Throw New FileNotFoundException("Kh√¥ng t√¨m th·∫•y file CSV: " & csvPath)
    End If

    ' C√°c encoding ph·ªï bi·∫øn (UTF-8, UTF-16, Shift-JIS, GB2312, EUC-KR)
    Dim encodings As Encoding() = {
        Encoding.UTF8,
        Encoding.Unicode,            ' UTF-16 LE
        Encoding.BigEndianUnicode,   ' UTF-16 BE
        Encoding.GetEncoding("shift_jis"),
        Encoding.GetEncoding("gb2312"),
        Encoding.GetEncoding("euc-kr")
    }

    ' C√°c delimiter ph·ªï bi·∫øn
    Dim delimiters As Char() = {","c, ";"c, vbTab, "|"c}
    Dim bestDelimiter As Char = ","c

    Dim chosenEncoding As Encoding = Encoding.UTF8
    Dim maxColumns As Integer = 0

    ' Th·ª≠ t·ª´ng encoding ƒë·ªÉ detect delimiter t·ªët nh·∫•t
    For Each enc As Encoding In encodings
        Try
            Using sr As New StreamReader(csvPath, enc, True)
                Dim firstLine As String = sr.ReadLine()
                If Not String.IsNullOrEmpty(firstLine) Then
                    For Each d As Char In delimiters
                        Dim colCount As Integer = firstLine.Split(d).Length
                        If colCount > maxColumns Then
                            maxColumns = colCount
                            bestDelimiter = d
                            chosenEncoding = enc
                        End If
                    Next
                End If
            End Using
        Catch ex As Exception
            ' N·∫øu encoding n√†y kh√¥ng h·ª£p l·ªá th√¨ b·ªè qua
        End Try
    Next

    ' Writer v·ªõi UTF-8 kh√¥ng BOM
    Dim utf8NoBOM As New UTF8Encoding(False)

    ' ƒê·ªçc to√†n b·ªô CSV v·ªõi encoding detect ƒë∆∞·ª£c v√† ghi TXT tab-delimited
    Using reader As New StreamReader(csvPath, chosenEncoding, True)
        Using writer As New StreamWriter(txtPath, False, utf8NoBOM)
            Dim line As String
            Do While Not reader.EndOfStream
                line = reader.ReadLine()
                Dim columns() As String = line.Split(bestDelimiter)
                writer.WriteLine(String.Join(vbTab, columns))
            Loop
        End Using
    End Using
End Sub


---

üîπ B∆∞·ªõc 4: Ch·∫°y th·ª≠

Khi ch·∫°y, file output.txt s·∫Ω c√≥ d·ªØ li·ªáu tab-delimited, encoding chu·∫©n UTF-8 kh√¥ng BOM.

C√≥ th·ªÉ m·ªü trong Notepad, Excel, VS Code m√† kh√¥ng lo l·ªói k√Ω t·ª± ti·∫øng Nh·∫≠t/Trung/H√†n.



---

üëâ B·∫°n mu·ªën m√¨nh vi·∫øt th√™m m·ªôt ƒëo·∫°n test nh·ªè (t·∫°o file CSV m·∫´u b·∫±ng ti·∫øng Nh·∫≠t/Trung/H√†n) ƒë·ªÉ b·∫°n th·ª≠ tr·ª±c ti·∫øp lu√¥n kh√¥ng?

