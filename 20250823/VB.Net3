MÃ¬nh viáº¿t láº¡i code VB.NET hoÃ n chá»‰nh, phÃ¹ há»£p Ä‘á»ƒ cháº¡y trong UiPath Invoke Code, Ä‘Ã£ fix cÃ¡c lá»—i báº¡n gáº·p (import, String â†’ Char(), BOM, xá»­ lÃ½ file). Báº¡n chá»‰ cáº§n copy dÃ¡n tháº³ng vÃ o Invoke Code trong UiPath, khÃ´ng cáº§n Import thá»§ cÃ´ng.

'=== Fix BOM UTF-8 trong file text ===
' Tham sá»‘ In:
'   filePath As String  (Ä‘Æ°á»ng dáº«n file)
' Tham sá»‘ Out:
'   fixedText As String (ná»™i dung file sau khi fix BOM)

Dim bytes As Byte() = System.IO.File.ReadAllBytes(filePath)

' Kiá»ƒm tra BOM UTF-8 (EF BB BF)
If bytes.Length >= 3 AndAlso bytes(0) = &HEF AndAlso bytes(1) = &HBB AndAlso bytes(2) = &HBF Then
    ' Bá» BOM: láº¥y dá»¯ liá»‡u tá»« byte thá»© 4
    bytes = bytes.Skip(3).ToArray()
End If

' Chuyá»ƒn byte â†’ String (UTF-8)
fixedText = System.Text.Encoding.UTF8.GetString(bytes)


---

âœ… CÃ¡ch dÃ¹ng trong UiPath

Invoke Code:

Language: VB.NET

Arguments:

filePath (In, String) â†’ Ä‘Æ°á»ng dáº«n file cáº§n xá»­ lÃ½.

fixedText (Out, String) â†’ nháº­n ná»™i dung sau khi fix BOM.




VÃ­ dá»¥:

filePath = "C:\Users\AnhVu\Documents\input.txt"

Sau khi cháº¡y xong, báº¡n cÃ³ thá»ƒ dÃ¹ng biáº¿n fixedText trong UiPath Ä‘á»ƒ tiáº¿p tá»¥c xá»­ lÃ½ (ghi vÃ o file khÃ¡c, log, hoáº·c Ä‘á»c theo dÃ²ng).


---

ğŸ‘‰ Báº¡n muá»‘n mÃ¬nh viáº¿t thÃªm Ä‘oáº¡n ghi Ä‘Ã¨ láº¡i file gá»‘c sau khi loáº¡i BOM luÃ´n, hay chá»‰ cáº§n tráº£ ra biáº¿n fixedText thÃ´i?

