Tuyá»‡t vá»i, váº­y tÃ³m láº¡i yÃªu cáº§u cá»§a báº¡n lÃ :

> Truyá»n 10 cÃ´ng thá»©c tÆ°Æ¡ng á»©ng vá»›i cá»™t C â†’ K (tá»©c cá»™t 3 â†’ 11) tá»« UiPath vÃ o VBA.
VBA sáº½:

TÃ¬m dÃ²ng cuá»‘i cÃ¹ng cÃ³ dá»¯ liá»‡u á»Ÿ cá»™t A hoáº·c B (lÃ  dá»¯ liá»‡u vá»«a Ä‘Æ°á»£c ghi tá»« UiPath),

DÃ¡n cÃ´ng thá»©c vÃ o cÃ¡c cá»™t C Ä‘áº¿n K, tá»« dÃ²ng 4 Ä‘áº¿n dÃ²ng cuá»‘i.





---

âœ… MÃ£ VBA phÃ¹ há»£p vá»›i yÃªu cáº§u:

Sub ApplyFormulasFromUiPath(ParamArray formulas() As Variant)
    Dim ws As Worksheet
    Dim lastRowA As Long, lastRowB As Long, lastRow As Long
    Dim i As Long
    Dim startCol As Long

    Set ws = ThisWorkbook.Sheets(1) ' Hoáº·c Ä‘á»•i tÃªn Sheet náº¿u cáº§n
    startCol = 3 ' Cá»™t C lÃ  cá»™t 3

    ' XÃ¡c Ä‘á»‹nh dÃ²ng cuá»‘i á»Ÿ cá»™t A vÃ  B
    lastRowA = ws.Cells(ws.Rows.Count, "A").End(xlUp).Row
    lastRowB = ws.Cells(ws.Rows.Count, "B").End(xlUp).Row
    lastRow = Application.WorksheetFunction.Max(lastRowA, lastRowB)

    ' Náº¿u khÃ´ng cÃ³ dá»¯ liá»‡u thÃ¬ khÃ´ng lÃ m gÃ¬
    If lastRow < 4 Then Exit Sub

    ' Ãp dá»¥ng tá»«ng cÃ´ng thá»©c cho cÃ¡c cá»™t C â†’ K
    For i = LBound(formulas) To UBound(formulas)
        If Not IsEmpty(formulas(i)) Then
            ws.Range(ws.Cells(4, startCol + i), ws.Cells(lastRow, startCol + i)).Formula = formulas(i)
        End If
    Next i
End Sub


---

âœ… Gá»i tá»« UiPath:

Trong Invoke VBA, truyá»n 10 cÃ´ng thá»©c tÆ°Æ¡ng á»©ng nhÆ° sau (cáº©n tháº­n escape " náº¿u cáº§n):

Array(
  "=A4+B4", 
  "=A4*B4", 
  "=IF(A4>100,""High"",""Low"")", 
  "=LEN(A4)", 
  "=TEXT(B4,""dd-mm-yyyy"")",
  "=A4&B4", 
  "=ROUND(A4/2,1)", 
  "=IFERROR(B4/A4,0)", 
  "=A4^2", 
  "=IF(A4+B4>200,""Yes"",""No"")"
)

ğŸ“Œ LÆ°u Ã½:

DÃ²ng cÃ´ng thá»©c luÃ´n báº¯t Ä‘áº§u tá»« dÃ²ng 4 (vÃ¬ dÃ²ng 3 lÃ  cÃ´ng thá»©c máº«u / dÃ²ng header),

CÃ´ng thá»©c sáº½ tá»± Ä‘á»™ng kÃ©o Ä‘áº¿n dÃ²ng cuá»‘i cÃ¹ng chá»©a dá»¯ liá»‡u á»Ÿ A hoáº·c B.



---

âœ… Báº¡n cáº§n gÃ¬ thÃªm?

MÃ¬nh cÃ³ thá»ƒ xuáº¥t file .bas chá»©a macro nÃ y Ä‘á»ƒ báº¡n import nhanh vÃ o UiPath.

Hoáº·c náº¿u báº¡n muá»‘n macro nÃ y nháº­n cáº£ tham sá»‘ tÃªn sheet, mÃ¬nh cÃ³ thá»ƒ sá»­a thÃªm.


Báº¡n cÃ³ muá»‘n mÃ¬nh táº¡o file .bas khÃ´ng?

