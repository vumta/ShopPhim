DÆ°á»›i Ä‘Ã¢y lÃ  Ä‘oáº¡n code VBA Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t, cho phÃ©p Ä‘á»c dá»¯ liá»‡u tá»« nhiá»u file nguá»“n (`sourceFilePath`) vÃ  ghi táº¥t cáº£ vÃ o má»™t file Ä‘Ã­ch (`targetFilePath`):

### Code VBA Cáº­p nháº­t: Äá»c vÃ  ghi nhiá»u file
```vba
Public Function CopyPasteMultipleSources(ByVal sourceFilePaths As String, ByVal targetFilePath As String, ByVal columnsToCopy As String) As String
    Dim sourceFiles() As String
    Dim sourceWorkbook As Workbook
    Dim targetWorkbook As Workbook
    Dim sourceSheet As Worksheet
    Dim targetSheet As Worksheet
    Dim sourceColumns() As String
    Dim targetCol As Integer
    Dim lastRowSource As Long
    Dim lastRowTarget As Long
    Dim sourceData As Variant
    Dim i As Integer, j As Integer

    On Error GoTo ErrorHandler

    ' PhÃ¢n tÃ¡ch danh sÃ¡ch cÃ¡c file nguá»“n tá»« chuá»—i, cÃ¡ch nhau bá»Ÿi dáº¥u pháº©y
    sourceFiles = Split(sourceFilePaths, ",")

    ' Má»Ÿ file Ä‘Ã­ch
    Set targetWorkbook = Workbooks.Open(targetFilePath)
    Set targetSheet = targetWorkbook.Sheets(2) ' Sá»­ dá»¥ng sheet thá»© hai cá»§a file Ä‘Ã­ch

    ' Chuyá»ƒn cÃ¡c tÃªn cá»™t tá»« chuá»—i thÃ nh máº£ng
    sourceColumns = Split(columnsToCopy, ",")

    ' XÃ³a dá»¯ liá»‡u cÅ© trong file Ä‘Ã­ch nhÆ°ng giá»¯ láº¡i tiÃªu Ä‘á»
    If Application.CountA(targetSheet.Rows(2)) > 0 Then
        targetSheet.Rows("2:" & targetSheet.Rows.Count).ClearContents
    End If

    ' Duyá»‡t qua tá»«ng file nguá»“n
    For i = LBound(sourceFiles) To UBound(sourceFiles)
        ' Má»Ÿ file nguá»“n
        Set sourceWorkbook = Workbooks.Open(Trim(sourceFiles(i)))
        Set sourceSheet = sourceWorkbook.Sheets(1) ' Láº¥y sheet Ä‘áº§u tiÃªn trong file nguá»“n

        ' XÃ¡c Ä‘á»‹nh dÃ²ng cuá»‘i cÃ¹ng trong dá»¯ liá»‡u file nguá»“n
        lastRowSource = sourceSheet.Cells(sourceSheet.Rows.Count, 1).End(xlUp).Row

        ' XÃ¡c Ä‘á»‹nh dÃ²ng cuá»‘i cÃ¹ng trong dá»¯ liá»‡u file Ä‘Ã­ch
        lastRowTarget = targetSheet.Cells(targetSheet.Rows.Count, 1).End(xlUp).Row + 1

        ' Duyá»‡t qua cÃ¡c cá»™t Ä‘Æ°á»£c chá»‰ Ä‘á»‹nh
        For j = LBound(sourceColumns) To UBound(sourceColumns)
            ' TÃ¬m cá»™t nguá»“n dá»±a trÃªn tÃªn cá»™t
            Dim sourceCol As Integer
            On Error Resume Next
            sourceCol = Application.Match(sourceColumns(j), sourceSheet.Rows(1), 0)
            On Error GoTo 0

            If sourceCol > 0 Then
                ' XÃ¡c Ä‘á»‹nh dÃ²ng cuá»‘i cÃ¹ng cá»§a dá»¯ liá»‡u trong cá»™t nguá»“n
                lastRowSource = sourceSheet.Cells(sourceSheet.Rows.Count, sourceCol).End(xlUp).Row

                ' Sao chÃ©p dá»¯ liá»‡u tá»« cá»™t nguá»“n
                sourceData = sourceSheet.Range(sourceSheet.Cells(2, sourceCol), sourceSheet.Cells(lastRowSource, sourceCol)).Value

                ' TÃ¬m cá»™t Ä‘Ã­ch dá»±a trÃªn tÃªn cá»™t
                targetCol = Application.Match(sourceColumns(j), targetSheet.Rows(2), 0)

                If targetCol > 0 Then
                    ' DÃ¡n dá»¯ liá»‡u vÃ o cá»™t Ä‘Ã­ch táº¡i file Ä‘Ã­ch
                    targetSheet.Range(targetSheet.Cells(lastRowTarget, targetCol), _
                                      targetSheet.Cells(lastRowTarget + UBound(sourceData, 1) - 1, targetCol)).Value = sourceData
                Else
                    CopyPasteMultipleSources = "Lá»—i: KhÃ´ng tÃ¬m tháº¥y cá»™t Ä‘Ã­ch cho " & sourceColumns(j) & " trong file Ä‘Ã­ch."
                    GoTo CleanUp
                End If
            Else
                CopyPasteMultipleSources = "Lá»—i: KhÃ´ng tÃ¬m tháº¥y cá»™t nguá»“n cho " & sourceColumns(j) & " trong file nguá»“n."
                GoTo CleanUp
            End If
        Next j

        ' ÄÃ³ng file nguá»“n
        sourceWorkbook.Close False
    Next i

    ' LÆ°u vÃ  Ä‘Ã³ng file Ä‘Ã­ch
    targetWorkbook.Save
    targetWorkbook.Close True

    CopyPasteMultipleSources = "ThÃ nh cÃ´ng: Dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c sao chÃ©p tá»« nhiá»u file nguá»“n vÃ o file Ä‘Ã­ch."
    Exit Function

ErrorHandler:
    CopyPasteMultipleSources = "Lá»—i: ÄÃ£ xáº£y ra lá»—i trong quÃ¡ trÃ¬nh thá»±c thi: " & Err.Description

CleanUp:
    ' ÄÃ³ng file náº¿u cáº§n thiáº¿t
    If Not sourceWorkbook Is Nothing Then sourceWorkbook.Close False
    If Not targetWorkbook Is Nothing Then targetWorkbook.Close True
End Function
```

### CÃ¡c cáº­p nháº­t trong Ä‘oáº¡n code:
1. **Äá»c nhiá»u file nguá»“n**:
   - `sourceFilePaths`: Chá»©a danh sÃ¡ch cÃ¡c Ä‘Æ°á»ng dáº«n file nguá»“n, phÃ¢n cÃ¡ch báº±ng dáº¥u pháº©y. VÃ­ dá»¥: `"C:\File1.xlsx,C:\File2.xlsx"`.

2. **Ghi vÃ o file Ä‘Ã­ch**:
   - Má»Ÿ file Ä‘Ã­ch (`targetFilePath`) vÃ  ghÃ©p dá»¯ liá»‡u tá»« táº¥t cáº£ cÃ¡c file nguá»“n vÃ o Ä‘Ãºng cÃ¡c cá»™t, dá»±a trÃªn `columnsToCopy`.

3. **XÃ³a dá»¯ liá»‡u cÅ©**:
   - XÃ³a dá»¯ liá»‡u tá»« hÃ ng thá»© 2 trá»Ÿ Ä‘i trong file Ä‘Ã­ch, giá»¯ láº¡i tiÃªu Ä‘á» á»Ÿ hÃ ng 1.

4. **Xá»­ lÃ½ cá»™t tÆ°Æ¡ng á»©ng**:
   - XÃ¡c Ä‘á»‹nh cá»™t trong file nguá»“n vÃ  file Ä‘Ã­ch dá»±a trÃªn tiÃªu Ä‘á» cá»™t.

---

### HÆ°á»›ng dáº«n sá»­ dá»¥ng:
1. **Chuáº©n bá»‹ file VBA**:
   - LÆ°u Ä‘oáº¡n code nÃ y thÃ nh file `.bas`.
   - Import file `.bas` vÃ o file Excel thÃ´ng qua VBA Editor (Alt + F11 > File > Import).

2. **TÃ­ch há»£p vá»›i UiPath**:
   - DÃ¹ng activity **Invoke VBA** Ä‘á»ƒ gá»i hÃ m `CopyPasteMultipleSources`.
   - Truyá»n tham sá»‘:
     - `sourceFilePaths`: Danh sÃ¡ch cÃ¡c Ä‘Æ°á»ng dáº«n file nguá»“n, cÃ¡ch nhau bá»Ÿi dáº¥u pháº©y.
     - `targetFilePath`: ÄÆ°á»ng dáº«n tá»›i file Excel Ä‘Ã­ch.
     - `columnsToCopy`: Danh sÃ¡ch tÃªn cá»™t, vÃ­ dá»¥: `"Column1,Column2,Column3"`.

3. **Kiá»ƒm tra káº¿t quáº£**:
   - Sau khi cháº¡y, kiá»ƒm tra file Ä‘Ã­ch Ä‘á»ƒ xem dá»¯ liá»‡u tá»« cÃ¡c file nguá»“n Ä‘Ã£ Ä‘Æ°á»£c há»£p nháº¥t.

Náº¿u báº¡n cáº§n thÃªm chá»‰nh sá»­a hoáº·c hÆ°á»›ng dáº«n chi tiáº¿t hÆ¡n, cá»© nÃ³i nhÃ©! ğŸ˜Š
