Tuyá»‡t vá»i! DÆ°á»›i Ä‘Ã¢y lÃ  Ä‘oáº¡n **Office Script Ä‘á»ƒ dÃ¡n dá»¯ liá»‡u vÃ o file Ä‘Ã­ch**, **khÃ´ng dÃ¹ng Table**, mÃ  **dÃ² theo tÃªn cá»™t á»Ÿ dÃ²ng 2** (`row index = 1`), Ä‘Ãºng yÃªu cáº§u cá»§a báº¡n.

---

## âœ… MÃ´ táº£:
- File Ä‘Ã­ch: khÃ´ng cÃ³ Table.
- Dá»¯ liá»‡u: báº¡n Ä‘Ã£ cÃ³ káº¿t quáº£ tá»« script nguá»“n, dáº¡ng:
  ```ts
  [
    {
      columnName: "PhÃ²ng ban",
      values: [["IT"], ["HR"], ["Finance"]]
    },
    {
      columnName: "TÃªn",
      values: [["Nam"], ["Lan"], ["HÃ¹ng"]]
    }
  ]
  ```
- Má»¥c tiÃªu: tÃ¬m Ä‘Ãºng cá»™t theo **tÃªn cá»™t náº±m á»Ÿ dÃ²ng 2**, sau Ä‘Ã³ **dÃ¡n dá»¯ liá»‡u báº¯t Ä‘áº§u tá»« dÃ²ng 3**.

---

## âœ… Office Script â€“ DÃ¡n dá»¯ liá»‡u vÃ o file Ä‘Ã­ch

```ts
function main(workbook: ExcelScript.Workbook, inputData: ColumnData[]): void {
  const sheet = workbook.getActiveWorksheet();

  // === 1. Äá»c tiÃªu Ä‘á» á»Ÿ dÃ²ng 2 (index = 1) ===
  const maxCol = 100;
  const headerRange = sheet.getRangeByIndexes(1, 0, 1, maxCol);
  const headerValues = headerRange.getValues()[0] as string[];

  // === 2. Táº¡o map: column name => column index ===
  let colMap: Record<string, number> = {};
  for (let i = 0; i < headerValues.length; i++) {
    const name = headerValues[i];
    if (name) colMap[name] = i;
  }

  // === 3. DÃ¡n dá»¯ liá»‡u vÃ o Ä‘Ãºng cá»™t, báº¯t Ä‘áº§u tá»« dÃ²ng 3 (index = 2) ===
  for (let item of inputData) {
    const colIndex = colMap[item.columnName];
    if (colIndex === undefined) continue; // bá» qua náº¿u khÃ´ng tÃ¬m tháº¥y cá»™t

    const rowCount = item.values.length;
    const range = sheet.getRangeByIndexes(2, colIndex, rowCount, 1);
    range.setValues(item.values);
  }
}

// === Äá»‹nh nghÄ©a kiá»ƒu dá»¯ liá»‡u input ===
type ColumnData = {
  columnName: string;
  values: string[][];
};
```

---

## âœ… Gá»£i Ã½ dÃ¹ng trong Power Automate:

1. **Run script (source)** â†’ tráº£ vá» `data`
2. **Run script (target)** â†’ dÃ¹ng output tá»« bÆ°á»›c 1 lÃ m input `inputData`

> ğŸ’¡ Báº¡n cÃ³ thá»ƒ truyá»n biáº¿n dáº¡ng `array` trong Power Automate náº¿u Ä‘Ã£ `Parse JSON`.

---

## âœ… Linh hoáº¡t:

- Náº¿u cá»™t khÃ´ng tá»“n táº¡i trong file Ä‘Ã­ch â†’ script **tá»± Ä‘á»™ng bá» qua**.
- KhÃ´ng cáº§n biáº¿t trÆ°á»›c thá»© tá»± cá»™t trong file Ä‘Ã­ch.

---

Báº¡n cÃ³ muá»‘n mÃ¬nh ghÃ©p láº¡i toÃ n bá»™ quy trÃ¬nh:  
**1 file nguá»“n â†’ trÃ­ch â†’ xá»­ lÃ½ Power Automate â†’ paste vÃ o file Ä‘Ã­ch**?

MÃ¬nh cÃ³ thá»ƒ viáº¿t ká»‹ch báº£n Power Automate tá»« Ä‘áº§u Ä‘áº¿n cuá»‘i luÃ´n náº¿u cáº§n.
