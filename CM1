L·ªói li√™n quan ƒë·∫øn `targetSheet.Rows(1)` c√≥ th·ªÉ x·∫£y ra khi b·∫°n g·ªçi m·ªôt d√≤ng nh∆∞ng ƒë·ªëi t∆∞·ª£ng `targetSheet` ch∆∞a ƒë∆∞·ª£c x√°c ƒë·ªãnh ƒë√∫ng ho·∫∑c do n·ªôi dung c·ªßa d√≤ng kh√¥ng ph√π h·ª£p. ƒê·ªÉ kh·∫Øc ph·ª•c, b·∫°n c√≥ th·ªÉ th·ª±c hi·ªán c√°c ƒëi·ªÅu ch·ªânh sau:

### C√°ch s·ª≠a l·ªói:
1. **Ki·ªÉm tra targetSheet**:
   - H√£y ƒë·∫£m b·∫£o r·∫±ng `targetSheet` ƒë√£ ƒë∆∞·ª£c g√°n ƒë√∫ng. Trong m√£ c·ªßa b·∫°n, `Set targetSheet = targetWorkbook.Sheets(1)` ƒë·∫£m b·∫£o r·∫±ng b·∫°n ƒëang l·∫•y sheet ƒë·∫ßu ti√™n c·ªßa workbook ƒë√≠ch.
   - N·∫øu sheet ƒë·∫ßu ti√™n kh√¥ng t·ªìn t·∫°i, ho·∫∑c workbook kh√¥ng m·ªü ƒë∆∞·ª£c, l·ªói s·∫Ω xu·∫•t hi·ªán. H√£y ki·ªÉm tra xem file ƒë√≠ch c√≥ sheet h·ª£p l·ªá kh√¥ng.

2. **Ki·ªÉm tra n·ªôi dung Rows(1)**:
   - `Rows(1)` ƒë·∫°i di·ªán cho d√≤ng ƒë·∫ßu ti√™n c·ªßa sheet. N·∫øu d√≤ng ƒë·∫ßu ti√™n n√†y tr·ªëng ho·∫∑c c√≥ d·ªØ li·ªáu kh√¥ng ph√π h·ª£p (v√≠ d·ª•: l·ªói ƒë·ªãnh d·∫°ng), code s·∫Ω kh√¥ng t√¨m ƒë∆∞·ª£c t√™n c·ªôt.

3. **S·ª≠a ƒëo·∫°n m√£ ƒë·ªÉ tr√°nh l·ªói**:
   D∆∞·ªõi ƒë√¢y l√† phi√™n b·∫£n m√£ ƒë∆∞·ª£c s·ª≠a ƒë·ªïi ƒë·ªÉ tƒÉng ƒë·ªô b·ªÅn khi x·ª≠ l√Ω `Rows(1)`:

   ```vba
   Sub OptimizedCopyPasteBySheetIndex()
       Dim sourceWorkbook As Workbook
       Dim targetWorkbook As Workbook
       Dim sourceSheet As Worksheet
       Dim targetSheet As Worksheet
       Dim sourceColumns As Variant
       Dim targetCol As Integer
       Dim lastRow As Long
       Dim sourceData As Variant
       Dim i As Integer

       ' M·ªü file g·ªëc v√† file ƒë√≠ch
       Set sourceWorkbook = Workbooks.Open("C:\DuongDan\FileGoc.xlsx")
       Set targetWorkbook = Workbooks.Open("C:\DuongDan\FileDich.xlsx")

       ' L·∫•y sheet theo th·ª© t·ª± (v√≠ d·ª•: sheet ƒë·∫ßu ti√™n)
       Set sourceSheet = sourceWorkbook.Sheets(1) ' Sheet ƒë·∫ßu ti√™n c·ªßa file g·ªëc
       Set targetSheet = targetWorkbook.Sheets(1) ' Sheet ƒë·∫ßu ti√™n c·ªßa file ƒë√≠ch

       ' Ki·ªÉm tra xem targetSheet c√≥ d·ªØ li·ªáu kh√¥ng
       If targetSheet.UsedRange.Rows.Count = 0 Then
           MsgBox "Sheet ƒë√≠ch kh√¥ng c√≥ d·ªØ li·ªáu!", vbExclamation
           Exit Sub
       End If

       ' C√°c c·ªôt c·∫ßn sao ch√©p (thay ƒë·ªïi theo nhu c·∫ßu)
       sourceColumns = Array("Column1", "Column2", "Column3")

       ' Duy·ªát qua c√°c c·ªôt ƒë∆∞·ª£c ch·ªâ ƒë·ªãnh
       For i = LBound(sourceColumns) To UBound(sourceColumns)
           ' T√¨m c·ªôt ƒë√≠ch c√≥ c√πng t√™n
           On Error Resume Next
           targetCol = 0
           targetCol = Application.Match(sourceColumns(i), targetSheet.Rows(1), 0)
           On Error GoTo 0

           If targetCol > 0 Then
               ' X√°c ƒë·ªãnh s·ªë h√†ng cu·ªëi c√πng trong c·ªôt g·ªëc
               lastRow = sourceSheet.Cells(sourceSheet.Rows.Count, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0)).End(xlUp).Row

               ' Sao ch√©p d·ªØ li·ªáu v√†o m·∫£ng
               sourceData = sourceSheet.Range(sourceSheet.Cells(2, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0)), _
                                              sourceSheet.Cells(lastRow, Application.Match(sourceColumns(i), sourceSheet.Rows(1), 0))).Value

               ' D√°n d·ªØ li·ªáu v√†o c·ªôt ƒë√≠ch t·ª´ m·∫£ng
               targetSheet.Range(targetSheet.Cells(2, targetCol), targetSheet.Cells(UBound(sourceData, 1) + 1, targetCol)).Value = sourceData
           Else
               MsgBox "Kh√¥ng t√¨m th·∫•y c·ªôt ƒë√≠ch cho " & sourceColumns(i), vbExclamation
           End If
       Next i

       ' L∆∞u v√† ƒë√≥ng file
       targetWorkbook.Save
       sourceWorkbook.Close False
       targetWorkbook.Close True

       MsgBox "Ho√†n th√†nh sao ch√©p d·ªØ li·ªáu v·ªõi sheet theo th·ª© t·ª±!"
   End Sub
   ```

### Gi·∫£i ph√°p:
1. **Ki·ªÉm tra d√≤ng ƒë·∫ßu ti√™n**:
   - Code ki·ªÉm tra n·∫øu d√≤ng ƒë·∫ßu ti√™n (Rows(1)) kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ tr√°nh l·ªói khi s·ª≠ d·ª•ng h√†m `Application.Match`.
   - N·∫øu kh√¥ng c√≥ d·ªØ li·ªáu, s·∫Ω hi·ªÉn th·ªã th√¥ng b√°o l·ªói ƒë·ªÉ b·∫°n bi·∫øt v·∫•n ƒë·ªÅ.

2. **X·ª≠ l√Ω l·ªói c·ªôt kh√¥ng t√¨m th·∫•y**:
   - N·∫øu kh√¥ng t√¨m ƒë∆∞·ª£c c·ªôt ƒë√≠ch trong `targetSheet.Rows(1)`, m·ªôt th√¥ng b√°o c·ª• th·ªÉ s·∫Ω ƒë∆∞·ª£c hi·ªÉn th·ªã.

H√£y th·ª≠ √°p d·ª•ng v√† cho t√¥i bi·∫øt n·∫øu v·∫´n g·∫∑p v·∫•n ƒë·ªÅ nh√©! üòä
