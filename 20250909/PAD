Báº¡n muá»‘n láº¥y Ä‘á»‹a chá»‰ email tá»« Outlook trong Power Automate Desktop (PAD) báº±ng VB.NET code Ä‘Ãºng khÃ´ng? ğŸ‘

Trong PAD, báº¡n cÃ³ thá»ƒ dÃ¹ng action Invoke Code (VB.NET), sau Ä‘Ã³ tham chiáº¿u thÆ° viá»‡n Outlook (Microsoft.Office.Interop.Outlook) Ä‘á»ƒ truy cáº­p email.
DÆ°á»›i Ä‘Ã¢y lÃ  má»™t vÃ­ dá»¥ cÆ¡ báº£n Ä‘á»ƒ láº¥y danh sÃ¡ch Ä‘á»‹a chá»‰ email tá»« Inbox:

' Biáº¿n Ä‘áº§u ra
Dim MailAddresses As New System.Collections.Generic.List(Of String)

' Khá»Ÿi táº¡o Outlook
Dim outlookApp As Object = CreateObject("Outlook.Application")
Dim outlookNs As Object = outlookApp.GetNamespace("MAPI")

' Má»Ÿ Inbox
Dim inbox As Object = outlookNs.GetDefaultFolder(6) ' 6 = olFolderInbox
Dim items As Object = inbox.Items

' Láº·p qua má»™t sá»‘ mail (vÃ­ dá»¥ 50 mail gáº§n nháº¥t)
Dim count As Integer = Math.Min(50, items.Count)

For i As Integer = 1 To count
    Dim mail As Object = items(i)
    If Not mail Is Nothing Then
        Try
            ' Láº¥y Ä‘á»‹a chá»‰ ngÆ°á»i gá»­i
            Dim senderEmail As String = ""
            If Not mail.Sender Is Nothing Then
                senderEmail = mail.Sender.Address
            End If

            If Not String.IsNullOrEmpty(senderEmail) Then
                MailAddresses.Add(senderEmail)
            End If
        Catch ex As Exception
            ' Bá» qua mail lá»—i (vÃ­ dá»¥: meeting request)
        End Try
    End If
Next

' Tráº£ vá» cho Power Automate Desktop
result = MailAddresses

CÃ¡ch dÃ¹ng trong Power Automate Desktop:

1. ThÃªm action Invoke Code â†’ chá»n VB.NET.


2. Copy code trÃªn vÃ o.


3. Táº¡o biáº¿n output result (kiá»ƒu List of Text) Ä‘á»ƒ nháº­n danh sÃ¡ch Ä‘á»‹a chá»‰ email.


4. Sau khi cháº¡y, báº¡n sáº½ cÃ³ danh sÃ¡ch email tá»« 50 thÆ° gáº§n nháº¥t trong Inbox.



ğŸ‘‰ Báº¡n cÃ³ muá»‘n mÃ¬nh viáº¿t thÃªm code Ä‘á»ƒ:

Láº¥y Subject + Body + Sender Address cÃ¹ng lÃºc,

Hay chá»‰ cáº§n Ä‘á»‹a chá»‰ mail ngÆ°á»i gá»­i thÃ´i?


